<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_curvature" label="sec_curvature">
  <title>The Arc Length Parameter and Curvature</title>
  <subsection>
    <title>The Arc Length Parametrization</title>
    <p>
      In normal conversation we describe position in terms of both
      <em>time</em> and <em>distance</em>.
      For instance, imagine driving to visit a friend.
      If she calls and asks where you are,
      you might answer <q>I am 20 minutes from your house,</q>
      or you might say <q>I am 10 miles from your house.</q>
      Both answers provide your friend with a general idea of where you are.
    </p>

    <figure xml:id="vid-vvf-curv-arclength" component="video" vshift="0">
      <caption>Video introduction to <xref ref="sec_curvature"/></caption>
      <video youtube="VHcu7bcQjsk" label="vid-vvf-curv-arclength"/>
    </figure>

    <p>
      Currently, our vector-valued functions have defined points with a parameter <m>t</m>,
      which we often take to represent time.
      Consider <xref ref="fig_vvfarc_intro1a"/>,
      where <m>\vrt = \la t^2-t,t^2+t\ra</m> is graphed and the points corresponding to <m>t=0,\ 1</m> and <m>2</m> are shown.
      Note how the arc length between <m>t=0</m> and <m>t=1</m> is smaller than the arc length between <m>t=1</m> and <m>t=2</m>;
      if the parameter <m>t</m> is time and <m>\vec r</m> is position,
      we can say that the particle traveled faster on <m>[1,2]</m> than on <m>[0,1]</m>.
    </p>

    <figure xml:id="fig_vvfarc_intro1">
      <caption>Introducing the arc length parameter</caption>
      <sidebyside widths="47% 47%" margins="0%">
        <figure xml:id="fig_vvfarc_intro1a">
          <caption/>
        <!-- START figures/fig_vvfarc_intro1.tex -->
          <image>
            <description/>
            <latex-image label="img_vvfarc_intro1a">

            \begin{tikzpicture}

            \begin{axis}[
            ymin=-1.1,ymax=6.5,
            xmin=-2.1,xmax=7
            ]

            \addplot+ [domain=-2:2.1,samples=40] ({x^2-x},{x^2+x});

            \filldraw [secondcolor] (axis cs: 0,0) circle (2.4pt) node [black,above right] { $t=0$};
            \filldraw [secondcolor] (axis cs: 0,2) circle (2.4pt) node [black, right] { $t=1$};
            \filldraw [secondcolor] (axis cs: 2,6) circle (2.4pt) node [black, right] { $t=2$};

            \draw [thick,-&gt;,firstcolor,&gt;=stealth] (axis cs:3.79,.77) -- (axis cs:3.75,.75) node [above ,black] { $\vrt$};

            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
        <!-- figures/fig_vvfarc_intro1.tex END -->
        </figure>

        <figure xml:id="fig_vvfarc_intro1b">
          <caption/>
        <!-- START figures/fig_vvfarc_intro1b.tex -->
          <image>
            <description/>
            <latex-image label="img_vvfarc_intro1b">

            \begin{tikzpicture}

            \begin{axis}[
            ymin=-1.1,ymax=6.5,
            xmin=-2.1,xmax=7
            ]

            \addplot+ [domain=-2:2.1,samples=40] ({x^2-x},{x^2+x});

            \filldraw [secondcolor] (axis cs: 0,0) circle (2.4pt) node [black,above right] { $s=0$};
            \filldraw [secondcolor] (axis cs: -.24,.94) circle (2.4pt) node [black, right] { $s=1$};
            \filldraw [secondcolor] (axis cs: -.03,1.91) circle (2.4pt) node [black, right] { $s=2$};
            \filldraw [secondcolor] (axis cs: .33,2.84) circle (2.4pt) node [black, right] { $s=3$};
            \filldraw [secondcolor] (axis cs: .75,3.75) circle (2.4pt) node [black, right] { $s=4$};
            \filldraw [secondcolor] (axis cs: 1.21,4.63) circle (2.4pt) node [black, right] { $s=5$};
            \filldraw [secondcolor] (axis cs: 1.71, 5.51) circle (2.4pt) node [black, right] { $s=6$};

            \draw [thick,-&gt;,firstcolor,&gt;=stealth] (axis cs:3.79,.77)--(axis cs:3.75,.75)node [above,black] { $\vec r(s)$};

            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
        <!-- figures/fig_vvfarc_intro1b.tex END -->
        </figure>
      </sidebyside>

    </figure>

    <p>
      Now consider <xref ref="fig_vvfarc_intro1b"/>,
      where the same graph is parametrized by a different variable <m>s</m>.
      Points corresponding to <m>s=0</m> through <m>s=6</m> are plotted.
      The arc length of the graph between each adjacent pair of points is 1.
      We can view this parameter <m>s</m> as distance;
      that is, the arc length of the graph from <m>s=0</m> to <m>s=3</m> is 3, the arc length from <m>s=2</m> to <m>s=6</m> is 4, etc.
      If one wants to find the point 2.5 units from an initial location (<ie/>, <m>s=0</m>),
      one would compute <m>\vec r(2.5)</m>.
      This parameter <m>s</m> is very useful,
      and is called the <em>arc length parameter</em>.
          <idx><h>arc length parameter</h></idx>
          <idx><h>arc length</h></idx>
    </p>

    <p>
      How do we find the arc length parameter?
    </p>

    <p>
      Start with any parametrization of <m>\vec r</m>.
      We can compute the arc length of the graph of <m>\vec r</m> on the interval <m>[0,t]</m> with
      <me>
        \text{arc length}\,  = \int_0^t\norm{\vrp(u)}\, du
      </me>.
    </p>

    <p>
      We can turn this into a function:
      as <m>t</m> varies,
      we find the arc length <m>s</m> from <m>0</m> to <m>t</m>.
      This function is
      <men xml:id="eq_vvfarc">
        s(t) = \int_0^t \norm{\vrp(u)}\, du
      </men>.
    </p>

    <p>
      This establishes a relationship between <m>s</m> and <m>t</m>.
      Knowing this relationship explicitly,
      we can rewrite <m>\vrt</m> as a function of <m>s</m>:
      <m>\vec r(s)</m>.
      We demonstrate this in an example.
    </p>

    <example xml:id="ex_vvfarc1">
      <title>Finding the arc length parameter</title>
      <statement>
        <p>
          Let <m>\vrt = \la 3t-1,4t+2\ra</m>.
          Parametrize <m>\vec r</m> with the arc length parameter <m>s</m>.
        </p>
      </statement>
      <solution>
        <p>
          Using <xref ref="eq_vvfarc">Equation</xref>, we write
          <me>
            s(t) = \int_0^t \norm{\vrp(u)}\, du
          </me>.
        </p>

        <p>
          We can integrate this,
          explicitly finding a relationship between <m>s</m> and <m>t</m>:
          <md>
            <mrow>s(t) \amp = \int_0^t \norm{\vrp(u)}\, du</mrow>
            <mrow>\amp = \int_0^t \sqrt{3^2+4^2}\, du</mrow>
            <mrow>\amp = \int_0^t 5\, du</mrow>
            <mrow>\amp = 5t</mrow>
          </md>.
        </p>

        <p>
          Since <m>s=5t</m>,
          we can write <m>t=s/5</m> and replace <m>t</m> in <m>\vrt</m> with <m>s/5</m>:
          <me>
            \vec r(s) = \la 3(s/5)-1, 4(s/5)+2\ra = \la \frac35s-1,\frac45s+2\ra
          </me>.
        </p>

        <p>
          Clearly, as shown in <xref ref="fig_vvfarc1"/>,
          the graph of <m>\vec r</m> is a line,
          where <m>t=0</m> corresponds to the point <m>(-1,2)</m>.
          What point on the line is 2 units away from this initial point?
          We find it with <m>\vec r(2) = \la 1/5, 18/5\ra</m>.
        </p>

        <figure xml:id="fig_vvfarc1" vshift="-2">
          <caption>Graphing <m>\vec r</m> in <xref ref="ex_vvfarc1"/> with parameters <m>t</m> and <m>s</m></caption>
          <!-- START figures/fig_vvfarc1.tex -->
          <image width="47%">
            <description/>
            <latex-image label="img_vvfarc1">

              \begin{tikzpicture}

              \begin{axis}[
              xtick={1,2,-1,-2},
              ymin=-1.1,ymax=6.5,
              xmin=-2.1,xmax=2.9
              ]

              \addplot+ [domain=-2.5:2.5] ({3*x-1},{4*x+2});

              \filldraw (axis cs:-1,2) circle (2.4pt) node [left] { $t=0$}
              (axis cs:2,6) circle (2.4pt) node [left] { $t=1$}
              (axis cs: -.4,2.8) circle (2.4pt) node [right,secondcolor] { $s=1$}
              (axis cs: .2,3.6) circle (2.4pt) node [right,secondcolor] { $s=2$}
              (axis cs: .8,4.4) circle (2.4pt) node [right,secondcolor] { $s=3$}
              (axis cs: 1.4,5.2) circle (2.4pt) node [right,secondcolor] { $s=4$}
              (axis cs: 2,6) circle (2.4pt) node [right,secondcolor] { $s=5$};

              \draw (axis cs:-1,2) node [secondcolor,shift={(10pt,-5pt)}]  { $s=0$};

              \end{axis}

              \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_vvfarc1.tex END -->
        </figure>

        <p>
          Is the point <m>(1/5,18/5)</m> really 2 units away from <m>(-1,2)</m>?
          We use the Distance Formula to check:
          <me>
            d = \sqrt{\left(\frac15-(-1)\right)^2+ \left(\frac{18}5-2\right)^2} = \sqrt{\frac{36}{25}+\frac{64}{25}} = \sqrt{4}=2
          </me>.
        </p>

        <p>
          Yes, <m>\vec r(2)</m> is indeed 2 units away,
          in the direction of travel, from the initial point.
        </p>
      </solution>
      <solution component="video" vshift="10">
        <title>Video solution</title>
        <video width="98%" youtube="UZkbOv5zW1U" label="vid-vvf-curv-arclen-eg" component="video"/>
      </solution>
    </example>

    <p>
      Things worked out very nicely in <xref ref="ex_vvfarc1"/>;
      we were able to establish directly that <m>s=5t</m>.
      Usually, the arc length parameter is much more difficult to describe in terms of <m>t</m>,
      a result of integrating a square root.
      There are a number of things that we can learn about the arc length parameter from <xref ref="eq_vvfarc">Equation</xref>, though,
      that are incredibly useful.
    </p>

    <p>
      First, take the derivative of <m>s</m> with respect to <m>t</m>.
      The Fundamental Theorem of Calculus
      (see <xref ref="thm_FTC1"/>)
      states that
      <men xml:id="eq_vvfarc3">
        \frac{ds}{dt}=s\primeskip'(t) = \norm{\vrp(t)}
      </men>.
    </p>

    <p>
      Letting <m>t</m> represent time and <m>\vrt</m> represent position,
      we see that the rate of change of <m>s</m> with respect to <m>t</m> is speed;
      that is, the rate of change of <q>distance traveled</q> is speed,
      which should match our intuition.
    </p>

    <p>
      The Chain Rule states that
      <md>
        <mrow>\frac{d\vec r}{dt} \amp = \frac{d\vec r}{ds}\cdot\frac{ds}{dt}</mrow>
        <mrow>\vrp(t) \amp = \vrp(s)\cdot \norm{\vrp(t)}</mrow>
      </md>.
    </p>

    <p>
      Solving for <m>\vrp(s)</m>, we have
      <men xml:id="eq_vvfarc2">
        \vrp(s) = \frac{\vrp(t)}{\norm{\vrp(t)}} = \unittangent(t)
      </men>,
      where <m>\unittangent(t)</m> is the unit tangent vector.
      <xref ref="eq_vvfarc2">Equation</xref> is often misinterpreted,
      as one is tempted to think it states <m>\vrp(t) = \unittangent(t)</m>,
      but there is a big difference between <m>\vrp(s)</m> and <m>\vrp(t)</m>.
      The key to take from it is that <m>\vrp(s)</m> is a unit vector.
      In fact, the following theorem states that this characterizes the arc length parameter.
    </p>

    <theorem xml:id="thm_arclengthparam">
      <title>Arc Length Parameter</title>
      <statement>
        <p>
          Let <m>\vec r(s)</m> be a vector-valued function.
          The parameter <m>s</m> is the arc length parameter if,
          and only if, <m>\norm{\vrp(s)} = 1</m>.
              <idx><h>arc length parameter</h></idx>
        </p>
      </statement>
    </theorem>

    <figure xml:id="vid-vvf-curv-arclen-thm" component="video" vshift="0">
      <caption>Video presentation of <xref ref="thm_arclengthparam"/></caption>
      <video youtube="FLydDuy3r2I" label="vid-vvf-curv-arclen-thm"/>
    </figure>
  </subsection>

  <subsection>
    <title>Curvature</title>
    <p>
      Consider points <m>A</m> and <m>B</m> on the curve graphed in <xref ref="fig_curvature_introa"/>.
      One can readily argue that the curve curves more sharply at <m>A</m> than at <m>B</m>.
      It is useful to use a number to describe how sharply the curve bends;
      that number is the <em>curvature</em> of the curve.
    </p>

    <figure xml:id="fig_curvature_intro">
      <caption>Establishing the concept of curvature</caption>
      <sidebyside widths="47% 47%" margins="0%">
        <figure xml:id="fig_curvature_introa">
          <caption/>
        <!-- START figures/fig_curvature_intro.tex -->
          <image>
            <description/>
            <latex-image label="img_curvature_introa">

            \begin{tikzpicture}

            \begin{axis}[
            ymin=-.1,ymax=2.9,
            xmin=-.1,xmax=3.5
            ]

            \addplot+ [domain=-1:1.5,samples=40] ({x^2-x+1},{x^3+1});

            \draw [-&gt;,firstcolor,thick,&gt;=stealth] (axis cs:2.44, 0.488) -- (axis cs: 2.4141, 0.506961);

            \filldraw (axis cs:.77,1.04) circle (2.4pt) node [below] { $A$}
				            	(axis cs: 1.75, 0.875) circle (2.4pt) node [below] { $B$};

            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
        <!-- figures/fig_curvature_intro.tex END -->
        </figure>

        <figure xml:id="fig_curvature_introb">
          <caption/>
        <!-- START figures/fig_curvature_introb.tex -->
          <image>
            <description/>
            <latex-image label="img_curvature_introb">

            \begin{tikzpicture}[&gt;=stealth]

            \begin{axis}[
            ymin=-.1,ymax=2.9,
            xmin=-.1,xmax=3.5
            ]

            \addplot+ [domain=-1:1.5,samples=40] ({x^2-x+1},{x^3+1});

            \draw [-&gt;,secondcolor,thick] (axis cs:0.8461, 1.53144) -- (axis cs:1.14654, 2.48524);
            \draw [-&gt;,secondcolor,thick] (axis cs:1.2684, 0.989352) -- (axis cs:0.273445, 1.08968);
            \draw [-&gt;,secondcolor,thick] (axis cs:2.20203, 0.649597) -- (axis cs:1.35163, 1.17574);
            \draw [-&gt;,firstcolor,thick] (axis cs:2.44, 0.488) -- (axis cs: 2.4141, 0.506961);

            \filldraw (axis cs:.77,1.04) circle (2.4pt) node [below] { $A$}
                      (axis cs:0.8461, 1.53144) circle (2.4pt)
                      (axis cs: 1.2684, 0.989352) circle (2.4pt)
                      (axis cs: 1.75, 0.875) circle (2.4pt) node [below] { $B$}
                      (axis cs: 2.20203, 0.649597) circle (2.4pt);

            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
        <!-- figures/fig_curvature_introb.tex END -->
        </figure>
      </sidebyside>

    </figure>

    <p>
      We derive this number in the following way.
      Consider <xref ref="fig_curvature_introb"/>,
      where unit tangent vectors are graphed around points <m>A</m> and <m>B</m>.
      Notice how the direction of the unit tangent vector changes quite a bit near <m>A</m>,
      whereas it does not change as much around <m>B</m>.
      This leads to an important concept:
      measuring the rate of change of the unit tangent vector with respect to arc length gives us a measurement of curvature.
    </p>

    <definition xml:id="def_curvature">
      <title>Curvature</title>
      <statement>
        <p>
          Let <m>\vec r(s)</m> be a vector-valued function where <m>s</m> is the arc length parameter.
          The curvature <m>\kappa</m> of the graph of <m>\vec r(s)</m> is
              <idx><h>curvature</h></idx>
              <idx><h>unit tangent vector</h><h>and curvature</h></idx>
          <me>
            \kappa = \snorm{\frac{d\unittangent}{ds}} = \snorm{\unittangentprime(s)}
          </me>.
        </p>
      </statement>
    </definition>

    <figure xml:id="vid-vvf-curv-curvature" component="video" vshift="0">
      <caption>Video presentation of <xref ref="def_curvature"/></caption>
      <video youtube="sjz_eHxgbLg" label="vid-vvf-curv-curvature"/>
    </figure>

    <p>
      If <m>\vec r(s)</m> is parametrized by the arc length parameter, then
      <me>
        \unittangent(s) = \frac{\vrp(s)}{\norm{\vrp(s)}}  \text{ and }  \unitnormal(s) = \frac{\unittangentprime(s)}{\norm{\unittangentprime(s)}}
      </me>.
    </p>

    <p>
      Having defined <m>\norm{\unittangentprime(s)} =\kappa</m>,
      we can rewrite the second equation as
      <men xml:id="eq_curvature">
        \unittangentprime(s) = \kappa\unitnormal(s)
      </men>.
    </p>

    <p>
      We already knew that <m>\unittangentprime(s)</m> is in the same direction as <m>\unitnormal(s)</m>;
      that is, we can think of <m>\unittangent(s)</m> as being <q>pulled</q>
      in the direction of <m>\unitnormal(s)</m>.
      How <q>hard</q> is it being pulled?
      By a factor of <m>\kappa</m>.
      When the curvature is large,
      <m>\unittangent(s)</m> is being <q>pulled hard</q>
      and the direction of <m>\unittangent(s)</m> changes rapidly.
      When <m>\kappa</m> is small,
      <m>T(s)</m> is not being pulled hard and hence its direction is not changing rapidly.
    </p>

    <p>
      We use <xref ref="def_curvature"/>
      to find the curvature of the line in <xref ref="ex_vvfarc1"/>.
    </p>

    <example xml:id="ex_curvature1">
      <title>Finding the curvature of a line</title>
      <statement>
        <p>
          Use <xref ref="def_curvature"/>
          to find the curvature of <m>\vrt = \la 3t-1,4t+2\ra</m>.
        </p>
      </statement>
      <solution>
        <p>
          In <xref ref="ex_vvfarc1"/>,
          we found that the arc length parameter was defined by <m>s=5t</m>,
          so <m>\vec r(s) =\la 3s/5-1, 4s/5+2\ra</m> parametrized <m>\vec r</m> with the arc length parameter.
          To find <m>\kappa</m>, we need to find <m>\unittangentprime(s)</m>.
          <md>
            <mrow>\unittangent(s) \amp = \vrp(s) \text{ (recall this is a unit vector) }</mrow>
            <mrow>\amp = \la 3/5, 4/5\ra.</mrow>
            <intertext>Therefore</intertext>
            <mrow>\unittangentprime(s) \amp = \la 0,0\ra</mrow>
            <intertext>and</intertext>
            <mrow>\kappa\amp =\snorm{\unittangentprime(s)} = 0</mrow>
          </md>.
        </p>

        <p>
          It probably comes as no surprise that the curvature of a line is 0. (How
          <q>curvy</q> is a line?
          It is not curvy at all.)
        </p>
      </solution>
      <solution component="video" vshift="3">
        <title>Video solution</title>
        <video width="98%" youtube="SZigON0uhqU" label="vid-vvf-curv-line" component="video"/>
      </solution>
    </example>

    <p>
      While the definition of curvature is a beautiful mathematical concept,
      it is nearly impossible to use most of the time;
      writing <m>\vec r</m> in terms of the arc length parameter is generally very hard.
      Fortunately,
      there are other methods of calculating this value that are much easier.
      There is a tradeoff: the definition is <q>easy</q>
      to understand though hard to compute,
      whereas these other formulas are easy to compute though it may be hard to understand why they work.
    </p>

    <theorem xml:id="thm_curvature_formulas">
      <title>Formulas for Curvature</title>
      <statement>
        <p>
          Let <m>C</m> be a smooth curve in the plane or in space.
              <idx><h>curvature</h><h>equations for</h></idx>
          <ol>
            <li>
              <p>
                If <m>C</m> is defined by <m>y=f(x)</m>, then
                <me>
                  \kappa = \frac{\abs{\fp'(x)}}{\Big(1+\big(\fp(x)\big)^2\Big)^{3/2}}
                </me>.
              </p>
            </li>

            <li>
              <p>
                If <m>C</m> is defined as a vector-valued function in the plane,
                <m>\vrt = \la x(t), y(t)\ra</m>, then
                <me>
                  \kappa = \frac{\abs{x'y''-x''y'}}{\big((x')^2+(y')^2\big)^{3/2}}
                </me>.
              </p>
            </li>

            <li>
              <p>
                If <m>C</m> is defined in space by a vector-valued function <m>\vrt</m>, then
                <me>
                  \kappa = \frac{\norm{\unittangentprime(t)}}{\norm{\vrp(t)}} = \frac{\norm{\vrp(t)\times\vrpp(t)}}{\norm{\vrp(t)}^3} = \frac{\vec a(t)\cdot \unitnormal(t)}{\norm{\vec v(t)}^2}
                </me>.
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </theorem>

    <p>
      We practice using these formulas.
    </p>

    <example xml:id="ex_curvature2">
      <title>Finding the curvature of a circle</title>
      <statement>
        <p>
          Find the curvature of a circle with radius <m>r</m>,
          defined by <m>\vec c(t) = \la r\cos(t), r\sin(t)\ra</m>.
              <idx><h>curvature</h><h>of circle</h></idx>
        </p>
      </statement>
      <solution>
        <p>
          Before we start,
          we should expect the curvature of a circle to be constant,
          and not dependent on <m>t</m>. (Why?)
        </p>

        <p>
          We compute <m>\kappa</m> using the second part of <xref ref="thm_curvature_formulas"/>.
          <md>
            <mrow>\kappa \amp = \frac{\abs{(-r\sin(t) )(-r\sin(t) ) - (-r\cos(t) )(r\cos(t) )}}{\big( (-r\sin(t) )^2+(r\cos(t) )^2\big)^{3/2}}</mrow>
            <mrow>\amp = \frac{r^2(\sin^2(t) +\cos^2(t) )}{\big(r^2(\sin^2(t) +\cos^2(t) )\big)^{3/2}}</mrow>
            <mrow>\amp = \frac{r^2}{r^3} = \frac1r</mrow>
          </md>.
        </p>

        <p>
          We have found that a circle with radius <m>r</m> has curvature <m>\kappa = 1/r</m>.
        </p>
      </solution>
      <solution component="video" vshift="3">
        <title>Video solution</title>
        <video width="98%" youtube="NgffyzJBrTc" label="vid-vvf-curv-circle" component="video"/>
      </solution>
    </example>

    <p>
      <xref ref="ex_curvature2"/> gives a great result.
      Before this example, if we were told
      <q>The curve has a curvature of 5 at point <m>A</m>,</q>
      we would have no idea what this really meant.
      Is 5 <q>big</q> <mdash/> does is correspond to a really sharp turn,
      or a not-so-sharp turn?
      Now we can think of 5 in terms of a circle with radius 1/5.
      Knowing the units
      (inches vs.<nbsp/>miles, for instance)
      allows us to determine how sharply the curve is curving.
    </p>

    <p>
      Let a point <m>P</m> on a smooth curve <m>C</m> be given,
      and let <m>\kappa</m> be the curvature of the curve at <m>P</m>.
      A circle that:
    </p>

    <p>
      <ul>
        <li>
          <p>
            passes through <m>P</m>,
          </p>
        </li>

        <li>
          <p>
            lies on the concave side of <m>C</m>,
          </p>
        </li>

        <li>
          <p>
            has a common tangent line as <m>C</m> at <m>P</m> and
          </p>
        </li>

        <li>
          <p>
            has radius <m>r=1/\kappa</m> (hence has curvature <m>\kappa</m>)
          </p>
        </li>
      </ul>
    </p>

    <p>
      is the <em>osculating circle</em>,
      or <em>circle of curvature</em>,
      to <m>C</m> at <m>P</m>, and <m>r</m> is the
      <em>radius of curvature</em>.
          <idx><h>curvature</h><h>of circle</h></idx>
          <idx><h>osculating circle</h></idx>
          <idx><h>circle of curvature</h></idx>
          <idx><h>radius of curvature</h></idx>
          <idx><h>curvature</h><h>radius of</h></idx>
      <xref ref="fig_curvature_osculate"/> shows the graph of the curve seen earlier in
      <xref ref="fig_curvature_intro"/> and its osculating circles at <m>A</m> and <m>B</m>.
      A sharp turn corresponds to a circle with a small radius;
      a gradual turn corresponds to a circle with a large radius.
      Being able to think of curvature in terms of the radius of a circle is very useful.
    </p>

    <figure xml:id="fig_curvature_osculate" vshift="6">
      <caption>Illustrating the osculating circles for the curve seen in <xref ref="fig_curvature_intro"/></caption>
      <!-- START figures/fig_curvature_introc.tex -->
      <image width="47%">
        <description/>
        <latex-image label="img_curvature_osculate">

        \begin{tikzpicture}

        \begin{axis}[
        ymin=-.1,ymax=2.9,
        xmin=-.1,xmax=3.5
        ]

        \addplot+ [domain=-1:1.5,samples=40] ({x^2-x+1},{x^3+1});
        \addplot [secondcurvestyle,solid,domain=0:360] ({.08*cos(x)+.83},{.08*sin(x)+1.09});
        \addplot [secondcurvestyle,solid,domain=0:360,samples=101] ({2.17*cos(x)+.99},{2.17*sin(x)+-1.15});

        \draw [-&gt;,firstcolor,thick,&gt;=stealth] (axis cs:2.44, 0.488) -- (axis cs: 2.4141, 0.506961);

        \filldraw (axis cs:.77,1.04) circle (2.4pt) node [below] { $A$}
					        (axis cs: 1.75, 0.875) circle (2.4pt) node [below] { $B$};

        \end{axis}

        \end{tikzpicture}

        </latex-image>
      </image>
      <!-- figures/fig_curvature_introc.tex END -->
    </figure>

    <figure xml:id="vid-vvf-curv-oscul" component="video" vshift="0">
      <caption>The osculating circle</caption>
      <video youtube="x8TWhPo42QE" label="vid-vvf-curv-oscul"/>
    </figure>

    <p>
      (The word <q>osculating</q> comes from a Latin word related to kissing;
      an osculating circle <q>kisses</q>
      the graph at a particular point.
      Many beautiful ideas in mathematics have come from studying the osculating circles to a curve.)
    </p>

    <example xml:id="ex_curvature3">
      <title>Finding curvature</title>
      <statement>
        <p>
          Find the curvature of the parabola defined by <m>y=x^2</m> at the vertex and at <m>x=1</m>.
        </p>
      </statement>
      <solution>
        <p>
          We use the first formula found in <xref ref="thm_curvature_formulas"/>.
          <md>
            <mrow>\kappa(x) \amp = \frac{\abs{2}}{\big(1+(2x)^2\big)^{3/2}}</mrow>
            <mrow>\amp = \frac2{\big(1+4x^2\big)^{3/2}}</mrow>
          </md>.
        </p>

        <figure xml:id="fig_curvature3" vshift="0">
          <caption>Examining the curvature of <m>y=x^2</m></caption>
          <!-- START figures/fig_curvature3.tex -->
          <image width="47%">
            <description/>
            <latex-image label="img_curvature3">

            \begin{tikzpicture}

            \begin{axis}[
            ymin=-2.5,ymax=10.1,
            xmin=-10.2,xmax=4.9
            ]

            \addplot+ [domain=-3.2:3.2,samples=40] ({x},{x^2});
            \addplot [secondcurvestyle,solid,domain=0:360] ({.5*cos(x)},{.5*sin(x)+.5});
            \addplot [secondcurvestyle,solid,domain=0:360,samples=70] ({5.6*cos(x)-4},{5.6*sin(x)+3.5});

            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_curvature3.tex END -->
        </figure>

        <p>
          At the vertex (<m>x=0</m>), the curvature is <m>\kappa = 2</m>.
          At <m>x=1</m>,
          the curvature is <m>\kappa = 2/(5)^{3/2} \approx 0.179</m>.
          So at <m>x=0</m>,
          the curvature of <m>y=x^2</m> is that of a circle of radius <m>1/2</m>;
          at <m>x=1</m>,
          the curvature is that of a circle with radius <m>\approx 1/0.179 \approx 5.59</m>.
          This is illustrated in <xref ref="fig_curvature3"/>.
          At <m>x=3</m>, the curvature is <m>0.009</m>;
          the graph is nearly straight as the curvature is very close to 0.
        </p>
      </solution>
    </example>

    <example xml:id="ex_curvature4">
      <title>Finding curvature</title>
      <statement>
        <p>
          Find where the curvature of <m>\vrt = \la t, t^2, 2t^3\ra</m> is maximized.
        </p>
      </statement>
      <solution>
        <p>
          We use the third formula in <xref ref="thm_curvature_formulas"/>
          as <m>\vrt</m> is defined in space.
          We leave it to the reader to verify that
          <me>
            \vrp(t) =\la 1,2t,6t^2\ra, \vrp'(t) = \la 0,2,12t\ra, \text{ and }  \vrp(t)\times \vrpp(t) = \la 12t^2,-12t,2\ra
          </me>.
        </p>

        <figure xml:id="fig_curvature4">
          <caption>Understanding the curvature of a curve in space</caption>
          <sidebyside widths="47% 47%" margins="0%">
            <figure xml:id="fig_curvature4a">
              <caption/>
            <!-- START figures/fig_curvature4a.tex -->
              <image>
                <description/>
                <latex-image label="img_curvature4a">

                \begin{tikzpicture}

                \begin{axis}[
                ymin=-.1,ymax=2.5,
                xmin=-2.1,xmax=2.1
                ]

                \addplot+ [smooth] coordinates {(-1.5,0.0122)(-1.45,0.01404)(-1.4,0.01623)(-1.35,0.01887)(-1.3,0.02207)(-1.25,0.02596)(-1.2,0.03074)(-1.15,0.03666)(-1.1,0.04403)(-1.05,0.05331)(-1.,0.06509)(-0.95,0.08019)(-0.9,0.09974)(-0.85,0.1253)(-0.8,0.159)(-0.75,0.204)(-0.7,0.2643)(-0.65,0.3457)(-0.6,0.4557)(-0.55,0.6035)(-0.5,0.7989)(-0.45,1.049)(-0.4,1.352)(-0.35,1.686)(-0.3,2.006)(-0.25,2.246)(-0.2,2.353)(-0.15,2.318)(-0.1,2.191)(-0.05,2.057)(0,2.)(0.05,2.057)(0.1,2.191)(0.15,2.318)(0.2,2.353)(0.25,2.246)(0.3,2.006)(0.35,1.686)(0.4,1.352)(0.45,1.049)(0.5,0.7989)(0.55,0.6035)(0.6,0.4557)(0.65,0.3457)(0.7,0.2643)(0.75,0.204)(0.8,0.159)(0.85,0.1253)(0.9,0.09974)(0.95,0.08019)(1.,0.06509)(1.05,0.05331)(1.1,0.04403)(1.15,0.03666)(1.2,0.03074)(1.25,0.02596)(1.3,0.02207)(1.35,0.01887)(1.4,0.01623)(1.45,0.01404)(1.5,0.0122)};

                \end{axis}

                \end{tikzpicture}

                </latex-image>
              </image>
            <!-- figures/fig_curvature4a.tex END -->
            </figure>

            <figure xml:id="fig_curvature4b_3D">
              <caption/>

              <!-- START figures/figcurvature4_3D.asy -->
              <image>
                <description/>
                <asymptote label="img_curvature4b_3D">



                  //ASY file for figcurvature43D.asy in Chapter 11

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(4,4,2);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={};
                  real[] myychoice={};
                  real[] myzchoice={};
                  defaultpen(0.5mm);
                  pair xbounds=(-2,2);
                  pair ybounds=(-1,2);
                  pair zbounds=(-2,2);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw the curve &lt;t, t^2, 2*t^3&gt; for t from -1 to 1
                  triple g(real t) {return (t, t^2, 2*t^3);}
                  path3 mypath=graph(g,-1,1,operator ..); draw(mypath,bluepen);
                  //path3 mypath=graph(g,-1,-0.9,operator ..); draw(mypath,bluepen,Arrow3(size=4mm));
                  path3 mypath=graph(g,-1,-0.7,operator ..); draw(mypath,bluepen,Arrow3(size=4mm));
                  //path3 mypath=graph(g,-1,0.7,operator ..); draw(mypath,bluepen,Arrow3(size=4mm));
                  //path3 mypath=graph(g,-1,0.9,operator ..); draw(mypath,bluepen,Arrow3(size=4mm));

                  //Draw points of maximum curvature (0.189,(0.189)^2,2*(0.189)^3)
                  // cooresponding to values t=+/-0.189
                  dotfactor=4;
                  dot(((0.189,(0.189)^2,2*(0.189)^3)),redpen);
                  dot(((-0.189,(-0.189)^2,2*(-0.189)^3)),redpen);

                </asymptote>
              </image>
            <!-- figures/figcurvature4_3D.asy END -->
            </figure>
          </sidebyside>

        </figure>

        <p>
          Thus
          <md>
            <mrow>\kappa(t) \amp = \frac{\norm{\vrp(t)\times\vrp'(t)}}{\norm{\vrp(t)}^3}</mrow>
            <mrow>\amp = \frac{\norm{\la 12t^2,-12t,2\ra}}{\norm{\la 1,2t,6t^2\ra}^3}</mrow>
            <mrow>\amp = \frac{\sqrt{144t^4+144t^2+4}}{\left(\sqrt{1+4t^2+36t^4\ }\right)^3}</mrow>
          </md>
        </p>

        <p>
          While this is not a particularly <q>nice</q> formula,
          it does explicitly tell us what the curvature is at a given <m>t</m> value.
          To maximize <m>\kappa(t)</m>,
          we should solve <m>\kappa'(t)=0</m> for <m>t</m>.
          This is doable, but <em>very</em> time consuming.
          Instead, consider the graph of
          <m>\kappa(t)</m> as given in <xref ref="fig_curvature4a"/>.
          We see that <m>\kappa</m> is maximized at two <m>t</m> values;
          using a numerical solver, we find these values are <m>t\approx\pm 0.189</m>.
          In <xref ref="fig_curvature4b_3D"/> we graph <m>\vrt</m> and indicate the points where curvature is maximized.
        </p>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>Curvature and Motion</title>
    <p>
      Let <m>\vrt</m> be a position function of an object,
      with velocity <m>\vvt = \vrp(t)</m> and acceleration <m>\vec a(t)=\vrpp(t)</m>.
      In <xref ref="sec_tan_norm"/>
      we established that acceleration is in the plane formed by
      <m>\unittangent(t)</m> and <m>\unitnormal(t)</m>,
      and that we can find scalars <m>a_\text{T}</m> and
      <m>a_\text{N}</m> such that
          <idx><h>curvature</h><h>and motion</h></idx>
          <idx><h>unit tangent vector</h><h>and curvature</h></idx>
          <idx><h>unit normal vector</h><h>and curvature</h></idx>
          <idx><h>at@<m>a_\text{T}</m></h></idx>
          <idx><h>an@<m>a_\text{N}</m></h></idx>
      <me>
        \vat = a_\text{T} \unittangent(t) + a_\text{N} \unitnormal(t)
      </me>.
    </p>

    <p>
      <xref ref="thm_acc_plane"/>
      gives formulas for <m>a_\text{T}</m> and <m>a_\text{N}</m>:
      <me>
        a_\text{T}  = \frac{d}{dt}\Big(\norm{\vvt}\Big)  \text{ and }   a_\text{N}  = \frac{\norm{\vvt\times \vat}}{\norm{\vvt}}
      </me>.
    </p>

    <p>
      We understood that the amount of acceleration in the direction of <m>\unittangent</m> relates only to how the speed of the object is changing,
      and that the amount of acceleration in the direction of <m>\unitnormal</m> relates to how the direction of travel of the object is changing.
      (That is, if the object travels at constant speed, <m>a_\text{T} =0</m>;
      if the object travels in a constant direction, <m>a_\text{N} =0</m>.)
    </p>

    <p>
      In <xref ref="eq_vvfarc3">Equation</xref> at the beginning of this section, we found
      <m>s\primeskip'(t) = \norm{\vvt}</m>.
      We can combine this fact with the above formula for <m>a_\text{T}</m> to write
      <me>
        a_\text{T}  = \frac{d}{dt}\Big(\norm{\vvt}\Big) = \frac{d}{dt}\big( s\primeskip'(t)\big) = s\primeskip''(t)
      </me>.
    </p>

    <p>
      Since <m>s\primeskip'(t)</m> is speed,
      <m>s\primeskip''(t)</m> is the rate at which speed is changing with respect to time.
      We see once more that the component of acceleration in the direction of travel relates only to speed,
      not to a change in direction.
    </p>

    <p>
      Now compare the formula for
      <m>a_\text{N}</m> above to the formula for curvature in <xref ref="thm_curvature_formulas"/>:
      <me>
        a_\text{N}  = \frac{\norm{\vvt\times \vat}}{\norm{\vvt}} \text{ and }  \kappa = \frac{\norm{\vrp(t)\times\vrpp(t)}}{\norm{\vrp(t)}^3}=\frac{\norm{\vvt\times \vat}}{\norm{\vvt}^3}
      </me>.
    </p>

    <p>
      Thus
      <md>
        <mrow>a_\text{N}  \amp = \kappa \norm{\vvt}^2</mrow>
        <mrow>\amp = \kappa\Big(s\primeskip'(t)\Big)^2</mrow>
      </md>
    </p>

    <p>
      This last equation shows that the component of acceleration that changes the object's direction is dependent on two things:
      the curvature of the path and the speed of the object.
    </p>

    <p>
      Imagine driving a car in a clockwise circle.
      You will naturally feel a force pushing you towards the door
      (more accurately,
      the door is pushing you as the car is turning and you want to travel in a straight line).
      If you keep the radius of the circle constant but speed up (<ie/>, increasing <m>s\primeskip'(t)</m>),
      the door pushes harder against you
      (<m>a_\text{N}</m> has increased).
      If you keep your speed constant but tighten the turn (<ie/>, increase <m>\kappa</m>),
      once again the door will push harder against you.
    </p>

    <p>
      Putting our new formulas for
      <m>a_\text{T}</m> and <m>a_\text{N}</m> together, we have
      <me>
        \vat = s\primeskip''(t)\unittangent(t) + \kappa\norm{\vvt}^2\unitnormal(t)
      </me>.
    </p>

    <p>
      This is not a particularly practical way of finding
      <m>a_\text{T}</m> and <m>a_\text{N}</m>,
      but it reveals some great concepts about how acceleration interacts with speed and the shape of a curve.
    </p>

    <example xml:id="ex_curvature5">
      <title>Curvature and road design</title>
      <statement>
        <p>
          The minimum radius of the curve in a highway cloverleaf is determined by the operating speed,
          as given in the table in <xref ref="fig_curvature5"/>.
          For each curve and speed, compute <m>a_\text{N}</m>.
        </p>
      </statement>
      <solution>
        <table xml:id="fig_curvature5">
          <title>Operating speed and minimum radius in highway cloverleaf design</title>
          <tabular>
            <!-- <col width="45%"/>
            <col width="45%"/> -->
            <row bottom="minor">
              <cell><line>Operating</line><line>Speed (mph)</line></cell>
              <cell><line>Minimum</line><line>Radius (ft)</line></cell>
            </row>
            <row>
              <cell>35</cell>
              <cell>310</cell>
            </row>
            <row>
              <cell>40</cell>
              <cell>430</cell>
            </row>
            <row>
              <cell>45</cell>
              <cell>540</cell>
            </row>
          </tabular>

        </table>

        <p>
          Using <xref ref="eq_curvature">Equation</xref>,
          we can compute the acceleration normal to the curve in each case.
          We start by converting each speed from
          <q>miles per hour</q> to <q>feet per second</q>
          by multiplying by <m>5280/3600</m>.
          <md>
            <mrow>\text{35 mph, 310 ft}  \amp \Rightarrow 51.33\,\text{ft/s},\, \kappa = 1/310</mrow>
            <mrow>a_\text{N} \amp = \kappa\, \norm{\vvt}^2</mrow>
            <mrow>\amp = \frac1{310}\big(51.33\big)^2</mrow>
            <mrow>\amp = 8.50\,\text{ft/s}^2</mrow>
          </md>.
          <md>
            <mrow>\text{40 mph, 430 ft}  \amp \Rightarrow 58.67\,\text{ft/s},\, \kappa = 1/430</mrow>
            <mrow>a_\text{N} \amp = \frac1{430}\big(58.67\big)^2</mrow>
            <mrow>\amp = 8.00\,\text{ft/s}^2</mrow>
          </md>.
          <md>
            <mrow>\text{45 mph, 540 ft}  \amp \Rightarrow 66\,\text{ft/s},\, \kappa = 1/540</mrow>
            <mrow>a_\text{N} \amp = \frac1{540}\big(66\big)^2</mrow>
            <mrow>\amp = 8.07\,\text{ft/s}^2</mrow>
          </md>.
        </p>

        <p>
          Note that each acceleration is similar; this is by design.
          Considering the classic <q>Force <m>=</m> mass <times/> acceleration</q> formula,
          this acceleration must be kept small in order for the tires of a vehicle to keep a
          <q>grip</q> on the road.
          If one travels on a turn of radius <quantity><mag>310</mag><unit base="foot"/></quantity>
          at a rate of <quantity><mag>50</mag><unit base="mileperhour"/></quantity>,
          the acceleration is double, at <quantity><mag>17.35</mag><unit base="foot"/><per base="second" exp="2"/></quantity>.
          If the acceleration is too high,
          the frictional force created by the tires may not be enough to keep the car from sliding.
          Civil engineers routinely compute a
          <q>safe</q> design speed,
          then subtract 5-10 mph to create the posted speed limit for additional safety.
        </p>
      </solution>
    </example>

    <p>
      We end this chapter with a reflection on what we've covered.
      We started with vector-valued functions,
      which may have seemed at the time to be just another way of writing parametric equations.
      However, we have seen that the vector perspective has given us great insight into the behavior of functions and the study of motion.
      Vector-valued position functions convey displacement,
      distance traveled, speed, velocity,
      acceleration and curvature information,
      each of which has great importance in science and engineering.
    </p>
  </subsection>

  <exercises>
    <subexercises xml:id="TaC-curvature">
      <title>Terms and Concepts</title>
      <exercise label="TaC-curvature-1">
        <!--<webwork xml:id="webwork-TaC-curvature-1">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                It is common to describe position in terms of both <fillin answer="time" mode="string" width="15"/> 
                and/or <fillin answer="distance" mode="string" width="15"/>.
              </p>
            </statement>
            <evaluation>
              <evaluate>
                <test correct="yes">
                  <jscmp><![CDATA[
                    ["time","distance"].includes(ans)
                    ]]></jscmp>
                </test>
              </evaluate>
              <evaluate>
                <test correct="yes">
                  <jscmp><![CDATA[
                    ["time","distance"].includes(ans) && !ans_array.slice(0,1).includes(ans)
                    ]]></jscmp>
                </test>
                <test>
                  <jscmp><![CDATA[
                    ans_array.slice(0,1).includes(ans)
                    ]]></jscmp>
                  <feedback>You already gave that answer.</feedback>
                </test>
              </evaluate>
            </evaluation>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-curvature-2">
        <!--<webwork xml:id="webwork-TaC-curvature-2">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                A measure of the <q>curviness</q>
                of a curve is <fillin answer="curvature" width="20"/>.
              </p>
            </statement>
            <evaluation>
              <evaluate>
                <test correct="yes">
                  <strcmp use-answer="yes" case="insensitive"/>
                </test>
              </evaluate>
            </evaluation>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-curvature-3">
        <!--<webwork xml:id="webwork-TaC-curvature-3">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                Give two shapes with constant curvature.
              </p>
            </statement>
            <response />
            
            <answer>
              <p>
                Answers may include lines, circles, helixes
              </p>
            </answer>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-curvature-4">
        <!--<webwork xml:id="webwork-TaC-curvature-4">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                Describe in your own words what an
                <q>osculating circle</q> is.
              </p>
            </statement>
            <response />
            
            <answer>
              <p>
                Answer should mention the circle is tangent to the curve and has the same curvature as the curve at that point.
              </p>
            </answer>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-curvature-5">
        <!--<webwork xml:id="webwork-TaC-curvature-5">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                Rearrange the blocks to form a valid identity.
              </p>
            </statement>
            <blocks layout="horizontal">
              <block order="10" correct="yes"><m>\unittangentprime(s)</m></block>
              <block order="2"><m>=</m></block>
              <block order="3"><m>\kappa</m></block>
              <block order="1"><m>\unitnormal(s)</m></block>
              <block order="8" correct="no"><m>\\unittangentprime(t)</m></block>
              <block order="6" correct="no"><m>\gamma</m></block>
              <block order="7" correct="no"><m>\tau</m></block>
              <block order="9" correct="no"><m>\pi</m></block>
              <block order="5" correct="no"><m>\unitnormal(t)</m></block>
            </blocks>
            <answer>
              <p>
                <m>\kappa</m>
              </p>
            </answer>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-curvature-6">
        <!--<webwork xml:id="webwork-TaC-curvature-6">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                Given a position function <m>\vrt</m>,
                how are <m>a_\text{T}</m> and
                <m>a_\text{N}</m> affected by the curvature?
              </p>
            </statement>
            <response />
            
            <answer>
              <p>
                <m>a_\text{T}</m> is not affected by curvature;
                the greater the curvature, the larger <m>a_\text{N}</m> becomes.
              </p>
            </answer>
        <!--</webwork>-->
      </exercise>
    </subexercises>
    <subexercises>
      <title>Problems</title>
      <exercisegroup cols="2" xml:id="exset-curvature-arc-param">

        <introduction>
          <p>
            In the following exercises, a position function <m>\vrt</m> is given,
            where <m>t=0</m> corresponds to the initial position.
            Find the arc length parameter <m>s</m>,
            and rewrite <m>\vrt</m> in terms of <m>s</m>;
            that is, find <m>\vec r(s)</m>.
          </p>
        </introduction>

        <exercise label="ex-curvature-arc-param-1">
          <!--<webwork xml:id="webwork-ex-curvature-arc-param-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\vrt = \la 2t, t, -2t\ra</m>
                </p>
              </statement>
              <solution>
                <p>
                  <m>s = 3t</m>, so <m>\vec r(s) = \la 2s/3, s/3, -2s/3\ra</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-arc-param-2">
          <webwork xml:id="webwork-ex-curvature-arc-param-2">
              <pg-code>
                Context("Vector2D");
                Context()-&gt;variables-&gt;are(s=&gt;'Real',t=&gt;'Real');
                $s=Formula("7t");
                $rs=Compute("&lt;7cos(s/7),7sin(s/7)&gt;");
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \la 7\cos(t) ,7\sin(t) \ra</m>.
                </p>
                <instruction>
                  Find the arc length paramter <m>s</m>.
                </instruction>
                <p>
                  <var name="$s" width="20"/>
                </p>

                <instruction>
                  Rewrite <m>\vrt</m> in terms of <m>s</m>.
                </instruction>
                <p>
                  <var name="$rs" width="20"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-arc-param-3">
          <!--<webwork xml:id="webwork-ex-curvature-arc-param-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\vrt = \la 3\cos(t) ,3\sin(t) , 2t\ra</m>
                </p>
              </statement>
              <solution>
                <p>
                  <m>s = \sqrt{13}t</m>,
                  so <m>\vec r(s) = \la 3\cos(s/\sqrt{13}), 3\sin(s/\sqrt{13}), 2s/\sqrt{13}\ra</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-arc-param-4">
          <webwork xml:id="webwork-ex-curvature-arc-param-4">
              <pg-code>
                Context("Vector");
                Context()-&gt;variables-&gt;are(s=&gt;'Real',t=&gt;'Real');
                $s=Formula("13t");
                $rs=Compute("&lt;5cos(s/13),13sin(s/13),12cos(s/13)&gt;");
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \vrt = \la 5\cos(t) ,13\sin(t) , 12\cos(t) \ra</m>.
                </p>
                <instruction>
                  Find the arc length paramter <m>s</m>.
                </instruction>
                <p>
                  <var name="$s" width="30"/>
                </p>

                <instruction>
                  Rewrite <m>\vrt</m> in terms of <m>s</m>.
                </instruction>

                <p>
                  <var name="$rs" width="30"/>
                </p>
              </statement>
          </webwork>
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-curvature-compare">

        <introduction>
          <p>
            In the following exercises,
            a curve <m>C</m> is described along with 2 points on <m>C</m>.
          </p>

          <p>
            <ol>
              <li>
                <p>
                  Using a sketch,
                  determine at which of these points the curvature is greater.
                </p>
              </li>

              <li>
                <p>
                  Find the curvature <m>\kappa</m> of <m>C</m>,
                  and evaluate <m>\kappa</m> at each of the 2 given points.
                </p>
              </li>
            </ol>
          </p>
        </introduction>

        <exercise label="ex-curvature-compare-1">
          <!--<webwork xml:id="webwork-ex-curvature-compare-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>y = x^3-x</m>;
                  points given at <m>x=0</m> and <m>x=1/2</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = \frac{\abs{6x}}{\left(1+(3x^2-1)^2\right)^{3/2}}</m>;
                </p>

                <p>
                  <m>\kappa(0) = 0</m>,
                  <m>\kappa(1/2) = \frac{192}{17\sqrt{17}} \approx 2.74</m>.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-2">
          <webwork xml:id="webwork-ex-curvature-compare-2">
              <pg-macros>
                <macro-file>parserPopUp.pl</macro-file>
              </pg-macros>
            
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $comp=DropDown(['greater than', 'equal to', 'less than'],0,showInStatic=&gt;0);
                $kappa=Compute("|(6x^2-2)/(x^2+1)^3|/(1+4x^2/(x^2+1)^4)^(3/2)");
                $k[0]=Compute("2");
                $k[1]=Formula("2750/641^(3/2)");
              </pg-code>

              <statement>
                <p>
                  <m>C</m> is defined by <m>y=\frac{1}{x^2+1}</m>; points given at
                  <m>x=0</m> and <m>x=2</m>.
                </p>

                <p>
                  The curvature at <m>x=0</m> is <var name="$comp" form="popup"/>
                  the curvature at <m>x=2</m>.
                </p>

                 <instruction>
                   Give the curvature as a function of <m>x</m>.
                 </instruction>

                <p>
                  <var name="$kappa" width="40"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(0)</m>.
                </instruction>
                <p>
                  <m>\kappa(0)=</m><var name="$k[0]" width="15"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(2)</m>.
                </instruction>
                <p>
                  <var name="$k[1]" width="15"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-compare-3">
          <!--<webwork xml:id="webwork-ex-curvature-compare-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>\ds y = \cos(x)</m>;
                  points given at <m>x=0</m> and <m>x=\pi/2</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = \frac{\abs{\cos(x) }}{\left(1+\sin^2(x) \right)^{3/2}}</m>;
                </p>

                <p>
                  <m>\kappa(0) = 1</m>, <m>\kappa(\pi/2) = 0</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-4">
          <!--<webwork xml:id="webwork-ex-curvature-compare-4">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>\ds y = \sqrt{1-x^2}</m> on <m>(-1,1)</m>;
                  points given at <m>x=0</m> and <m>x=1/2</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = 1</m>;
                </p>

                <p>
                  <m>\kappa(0) = 1</m>, <m>\kappa(1/2) = 1</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-5">
          <webwork xml:id="webwork-ex-curvature-compare-5">
              <pg-macros>
                <macro-file>parserPopUp.pl</macro-file>
              </pg-macros>
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                Context()-&gt;variables-&gt;are(t=&gt;'Real');
                $comp=DropDown(['greater than', 'equal to', 'less than'],2,showInStatic=&gt;0);
                $kappa=Compute("|2cos(t)cos(2t)+4sin(t)sin(2t)|/(4cos^2(2t)+sin^2(t))^(3/2)");
                $k[0]=Formula("1/4");
                $k[1]=Formula("8");
              </pg-code>

              <statement>
                <p>
                  <m>C</m> is defined by <m>\vrt = \la \cos(t) , \sin(2t)\ra</m>;
                  points given at <m>t=0</m> and <m>t=\pi/4</m>.
                </p>

                <p>
                  The curvature at <m>t=0</m> is <var name="$comp" form="popup"/>
                  the curvature at <m>t=\pi/4</m>.
                </p>

                 <instruction>
                   Give the curvature as a function of <m>t</m>.
                 </instruction>

                <p>
                  <var name="$kappa" width="40"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(0)</m>.
                </instruction>
                <p>
                  <m>\kappa(0)=</m><var name="$k[0]" width="15"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(pi/4)</m>.
                </instruction>
                <p>
                  <var name="$k[1]" width="15"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-compare-6">
          <!--<webwork xml:id="webwork-ex-curvature-compare-6">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>\ds \vrt = \la \cos^2(t) , \sin(t) \cos(t) \ra</m>;
                  points given at <m>t=0</m> and <m>t=\pi/3</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = 2</m>;
                </p>

                <p>
                  <m>\kappa(0) = 2</m>, <m>\kappa(\pi/3) = 2</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-7">
          <!--<webwork xml:id="webwork-ex-curvature-compare-7">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>\ds \vrt = \la t^2-1,t^3-t\ra</m>;
                  points given at <m>t=0</m> and <m>t=5</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = \frac{\abs{6t^2+2}}{\left(4t^2+(3t^2-1)^2\right)^{3/2}}</m>;
                </p>

                <p>
                  <m>\kappa(0) = 2</m>,
                  <m>\kappa(5) = \frac{19}{1394\sqrt{1394}}\approx 0.0004</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-8">
          <webwork xml:id="webwork-ex-curvature-compare-8">
              <pg-macros>
                <macro-file>parserPopUp.pl</macro-file>
              </pg-macros>
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                Context()-&gt;variables-&gt;are(t=&gt;'Real');
                $comp=DropDown(['greater than', 'equal to', 'less than'],0,showInStatic=&gt;0);
                $kappa=Compute("|sec^3(t)|/(sec^4(t)+sec^2(t)tan^2(t))^(3/2)");
                $k[0]=Formula("1");
                $k[1]=Formula("3sqrt(3)/(5sqrt(5))");
              </pg-code>

              <statement>
                <p>
                  <m>C</m> is defined by <m>\vrt = \la \tan(t) ,\sec(t) \ra</m>;
                  points given at <m>t=0</m> and <m>t=\pi/6</m>.
                </p>

                <p>
                  The curvature at <m>t=0</m> is <var name="$comp" form="popup"/>
                  the curvature at <m>t=\pi/6</m>.
                </p>

                 <instruction>
                   Give the curvature as a function of <m>t</m>.
                 </instruction>

                <p>
                  <var name="$kappa" width="40"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(0)</m>.
                </instruction>
                <p>
                  <m>\kappa(0)=</m><var name="$k[0]" width="15"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(\pi/6)</m>.
                </instruction>
                <p>
                  <var name="$k[1]" width="15"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-compare-9">
          <!--<webwork xml:id="webwork-ex-curvature-compare-9">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>\ds \vrt = \la 4t+2,3t-1,2t+5\ra</m>;
                  points given at <m>t=0</m> and <m>t=1</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = 0</m>;
                </p>

                <p>
                  <m>\kappa(0) = 0</m>, <m>\kappa(1) = 0</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-10">
          <webwork xml:id="webwork-ex-curvature-compare-10">
              <pg-macros>
                <macro-file>parserPopUp.pl</macro-file>
              </pg-macros>
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                Context()-&gt;variables-&gt;are(t=&gt;'Real');
                $comp=DropDown(['greater than', 'equal to', 'less than'],0,showInStatic=&gt;0);
                $kappa=Compute("2sqrt(18t^4+15t^2+1)/(18t^4-2t^2+1)^(3/2)");
                $k[0]=Formula("2");
                $k[1]=Formula("2sqrt(2)/17");
              </pg-code>

              <statement>
                <p>
                  <m>C</m> is defined by <m>\vrt = \la t^3-t,t^3-4,t^2-1\ra</m>;
                  points given  at <m>t=0</m> and <m>t=1</m>.
                </p>

                <p>
                  The curvature at <m>t=0</m> is <var name="$comp" form="popup"/>
                  the curvature at <m>t=1</m>.
                </p>

                 <instruction>
                   Give the curvature as a function of <m>t</m>.
                 </instruction>

                <p>
                  <var name="$kappa" width="40"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(0)</m>.
                </instruction>
                <p>
                  <m>\kappa(0)=</m><var name="$k[0]" width="15"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(1)</m>.
                </instruction>
                <p>
                  <var name="$k[1]" width="15"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-compare-11">
          <!--<webwork xml:id="webwork-ex-curvature-compare-11">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>C</m> is defined by <m>\ds \vrt = \la 3\cos(t) ,3\sin(t) , 2t\ra</m>;
                  points given at <m>t=0</m> and <m>t=\pi/2</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <m>\kappa = \frac{3}{13}</m>;
                </p>

                <p>
                  <m>\kappa(0) = 3/13</m>, <m>\kappa(\pi/2) = 3/13</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-compare-12">
          <webwork xml:id="webwork-ex-curvature-compare-12">
              <pg-macros>
                <macro-file>parserPopUp.pl</macro-file>
              </pg-macros>
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                Context()-&gt;variables-&gt;are(t=&gt;'Real');
                $comp=DropDown(['greater than', 'equal to', 'less than'],1,showInStatic=&gt;0);
                $kappa=Formula("1/13");
                $k[0]=Formula("1/13");
                $k[1]=Formula("1/13");
              </pg-code>

              <statement>
                <p>
                  <m>C</m> is defined by <m>\vrt = \la 5\cos(t) ,13\sin(t) , 12\cos(t) \ra</m>.
                  Points given at <m>t=0</m> and <m>t=\pi/2</m>.
                </p>

                <p>
                  The curvature at <m>t=0</m> is <var name="$comp" form="popup"/>
                  the curvature at <m>t=\pi/2</m>.
                </p>

                 <instruction>
                   Give the curvature as a function of <m>t</m>.
                 </instruction>

                <p>
                  <var name="$kappa" width="40"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(0)</m>.
                </instruction>
                <p>
                  <m>\kappa(0)=</m><var name="$k[0]" width="15"/>
                </p>

                <instruction>
                  Give the value of <m>\kappa(\pi/2)</m>.
                </instruction>
                <p>
                  <var name="$k[1]" width="15"/>
                </p>              </statement>
          </webwork>
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-curvature-maximum">

        <introduction>
          <p>
            Find the value of <m>x</m> or <m>t</m> where curvature is maximized.
          </p>
        </introduction>

        <exercise label="ex-curvature-maximum-1">
          <webwork xml:id="webwork-ex-curvature-maximum-1">
              <!-- <pg-macros><macro-file>parserRoot.pl</macro-file></pg-macros> -->
              <pg-code>
                parser::Root-&gt;Enable;
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $max=List(Formula("sqrt(2)/root(4,5)"), Formula("-sqrt(2)/root(4,5)"));
              </pg-code>

              <statement>
                <p>
                  <m>y=\frac{1}{6}x^3</m>
                </p>

                <p>
                  <var name="$max" width="30"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-maximum-2">
          <!--<webwork xml:id="webwork-ex-curvature-maximum-2">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds y=\sin(x)</m>
                </p>
              </statement>
              <solution>
                <p>
                  maximized at <m>x=\ldots -3\pi/2, -\pi/2, \pi/2, \ldots</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-maximum-3">
          <webwork xml:id="webwork-ex-curvature-maximum-3">
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $max=Formula("1/4");
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \la t^2+2t,3t-t^2\ra</m>
                </p>

                <p>
                  <var name="$max" width="30"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-maximum-4">
          <webwork xml:id="webwork-ex-curvature-maximum-4">
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $max=List(Formula("sqrt(5)"),Formula("-sqrt(5)"));
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \la t, 4/t, 3/t\ra</m>
                </p>

                <p>
                  <var name="$max" width="30"/>
                </p>
              </statement>
          </webwork>
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-curvature-radius">

        <introduction>
          <p>
            Find the radius of curvature at the indicated value.
          </p>
        </introduction>

        <exercise label="ex-curvature-radius-1">
          <!--<webwork xml:id="webwork-ex-curvature-radius-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>y=\tan(x)</m>, at <m>x=\pi/4</m>
                </p>
              </statement>
              <solution>
                <p>
                  radius of curvature is <m>5\sqrt{5}/4</m>.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-radius-2">
          <webwork xml:id="webwork-ex-curvature-radius-2">
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $radius=Formula("5sqrt(10)");
              </pg-code>

              <statement>
                <p>
                  <m>y=x^2+x-3</m> at <m>x=1</m>
                </p>

                <p>
                  <var name="$radius" width="15"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-radius-3">
          <!--<webwork xml:id="webwork-ex-curvature-radius-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\vrt = \la \cos(t) , \sin(3t)\ra</m>, at <m>t=0</m>
                </p>
              </statement>
              <solution>
                <p>
                  radius of curvature is <m>9</m>.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-radius-4">
          <webwork xml:id="webwork-ex-curvature-radius-4">
              <pg-code>
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $radius=Formula("1/45");
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \la 5\cos(3 t), t\ra</m> at <m>t=0</m>
                </p>

                <p>
                  <var name="$radius" width="15"/>
                </p>
              </statement>
          </webwork>
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-curvature-osculating">

        <introduction>
          <p>
            Find the equation of the osculating circle to the curve at the indicated <m>t</m>-value.
          </p>
        </introduction>

        <exercise label="ex-curvature-osculating-1">
          <!--<webwork xml:id="webwork-ex-curvature-osculating-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\vrt = \la t,t^2\ra</m>, at <m>t=0</m>
                </p>
              </statement>
              <solution>
                <p>
                  <m>x^2+(y-1/2)^2 = 1/4</m>,
                  or <m>\vec c(t) = \la 1/2\cos(t) , 1/2\sin(t) + 1/2\ra</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-osculating-2">
          <webwork xml:id="webwork-ex-curvature-osculating-2">
              <pg-code>
                Context("ImplicitEquation");
                Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[2,4]});
                Context()-&gt;variables-&gt;set(y=&gt;{limits=&gt;[-1,1]});
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $osc=ImplicitEquation("(x-8/3)^2+y^2 = 1/9");
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \la 3\cos(t) , \sin(t) \ra</m> at <m>t=0</m>
                </p>

                <p>
                  <var name="$osc" width="40"/>
                </p>
              </statement>
          </webwork>
        </exercise>

        <exercise label="ex-curvature-osculating-3">
          <!--<webwork xml:id="webwork-ex-curvature-osculating-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\vrt = \la 3\cos(t) , \sin(t) \ra</m>, at <m>t=\pi/2</m>
                </p>
              </statement>
              <solution>
                <p>
                  <m>x^2+(y+8)^2 = 81</m>,
                  or <m>\vec c(t) = \la 9\cos(t) , 9\sin(t) -8\ra</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-curvature-osculating-4">
          <webwork xml:id="webwork-ex-curvature-osculating-4">
              <pg-code>
                Context("ImplicitEquation");
                Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[-1,2]});
                Context()-&gt;variables-&gt;set(y=&gt;{limits=&gt;[-1,2]});
                Context()-&gt;flags-&gt;set(reduceConstants=&gt;0,reduceConstantFunctions=&gt;0);
                $osc=ImplicitEquation("(x-1/2)^2+(y-1/2)^2 = 1/2");
              </pg-code>

              <statement>
                <p>
                  <m>\vrt = \la t^2-t,t^2+t\ra</m> at <m>t=0</m>
                </p>

                <p>
                  <var name="$osc" width="40"/>
                </p>
              </statement>
          </webwork>
        </exercise>

      </exercisegroup>
    </subexercises>
  </exercises>
</section>
