<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_stokes_divergence" label="sec_stokes_divergence">
  <title>The Divergence Theorem and Stokes' Theorem</title>
  <subsection>
    <title>The Divergence Theorem</title>
    <p>
      <xref ref="thm_divergence1"/>
      gives the Divergence Theorem in the plane,
      which states that the flux of a vector field across a closed <em>curve</em>
      equals the sum of the divergences over the region enclosed by the curve.
      Recall that the flux was measured via a line integral,
      and the sum of the divergences was measured through a double integral.
    </p>

    <p>
      We now consider the three-dimensional version of the Divergence Theorem.
      It states, in words, that the flux across a closed <em>surface</em>
      equals the sum of the divergences over the domain enclosed by the surface.
      Since we are in space
      (versus the plane),
      we measure flux via a surface integral,
      and the sums of divergences will be measured through a triple integral.
    </p>

    <figure xml:id="vid-veccalc-stokesdiv-divthm" component="video" vshift="4">
      <caption>Introducing the Divergenge Theorem</caption>
      <video youtube="Ra6bxrTj5xU" label="vid-veccalc-stokesdiv-divthm"/>
    </figure>

    <theorem xml:id="thm_divergence2">
      <title>The Divergence Theorem (in space)</title>
      <statement>
        <p>
          Let <m>D</m> be a closed domain in space whose boundary is an orientable,
          piecewise smooth surface <m>\surfaceS</m> with outer unit normal vector <m>\vec n</m>,
          and let <m>\vec F</m> be a vector field whose components are differentiable on <m>D</m>.
          Then<idx><h>Divergence Theorem</h><h>in space</h></idx>
          <me>
            \iint_\surfaceS \vec F\cdot\vec n\, dS =\iiint_D \divv \vec F\, dV
          </me>.
        </p>
      </statement>
    </theorem>

    <aside vshift="-1">
      <p>
        <em>Note:</em> the term <q>outer unit normal vector</q>
        used in <xref ref="thm_divergence2"/>
        means <m>\vec n</m> points to the outside of <m>\surfaceS</m>.
            <idx><h>outer unit normal vector</h></idx>
      </p>
    </aside>

    <example xml:id="ex_divthm_space2">
      <title>Using the Divergence Theorem in space</title>
      <statement>
        <p>
          Let <m>D</m> be the domain in space bounded by the planes <m>z=0</m> and <m>z=2x</m>,
          along with the cylinder <m>x=1-y^2</m>,
          as graphed in <xref ref="fig_divthm_space2"/>,
          let <m>\surfaceS</m> be the boundary of <m>D</m>,
          and let <m>\vec F = \langle x+y,y^2, 2z\rangle</m>.
        </p>

        <figure xml:id="fig_divthm_space2" vshift="-6">
          <caption>The surfaces used in  <xref ref="ex_divthm_space2"/></caption>
          <image width="47%">
            <shortdescription>A parabolic wedge, bounded by two planes and a parabolic cylinder.</shortdescription>
            <description>
              <p>
                The <m>x</m>, <m>y</m>, and <m>z</m> axes are plotted in three dimensions.
                The <m>z</m> axis points up, the <m>x</m> axis points back and to the left,
                and the <m>y</m> axis points toward us and to the left.
              </p>

              <p>
                The surface consists of three components:
                <ul>
                  <li>
                    <p>
                      In the <m>xy</m> plane is the region bounded by the <m>y</m> axis
                      and the parabola <m>x=1-y^2</m>.
                    </p>

                    <p>
                      The parabola has its vertex at <m>(1,0,0)</m> and it meets the
                      <m>y</m> axis at <m>(0,1,0)</m> and <m>(0,-1,0)</m>
                    </p>
                  </li>

                  <li>
                    <p>
                      Another parabolic region lies in the plane <m>z=2x</m>.
                      This plane intersects the <m>y</m> axis along the segment <m>-1\leq y\leq 1</m>,
                      which is the common bottom of the two parabolic regions;
                      it forms a sharp edge where the two planes meet.
                    </p>

                    <p>
                      The parabolic boundary of this region is the curve given by
                      <m>\vec{r}(t) = \la 1-t^2, t, 2-2t^2\ra</m>.
                      This is a parabola in the plane <m>z=2x</m> that lies directly above the parabola <m>x=1-y^2</m> in the <m>xy</m> plane.
                    </p>
                  </li>

                  <li>
                    <p>
                      The remaining surface is the partion of the parabolic cylinder <m>x=1-y^2</m>
                      that lies between the planes <m>z=0</m> and <m>z=2x</m>.
                    </p>
                  </li>
                </ul>
              </p>

              <p>
                Overall, the surfaces form a wedge shape similar to a segment that might be cut from a tree being chopped down.
              </p>
            </description>
            <asymptote label="img_divthm_space2_3D">



              //ASY file for divthm_space2_3D.asy in Chapter 14

              size(200,200,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(-17,32,12.6);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={1};
              real[] myychoice={-1,1};
              real[] myzchoice={2};
              defaultpen(0.5mm);

              pair xbounds=(-.1,1.2);
              pair ybounds=(-1.3,1.3);
              pair zbounds=(-.1,2.2);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

              //Draw the planar parabola
              triple f(pair t) {
                return (t.y*(1-t.x^2),t.x,0);//
              }
              surface s=surface(f,(-1,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=redmeshpen;
              draw(s,surfacepen2,meshpen=p);

              //Draw plane over parabola
              triple f(pair t) {
                return (t.y*(1-t.x^2),t.x,2*t.y*(1-t.x^2));//
              }
              surface s=surface(f,(-1,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=apexmeshpen;
              draw(s,surfacepen,meshpen=p);

              //Draw parabolic cylinder side
              triple f(pair t) {
                return ((1-t.x^2),t.x,2*t.y*(1-t.x^2));//
              }
              surface s=surface(f,(-1,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=apexmeshpen;
              draw(s,surfacepen,meshpen=p);

              triple f(real t) {return (1-t^2,t,0);}
              path3 mypath=graph(f,-1,1,operator ..);
              draw(mypath,curvepen);

              triple f(real t) {return (1-t^2,t,2*(1-t^2));}
              path3 mypath=graph(f,-1,1,operator ..);
              draw(mypath,curvepen);

            </asymptote>
          </image>
        </figure>

        <p>
          Verify the Divergence Theorem by finding the total outward flux of <m>\vec F</m> across <m>\surfaceS</m>, and show this is equal to <m>\iiint_D \divv\vec F\, dV</m>.
        </p>
      </statement>
      <solution>
        <p>
          The surface <m>\surfaceS</m> is piecewise smooth,
          comprising surfaces <m>\surfaceS_1</m>,
          which is part of the plane <m>z=2x</m>,
          surface <m>\surfaceS_2</m>, which is part of the cylinder <m>x=1-y^2</m>,
          and surface <m>\surfaceS_3</m>,
          which is part of the plane <m>z=0</m>.
          To find the total outward flux across <m>\surfaceS</m>, we need to compute the outward flux across each of these three surfaces.
        </p>

        <p>
          We leave it to the reader to confirm that surfaces <m>\surfaceS_1</m>,
          <m>\surfaceS_2</m> and <m>\surfaceS_3</m> can be parametrized by <m>\vec r_1</m>,
          <m>\vec r_2</m> and <m>\vec r_3</m> respectively as
          <md>
            <mrow>\vec r_1(u,v) \amp = \la v(1-u^2), u, 2v(1-u^2)\ra,</mrow>
            <mrow>\vec r_2(u,v) \amp = \la (1-u^2), u, 2v(1-u^2)\ra,</mrow>
            <mrow>\vec r_3(u,v) \amp = \la v(1-u^2), u, 0\ra</mrow>
          </md>,
          where <m>-1\leq u\leq 1</m> and
          <m>0\leq v\leq 1</m> for all three functions.
        </p>

        <p>
          We compute a unit normal vector <m>\vec n</m> for each as <m>\frac{\vec r_u\times\vec r_v}{\snorm{\vec r_u\times\vec r_v}}</m>,
          though recall that as we are integrating <m>\vec F\cdot \vec n\, dS</m>,
          we actually only use <m>\vec r_u\times\vec r_v</m>.
          Finally, in previous flux computations,
          it did not matter which direction <m>\vec n</m> pointed as long as we made note of its direction.
          When using the Divergence Theorem,
          we need <m>\vec n</m> to point to the outside of the closed surface,
          so in practice this means we'll either use
          <m>\vec r_u\times\vec r_v</m> or <m>\vec r_v\times\vec r_u</m>,
          depending on which points outside of the closed surface <m>\surfaceS</m>.
        </p>

        <p>
          We leave it to the reader to confirm the following cross products and integrations are correct.
        </p>

        <p>
          For <m>\surfaceS_1</m>,
          we need to use <m>\vec r_{1v}\times\vec r_{1u} = \langle 2(u^2-1),0,1-u^2\rangle</m>.
          (Note the <m>z</m>-component is nonnegative as <m>u\leq 1</m>,
          therefore this vector always points up,
          meaning <em>to the outside</em>, of <m>\surfaceS</m>.)
          The flux across <m>\surfaceS_1</m> is:
          <md>
            <mrow>\text{ Flux across }\surfaceS_1:\,   \amp = \iint_{\surfaceS_1} \vec F\cdot \vec n_1\, dS</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \vec F\big(\vec r_1(u,v)\big)\cdot \big(\vec r_{1v}\times\vec r_{1u}\big)\, du\, dv</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \la v(1-u^2)+u, u^2,4v(1-u^2)\ra \cdot \la 2(u^2-1),0,1-u^2\ra\, du\, dv</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \big(2u^4v+2u^3-4u^2v-2u+2v\big)\, du\, dv</mrow>
            <mrow>\amp = \frac{16}{15}</mrow>
          </md>.
        </p>

        <p>
          For <m>\surfaceS_2</m>,
          we use <m>\vec r_{2u}\times\vec r_{2v} = \langle 2(1-u^2), 4u(1-u^2),0\rangle</m>.
          (Note the <m>x</m>-component is always nonnegative,
          meaning this vector points outside <m>\surfaceS</m>.)
          The flux across <m>\surfaceS_2</m> is:
          <md>
            <mrow>\text{ Flux across } \surfaceS_2:\,  \amp = \iint_{\surfaceS_2} \vec F\cdot \vec n_2\, dS</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \vec F\big(\vec r_2(u,v)\big)\cdot \big(\vec r_{2u}\times\vec r_{2v}\big)\, du\, dv</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \la 1-u^2+u, u^2, 4v(1-u^2)\ra \cdot \la 2(1-u^2), 4u(1-u^2),0\ra\, du\, dv</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \big(4u^5-2u^4-2u^3+4u^2-2u-2\big)\, du\, dv</mrow>
            <mrow>\amp = \frac{32}{15}</mrow>
          </md>.
        </p>

        <p>
          For <m>\surfaceS_3</m>,
          we use <m>\vec r_{3u}\times\vec r_{3v} = \langle 0,0,u^2-1\rangle</m>.
          (Note the <m>z</m>-component is never positive,
          meaning this vector points down, outside of <m>\surfaceS</m>.)
          The flux across <m>\surfaceS_3</m> is:
          <md>
            <mrow>\text{ Flux across } \surfaceS_3:\,  \amp = \iint_{\surfaceS_3} \vec F\cdot \vec n_3\, dS</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \vec F\big(\vec r_3(u,v)\big)\cdot \big(\vec r_{3u}\times\vec r_{3v}\big)\, du\, dv</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 \la v(1-u^2)+u,u^2,0\ra \cdot \la 0,0,u^2-1\ra\, du\, dv</mrow>
            <mrow>\amp = \int_0^1\int_{-1}^1 0\, du\, dv</mrow>
            <mrow>\amp = 0</mrow>
          </md>.
        </p>

        <p>
          Thus the total outward flux,
          measured by surface integrals across all three component surfaces of <m>\surfaceS</m>, is <m>16/15+32/15+0 = 48/15 = 16/5 = 3.2</m>.
          We now find the total outward flux by integrating <m>\divv \vec F</m> over <m>D</m>.
        </p>

        <p>
          Following the steps outlined in <xref ref="sec_triple_int"/>,
          we see the bounds of <m>x</m>,
          <m>y</m> and <m>z</m> can be set as (thinking <q>surface to surface,
          curve to curve, point to point</q>):
          <me>
            0\leq z\leq 2x; 0\leq x\leq 1-y^2; -1\leq y\leq 1
          </me>.
        </p>

        <p>
          With <m>\divv \vec F = 1+2y+2 = 2y+3</m>,
          we find the total outward flux of <m>\vec F</m> over <m>\surfaceS</m> as:
          <me>
            \text{ Flux = }  \iiint_D\divv \vec F\, dV = \int_{-1}^1\int_0^{1-y^2}\int_0^{2x}\big(2y+3\big)\, dz\, dx\, dy = 16/5
          </me>,
          the same result we obtained previously.
        </p>
      </solution>
    </example>

    <p>
      In <xref ref="ex_divthm_space2"/>
      we see that the total outward flux of a vector field across a closed surface can be found two different ways because of the Divergence Theorem.
      One computation took far less work to obtain.
      In that particular case,
      since <m>\surfaceS</m> was comprised of three separate surfaces,
      it was far simpler to compute one triple integral than three surface integrals
      (each of which required partial derivatives and a cross product).
      In practice, if outward flux needs to be measured,
      one would choose only one method.
      We will use both methods in this section simply to reinforce the truth of the Divergence Theorem.
    </p>

    <p>
      We practice again in the following example.
    </p>

    <example xml:id="ex_divthm_space1">
      <title>Using the Divergence Theorem in space</title>
      <statement>
        <p>
          Let <m>\surfaceS</m> be the surface formed by the paraboloid <m>z=1-x^2-y^2</m>,
          <m>z\geq 0</m>,
          and the unit disk centered at the origin in the <m>xy</m>-plane,
          graphed in <xref ref="fig_divthm_space1"/>,
          and let <m>\vec F = \langle 0,0,z\rangle</m>.
          (This surface and vector field were used in <xref ref="ex_surfflux2"/>.)
        </p>

        <figure xml:id="fig_divthm_space1" vshift="0">
          <caption>The surfaces used in  <xref ref="ex_divthm_space1"/></caption>
          <image width="47%">
            <shortdescription>A circular paraboloid, opening downward, meets the x,y plane along the unit circle. The interior of the circle is a disk.</shortdescription>
            <description>
              <p>
                This is the same image used in <xref ref="fig_surfflux2"/>.
                A circular paraboloid has its vertex at <m>(0,0,1)</m> on the <m>z</m> axis and opens downward,
                meeting the <m>xy</m> plane along the unit circle.
              </p>

              <p>
                The interior of the unit circle is a disk that serves as a cap at the bottom of the paraboloid.
              </p>
            </description>
            <asymptote label="img_divthm_space1_3D">



              //ASY file for figsurfint1_3D.asy in Chapter 14

              size(200,200,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(22.8,20,5.5);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={1};
              real[] myychoice={2};
              real[] myzchoice={3};
              defaultpen(0.5mm);

              pair xbounds=(-1.1,1.1);
              pair ybounds=(-1.1,1.1);
              pair zbounds=(-.1,1.1);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

              //Draw the plane unit disk
              triple f(pair t) {
                return (t.y*cos(t.x),t.y*sin(t.x),0);//
              }
              surface s=surface(f,(-pi/2,0),(3pi/2,1),8,8,usplinetype=Spline,vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=redmeshpen;
              draw(s,surfacepen2,meshpen=p);

              //Draw paraboloid over unit disk
              triple f(pair t) {
                return (t.y*cos(t.x),t.y*sin(t.x),1-t.y^2);//
              }
              surface s=surface(f,(0,0),(2pi,1),8,8,Spline);
              pen p=apexmeshpen;
              draw(s,surfacepen,meshpen=p);

              triple f(real t) {return (cos(t),sin(t),0);}
              path3 mypath=graph(f,0,2pi,operator ..);
              draw(mypath,curvepen);

            </asymptote>
          </image>
        </figure>

        <p>
          Verify the Divergence Theorem;
          find the total outward flux across <m>\surfaceS</m> and evaluate the triple integral of <m>\divv \vec F</m>,
          showing that these two quantities are equal.
        </p>
      </statement>
      <solution>
        <p>
          We find the flux across <m>\surfaceS</m> first.
          As <m>\surfaceS</m> is piecewise-smooth,
          we decompose it into smooth components <m>\surfaceS_1</m>,
          the disk,
          and <m>\surfaceS_2</m>, the paraboloid,
          and find the flux across each.
        </p>

        <p>
          In <xref ref="ex_surfflux2"/>,
          we found the flux across <m>\surfaceS_1</m> is 0.
          We also found that the flux across <m>\surfaceS_2</m> is <m>\pi/2</m>.
          (In that example,
          the normal vector had a positive <m>z</m> component hence was an outer normal.)
          Thus the total outward flux is <m>0+\pi/2 = \pi/2</m>.
        </p>

        <p>
          We now compute <m>\iiint_D \divv \vec F\, dV</m>.
          We can describe <m>D</m> as the domain bounded by (think <q>surface to surface,
          curve to curve, point to point</q>):
          <me>
            0\leq z\leq 1-x^2-y^2,  -\sqrt{1-x^2}\leq y\leq \sqrt{1-x^2}, -1\leq x\leq 1
          </me>.
        </p>

        <p>
          This description of <m>D</m> is not very easy to integrate.
          With polar, we can do better.
          Let <m>R</m> represent the unit disk,
          which can be described in polar simply as <m>r</m>,
          where <m>0\leq r\leq 1</m> and <m>0\leq \theta\leq 2\pi</m>.
          With <m>x=r\cos \theta</m> and <m>y=r\sin\theta</m>,
          the surface <m>\surfaceS_2</m> becomes
          <me>
            z=1-x^2-y^2 \Rightarrow 1-(r\cos\theta)^2-(r\sin\theta)^2 \Rightarrow 1-r^2
          </me>.
        </p>

        <p>
          Thus <m>D</m> can be described as the domain bounded by:
          <me>
            0\leq z\leq 1-r^2, 0\leq r\leq 1, 0\leq \theta\leq 2\pi
          </me>.
        </p>

        <p>
          With <m>\divv \vec F = 1</m>,
          we can integrate, recalling that <m>dV = r\, dz\, dr\, d\theta</m>:
          <me>
            \iiint_D\divv \vec F\, dV = \int_0^{2\pi}\int_0^1\int_0^{1-r^2} r\, dz\, dr\, d\theta = \frac{\pi}2
          </me>,
          which matches our flux computation above.
        </p>
      </solution>
    </example>

    <example xml:id="ex_divthm_space3">
      <title>A <q>paradox</q> of the Divergence Theorem and Gauss's Law</title>
      <statement>
        <p>
          The magnitude of many physical quantities
          (such as light intensity or electromagnetic and gravitational forces)
          follow an <q>inverse square law</q>:
          the magnitude of the quantity at a point is inversely proportional to the square of the distance to the source of the quantity.
              <idx><h>Gauss's Law</h></idx>
        </p>

        <p>
          Let a point light source be placed at the origin and let <m>\vec F</m> be the vector field which describes the intensity and direction of the emanating light.
          At a point <m>(x,y,z)</m>,
          the unit vector describing the direction of the light passing through that point is <m>\langle x,y,z\rangle/\sqrt{x^2+y^2+z^2}</m>.
          As the intensity of light follows the inverse square law,
          the magnitude of <m>\vec F</m> at <m>(x,y,z)</m> is
          <m>k/(x^2+y^2+z^2)</m> for some constant <m>k</m>.
          Taken together,
          <me>
            \vec F(x,y,z) = \frac{k}{(x^2+y^2+z^2)^{3/2}}\langle x,y,z\rangle
          </me>.
        </p>

        <p>
          Consider the cube, centered at the origin,
          with sides of length <m>2a</m> for some <m>a \gt 0</m> (hence corners of the cube lie at <m>(a,a,a)</m>,
          <m>(-a,-a,-a)</m>,
          etc., as shown in <xref ref="fig_divthm_space3"/>).
          Find the flux across the six faces of the cube and compare this to <m>\iint_D \divv\vec F\, dV</m>.
        </p>

        <figure xml:id="fig_divthm_space3" vshift="0">
          <caption>The cube used in  <xref ref="ex_divthm_space3"/></caption>
          <image width="47%">
            <shortdescription>A cube centered at the origin in space.</shortdescription>
            <description>
              <p>
                A cube is drawn in space, relative to three-dimensional coordinate axes.
                It is centered at the origin, and its faces are parallel to the coordinate planes.
              </p>

              <p>
                One corner of the cube (the nearest one in the perspective used for the image)
                is labeled with the coordinates <m>(a,a,a)</m>.
                The opposite corner is labeled with coordinates <m>(-a,-a,-a)</m>.
              </p>
            </description>
            <asymptote label="img_divthm_space3_3D">



              //ASY file for divthm_space3_3D.asy in Chapter 14

              size(200,200,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(30,20,12);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={};
              real[] myychoice={};
              real[] myzchoice={};
              defaultpen(0.5mm);

              pair xbounds=(-1.2,1.2);
              pair ybounds=(-1.2,1.2);
              pair zbounds=(-1.2,1.2);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

              //Draw the faces of the cube
              pen p=apexmeshpen;

              triple f(pair t) {
                return (t.x,t.y,1);//
              }
              surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,surfacepen,meshpen=p);

              triple f(pair t) {
                return (t.x,t.y,-1);//
              }
              surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,surfacepen,meshpen=p);

              triple f(pair t) {
                return (t.x,1,t.y);//
              }
              surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,surfacepen,meshpen=p);

              triple f(pair t) {
                return (t.x,-1,t.y);//
              }
              surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,surfacepen,meshpen=p);

              triple f(pair t) {
                return (1,t.x,t.y);//
              }
              surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,surfacepen,meshpen=p);

              triple f(pair t) {
                return (-1,t.x,t.y);//
              }
              surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,surfacepen,meshpen=p);

              label("$(a,a,a)$",(1.05,1.05,1.1));
              label("$(-a,-a,-a)$",(-1.05,-1.05,-1.1));
              dot((1,1,1),black+1mm);

              dot((-1,-1,-1),black+1mm);

            </asymptote>
          </image>
        </figure>
      </statement>
      <solution>
        <p>
          Let <m>\surfaceS_1</m> be the <q>top</q> face of the cube,
          which can be parametrized by <m>\vec r(u,v) = \langle u,v,a\rangle</m> for
          <m>-a\leq u\leq a</m>, <m>-a\leq v\leq a</m>.
          We leave it to the reader to confirm that <m>\vec r_u\times \vec r_v = \langle 0,0,1\rangle</m>,
          which points outside of the cube.
        </p>

        <p>
          The flux across this face is:
          <md>
            <mrow>\text{ Flux }  \amp = \iint_{\surfaceS_1} \vec F\cdot \vec n\, dS</mrow>
            <mrow>\amp = \int_{-a}^a\int_{-a}^a \vec F\big(\vec r(u,v)\big)\cdot \big(\vec r_u\times \vec r_v\big)\, du\, dv</mrow>
            <mrow>\amp = \int_{-a}^a\int_{-a}^a \frac{k\ a}{(u^2+v^2+a^2)^{3/2}}\, du\, dv.</mrow>
            <intertext>This double integral is <em>not</em> trivial to compute, requiring multiple trigonometric substitutions. This example is not meant to stress integration techniques, so we leave it to the reader to confirm the result is</intertext>
            <mrow>\amp = \frac{2k\pi}3</mrow>
          </md>.
        </p>

        <p>
          Note how the result is independent of <m>a</m>;
          no matter the size of the cube,
          the flux through the top surface is always <m>2k\pi/3</m>.
        </p>

        <p>
          An argument of symmetry shows that the flux through each of the six faces is <m>2k\pi/3</m>,
          thus the total flux through the faces of the cube is <m>6\times2k\pi/3 = 4k\pi</m>.
        </p>

        <p>
          It takes a bit of algebra, but we can show that <m>\divv\vec F = 0</m>.
          Thus the Divergence Theorem would seem to imply that the total flux through the faces of the cube should be
          <me>
            \text{ Flux } =\iiint_D \divv \vec F\, dV = \iiint_D 0\, dV = 0
          </me>,
          but clearly this does not match the result from above.
          What went wrong?
        </p>

        <p>
          Revisit the statement of the Divergence Theorem.
          One of the conditions is that the components of <m>\vec F</m> must be differentiable on the domain enclosed by the surface.
          In our case, <m>\vec F</m> is <em>not</em>
          differentiable at the origin <mdash/> it is not even defined!
          As <m>\vec F</m> does not satisfy the conditions of the Divergence Theorem,
          it does not apply,
          and we cannot expect <m>\iint_\surfaceS \vec F\cdot\vec n\, dA = \iiint_D \divv\vec F\, dV</m>.
        </p>

        <p>
          Since <m>\vec F</m> is differentiable everywhere except the origin,
          the Divergence Theorem does apply over any domain that does not include the origin.
          Let <m>\surfaceS_2</m> be any surface that encloses the cube used before,
          and let <m>\hat D</m> be the domain <em>between</em>
          the cube and <m>\surfaceS_2</m>;
          note how <m>\hat D</m> does not include the origin and so the Divergence Theorem does apply over this domain.
          The total outward flux over <m>\hat D</m> is thus <m>\iint_{\hat D}\divv \vec F\, dV = 0</m>,
          which means the amount of flux coming out of
          <m>\surfaceS_2</m> is the same as the amount of flux coming out of the cube.
          The conclusion: the flux across <em>any</em>
          surface enclosing the origin will be <m>4k\pi</m>.
        </p>

        <p>
          This has an important consequence in electrodynamics.
          Let <m>q</m> be a point charge at the origin.
          The electric field generated by this point charge is
          <me>
            \vec E = \frac{q}{4\pi \epsilon_0}\frac{\la x,y,z\ra}{(x^2+y^2+z^2)^{3/2}}
          </me>,
          <ie/>, it is <m>\vec F</m> with <m>k = q/(4\pi \epsilon_0)</m>,
          where <m>\epsilon_0</m> is a physical constant
          (the <q>permittivity of free space</q>).
          Gauss's Law states that the outward flux of <m>\vec E</m> across any surface enclosing the origin is <m>q/\epsilon_0</m>.
        </p>
      </solution>
    </example>

    <figure xml:id="vid-veccalc-stokesdiv-gauss" component="video" vshift="0">
      <caption>Exploring Gauss's Law</caption>
      <video youtube="Zc_OAF_CRIQ" label="vid-veccalc-stokesdiv-gauss"/>
    </figure>

    <p>
      Our interest in the Divergence Theorem is twofold.
      First, its truth alone is interesting:
      to study the behavior of a vector field across a closed surface,
      one can examine properties of that field within the surface.
      Secondly, it offers an alternative way of computing flux.
      When there are multiple methods of computing a desired quantity,
      one has power to select the easiest computation as illustrated next.
    </p>

    <example xml:id="ex_divthm_space4">
      <title>Using the Divergence Theorem to compute flux</title>
      <statement>
        <p>
          Let <m>\surfaceS</m> be the cube bounded by the planes <m>x=\pm 1</m>,
          <m>y=\pm 1</m>, <m>z=\pm 1</m>,
          and let <m>\vec F = \langle x^2y,2yz,x^2z^3\rangle</m>.
          Compute the outward flux of <m>\vec F</m> over <m>\surfaceS</m>.
        </p>
      </statement>
      <solution>
        <p>
          We compute <m>\divv \vec F = 2xy+2z+3x^2z^2</m>.
          By the Divergence Theorem,
          the outward flux is the triple integral over the domain <m>D</m> enclosed by <m>\surfaceS</m>:
          <me>
            \text{ Outward flux: }  \int_{-1}^1\int_{-1}^1\int_{-1}^1(2xy+2z+3x^2z^2)\, dz\, dy\, dx = \frac83
          </me>.
        </p>

        <p>
          The direct flux computation requires six surface integrals,
          one for each face of the cube.
          The Divergence Theorem offers a much more simple computation.
        </p>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>Stokes' Theorem</title>
    <p>
      Just as the spatial Divergence Theorem of this section is an extension of the planar Divergence Theorem, Stokes' Theorem is the spatial extension of Green's Theorem.
      Recall that Green's Theorem states that the circulation of a vector field around a closed curve in the plane is equal to the sum of the curl of the field over the region enclosed by the curve.
      Stokes' Theorem effectively makes the same statement:
      given a closed curve that lies on a surface <m>\surfaceS</m>, the circulation of a vector field around that curve is the same as the sum of
      <q>the curl of the field</q>
      across the enclosed surface.
      We use quotes around <q>the curl of the field</q>
      to signify that this statement is not quite correct,
      as we do not sum <m>\curl \vec F</m>,
      but <m>\curl \vec F\cdot\vec n</m>,
      where <m>\vec n</m> is a unit vector normal to <m>\surfaceS</m>. That is,
      we sum the portion of <m>\curl \vec F</m> that is orthogonal to <m>\surfaceS</m> at a point.
    </p>

    <figure xml:id="vid-veccalc-stokesdiv-stokes-thm" component="video" vshift="0">
      <caption>Introducing Stokes' Theorem</caption>
      <video youtube="WzrQbtC7ZiU" label="vid-veccalc-stokesdiv-stokes-thm"/>
    </figure>

    <p>
      Green's Theorem dictated that the curve was to be traversed counterclockwise when measuring circulation.
      Stokes' Theorem will follow a right hand rule:
      when the thumb of one's right hand points in the direction of <m>\vec n</m>,
      the path <m>C</m> will be traversed in the direction of the curling fingers of the hand
      (this is equivalent to traversing counterclockwise in the plane).
    </p>

    <theorem xml:id="thm_stokes_thm">
      <title>Stokes' Theorem</title>
      <statement>
        <p>
          Let <m>\surfaceS</m> be a piecewise smooth,
          orientable surface whose boundary is a piecewise smooth curve <m>C</m>,
          let <m>\vec n</m> be a unit vector normal to <m>\surfaceS</m>, let <m>C</m> be traversed with respect to <m>\vec n</m> according to the right hand rule,
          and let the components of <m>\vec F</m> have continuous first partial derivatives over <m>\surfaceS</m>. Then
              <idx><h>Stokes' Theorem</h></idx>
          <me>
            \oint_C \vec F\cdot \, d\vec r = \iint_\surfaceS (\curl\vec F)\cdot \vec n\, dS
          </me>.
        </p>
      </statement>
    </theorem>

    <p>
      In general, the best approach to evaluating the surface integral in Stokes' Theorem is to parametrize the surface <m>\surfaceS</m> with a function <m>\vec r(u,v)</m>.
      We can find a unit normal vector <m>\vec n</m> as
      <me>
        \vec n = \frac{\vec r_u\times\vec r_v}{\snorm{\vec r_u\times\vec r_v}}
      </me>.
    </p>

    <p>
      Since <m>dS = \snorm{\vec r_u\times\vec r_v}\, dA</m>,
      the surface integral in practice is evaluated as
      <me>
        \iint_\surfaceS (\curl \vec F)\cdot (\vec r_u\times\vec r_v)\, dA
      </me>,
      where <m>\vec r_u\times\vec r_v</m> may be replaced by
      <m>\vec r_v\times\vec r_u</m> to properly match the direction of this vector with the orientation of the parametrization of <m>C</m>.
    </p>

    <example xml:id="ex_stokes1">
      <title>Verifying Stokes' Theorem</title>
      <statement>
        <p>
          Considering the planar surface <m>f(x,y) = 7-2x-2y</m>,
          let <m>C</m> be the curve in space that lies on this surface above the circle of radius 1 and centered at <m>(1,1)</m> in the <m>xy</m>-plane,
          let <m>\surfaceS</m> be the planar region enclosed by <m>C</m>,
          as illustrated in <xref ref="fig_stokes1"/>,
          and let <m>\vec F = \langle x+y,2y, y^2\rangle</m>.
          Verify Stoke's Theorem by showing <m>\oint_C \vec F\cdot \, d\vec r = \iint_\surfaceS (\curl\vec F)\cdot \vec n\, dS</m>.
        </p>

        <figure xml:id="fig_stokes1" vshift="0">
          <caption>As given in <xref ref="ex_stokes1"/>, the surface <m>\surfaceS</m><nbsp/>is the portion of the plane bounded by the curve</caption>
          <image width="47%">
            <shortdescription>An ellipse drawn on a plane in space. It lies over a circle in the x,y plane.</shortdescription>
            <description>
              <p>
                The usual three-dimensional coordinate axes are shown,
                with the <m>x</m> axis toward us and to the left,
                the <m>y</m> axis toward us and to the right, and the <m>z</m> axis pointing up.
              </p>

              <p>
                A circle is drawn in the <m>xy</m> plane. It lies in the first quadrant;
                its center is at <m>(1,1,0)</m>, and its radius is <m>1</m>.
                It intercepts the <m>x</m> axis at <m>(1,0,0)</m>, and the <m>y</m> axis at <m>(0,1,0)</m>.
              </p>

              <p>
                A plane in space is drawn in the first octant.
                It is shaped like a rectangle; its highest corner is on the <m>z</m> axis at <m>(0,0,7)</m>;
                the opposite corner is lowest, at <m>(2,2,-1)</m>.
              </p>

              <p>
                On the plane, a curve <m>C</m> is drawn.
                The curve is an ellipse, consisting of all points in the plane that lie above the circle in the <m>xy</m> plane.
                The surface <m>\surfaceS</m> for this problem is the region on and inside this ellipse.
              </p>
            </description>
            <asymptote label="fig_stokes1_3D">



              //ASY file for figstokes1_3D.asy in Chapter 13

              size(200,200,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(11,19,27);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={1,2};
              real[] myychoice={1,2};
              real[] myzchoice={2,4,6,8};
              defaultpen(0.5mm);

              pair xbounds=(-.1,2.5);
              pair ybounds=(-.1,2.5);
              pair zbounds=(-.1,9);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
                return (t.x,t.y,-2t.x-2t.y+7);//
              }
              surface s=surface(f,(-.1,-.1),(2.2,2.2),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=apexmeshpen;
              draw(s,surfacepen,meshpen=p);

              triple g(real t) {return (cos(t)+1,sin(t)+1,7-2(cos(t)+1)-2(sin(t)+1));}
              path3 mypath=graph(g,0,2pi,operator ..);
              draw(mypath,bluepen+linewidth(2));

              triple g(real t) {return (cos(t)+1,sin(t)+1,0);}
              path3 mypath=graph(g,0,2pi,operator ..);
              draw(mypath,bluepen+dashed+linewidth(1));

              label("$\mathcal{S}$",(1,1,4));
              //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);

            </asymptote>
          </image>
        </figure>
      </statement>
      <solution>
        <p>
          We begin by parametrizing <m>C</m> and then find the circulation.
          A unit circle centered at <m>(1,1)</m> can be parametrized with <m>x=\cos(t)+1</m>,
          <m>y=\sin(t)+1</m> on <m>0\leq t\leq 2\pi</m>;
          to put this curve on the surface <m>f</m>,
          make the <m>z</m> component equal <m>f(x,y)</m>:
          <m>z = 7-2(\cos(t)+1)-2(\sin(t)+1) = 3-2\cos(t) - 2\sin(t)</m>.
          All together,
          we parametrize <m>C</m> with <m>\vec r(t) = \la \cos(t)+1, \sin(t)+1, 3-2\cos(t)-2\sin(t)\ra</m>.
        </p>

        <p>
          The circulation of <m>\vec F</m> around <m>C</m> is
          <md>
            <mrow>\oint_C\vec F\cdot \, d\vec r \amp = \int_0^{2\pi}\vec F\big(\vec r(t)\big)\cdot \vrp(t)\, dt</mrow>
            <mrow>\amp = \int_0^{2\pi}\big(2\sin^3t-2\cos(t)\sin^2t+3\sin^2t-3\cos(t)\sin(t)\big)\, dt</mrow>
            <mrow>\amp = 3\pi</mrow>
          </md>.
        </p>

        <p>
          We now parametrize <m>\surfaceS</m>. (We reuse the letter <q>r</q>
          for our surface as this is our custom.) Based on the parametrization of <m>C</m> above,
          we describe <m>\surfaceS</m> with <m>\vec r(u,v) = \la v\cos(u)+1, v\sin(u)+1, 3-2v\cos(u)-2v\sin(u)\ra</m>,
          where <m>0\leq u\leq 2\pi</m> and <m>0\leq v\leq 1</m>.
        </p>

        <p>
          We leave it to the reader to confirm that <m>\vec r_u\times \vec r_v = \langle 2v,2v,v\rangle</m>.
          As <m>0\leq v\leq 1</m>,
          this vector always has a non-negative <m>z</m>-component,
          which the right-hand rule requires given the orientation of <m>C</m> used above.
          We also leave it to the reader to confirm <m>\curl\vec F = \langle 2y,0,-1\rangle</m>.
        </p>

        <p>
          The surface integral of Stokes' Theorem is thus
          <md>
            <mrow>\iint_\surfaceS (\curl\vec F)\cdot \vec n\, dS \amp = \iint_\surfaceS (\curl\vec F)\cdot (\vec r_u\times \vec r_v)\, dA</mrow>
            <mrow>\amp = \int_0^1\int_0^{2\pi} \langle 2v\sin(u)+2,0,-1\rangle\cdot\langle 2v,2v,v\rangle\, du\, dv</mrow>
            <mrow>\amp = 3\pi</mrow>
          </md>,
          which matches our previous result.
        </p>
      </solution>
    </example>

    <figure xml:id="vid-veccalc-stokesdiv-stokes-eg1" component="video" vshift="0">
      <caption>An example with Stokes' Theorem</caption>
      <video youtube="IxDa_2_Eric" label="vid-veccalc-stokesdiv-stokes-eg1"/>
    </figure>
    <p>
      One of the interesting results of Stokes' Theorem is that if two surfaces <m>\surfaceS_1</m> and
      <m>\surfaceS_2</m> share the same boundary,
      then <m>\iint_{\surfaceS_1} (\curl \vec F)\cdot \vec n\, dS = \iint_{\surfaceS_2} (\curl \vec F)\cdot \vec n\, dS</m>.
      That is, the value of these two surface integrals is somehow independent of the interior of the surface.
      We demonstrate this principle in the next example.
    </p>

    <example xml:id="ex_stokes2">
      <title>Stokes' Theorem and surfaces that share a boundary</title>
      <statement>
        <p>
          Let <m>C</m> be the curve given in <xref ref="ex_stokes1"/>
          and note that it lies on the surface <m>z = 6-x^2-y^2</m>.
          Let <m>\surfaceS</m> be the region of this surface bounded by <m>C</m>,
          and let <m>\vec F = \langle x+y,2y,y^2\rangle</m> as in the previous example.
          Compute <m>\iint_\surfaceS (\curl\vec F)\cdot \vec n\, dS</m> to show it equals the result found in the previous example.
        </p>

        <figure xml:id="fig_stokes2">
          <caption>As given in <xref ref="ex_stokes2"/>, the surface <m>\surfaceS</m><nbsp/>is the portion of the plane bounded by the curve</caption>
          <sidebyside widths="47% 47%" margins="0%">
            <figure xml:id="fig_stokes2a_3D">
              <caption/>
              <image>
                <shortdescription>The portion of a circular paraboloid in the first octant, and an elliptical curve that lies on the surface.</shortdescription>
                <description>
                  <p>
                    This image has elements in common with <xref ref="fig_stokes1"/>.
                    We have the same three-dimensional coordinate axes,
                    and the same circle in the <m>xy</m> plane, centered at <m>(1,1,0)</m>, of radius <m>1</m>.
                  </p>

                  <p>
                    The portion of the circular paraboloid <m>z=6-x^2-y^2</m> that lies in the first octant is plotted.
                    It has its vertex at <m>(0,0,6)</m>, and opens downward.
                    On the surface is an ellipse.
                    Although the surface is curved, the ellipse is the same ellipse that was drawn in <xref ref="fig_stokes1"/>.
                    The surface <m>\surfaceS</m> is the portion of the paraboloid on and inside the ellipse.
                  </p>
                </description>
                <asymptote label="img_stokes2a_3D">



                  //ASY file for figstokes2_3D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(11,19,27);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={1,2};
                  real[] myychoice={1,2};
                  real[] myzchoice={2,4,6,8};
                  defaultpen(0.5mm);

                  pair xbounds=(-.1,2.5);
                  pair ybounds=(-.1,2.5);
                  pair zbounds=(-.1,9);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw the plane  z=6-x^2-y^2
                  triple f(pair t) {
                    return (t.x,t.y,6-t.x^2-t.y^2);//
                  }
                  surface s=surface(f,(-.1,-.1),(2.2,2.2),16,16,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  triple g(real t) {return (cos(t)+1,sin(t)+1,6-(cos(t)+1)^2-(sin(t)+1)^2);}
                  path3 mypath=graph(g,0,2pi,operator ..);
                  draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (cos(t)+1,sin(t)+1,0);}
                  path3 mypath=graph(g,0,2pi,operator ..);
                  draw(mypath,bluepen+dashed+linewidth(1));

                  label("$\mathcal{S}$",(1,1,5));
                  //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);

                </asymptote>
              </image>
            </figure>

            <figure xml:id="fig_stokes2b_3D">
              <caption/>
              <image>
                <shortdescription>The parabolic surface from the previous image is shown intersecting a plane along a common elliptical curve.</shortdescription>
                <description>
                  <p>
                    This image shows both the circular paraboloid from <xref ref="fig_stokes2a_3D"/>
                    and the plane from <xref ref="fig_stokes1"/>.
                  </p>

                  <p>
                    The two surfaces are shown intersecting along the same ellipse.
                    This illustrates how the curve <m>C</m> is the boundary of both surfaces.
                  </p>
                </description>
                <asymptote label="img_stokes2b_3D">



                  //ASY file for figstokes2_3D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(11,19,27);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={1,2};
                  real[] myychoice={1,2};
                  real[] myzchoice={2,4,6,8};
                  defaultpen(0.5mm);

                  pair xbounds=(-.1,2.5);
                  pair ybounds=(-.1,2.5);
                  pair zbounds=(-.1,9);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw the plane  z=7-2x-2y
                  triple f(pair t) {
                    return (t.x,t.y,-2t.x-2t.y+7);//
                  }
                  surface s=surface(f,(-.1,-.1),(2.2,2.2),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=redmeshpen;
                  draw(s,surfacepen2,meshpen=p);

                  //Draw the plane  z=6-x^2-y^2
                  triple f(pair t) {
                    return (t.x,t.y,6-t.x^2-t.y^2);//
                  }
                  surface s=surface(f,(-.1,-.1),(2.2,2.2),16,16,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  triple g(real t) {return (cos(t)+1,sin(t)+1,6-(cos(t)+1)^2-(sin(t)+1)^2);}
                  path3 mypath=graph(g,0,2pi,operator ..);
                  draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (cos(t)+1,sin(t)+1,0);}
                  path3 mypath=graph(g,0,2pi,operator ..);
                  draw(mypath,bluepen+dashed+linewidth(1));

                  //label("$\mathcal{S}$",(1,1,5));
                  //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);

                </asymptote>
              </image>
            </figure>
          </sidebyside>

        </figure>
      </statement>
      <solution>
        <p>
          We begin by demonstrating that <m>C</m> lies on the surface <m>z=6-x^2-y^2</m>.
          We can parametrize the <m>x</m> and <m>y</m> components of <m>C</m> with <m>x=\cos(t)+1</m>,
          <m>y=\sin(t)+1</m> as before.
          Lifting these components to the surface <m>z=6-x^2-y^2</m> gives the <m>z</m> component as <m>z = 6-x^2-y^2 = 6-(\cos(t)+1)^2-(\sin(t)+1)^2 = 3-2\cos(t)-2\sin(t)</m>,
          which is the same <m>z</m> component as found in <xref ref="ex_stokes1"/>.
          Thus the curve <m>C</m> lies on the surface <m>z=6-x^2-y^2</m>,
          as illustrated in <xref ref="fig_stokes2"/>.
        </p>

        <p>
          Since <m>C</m> and <m>\vec F</m> are the same as in the previous example,
          we already know that <m>\oint_C\vec F\cdot\, d\vec r = 3\pi</m>.
          We confirm that this is also the value of <m>\iint_\surfaceS (\curl\vec F)\cdot \vec n\, dS</m>.
        </p>

        <p>
          We parametrize <m>\surfaceS</m> with
          <me>
            \vec r(u,v) = \langle v\cos(u)+1,v\sin(u)+1, 6-(v\cos(u)+1)^2-(v\sin(u)+1)^2\rangle
          </me>,
          where <m>0\leq u\leq 2\pi</m> and <m>0\leq v\leq 1</m>,
          and leave it to the reader to confirm that
          <me>
            \vec r_u\times \vec r_v = \la 2v\big(v\cos(u)+1\big), 2v\big(v\sin(u)+1\big),v\ra
          </me>,
          which also conforms to the right-hand rule with regard to the orientation of <m>C</m>.
          With <m>\curl \vec F = \langle 2y,0,-1\rangle</m> as before, we have
          <md>
            <mrow>\amp\iint_\surfaceS (\curl\vec F)\cdot \vec n\, dS</mrow>
            <mrow>\quad\quad\amp = \int_0^1\int_0^{2\pi} \la 2v\sin(u)+2,0,-1\ra\cdot \la 2v\big(v\cos(u)+1\big), 2v\big(v\sin(u)+1\big),v\ra\, du\, dv </mrow>
            <mrow>\quad\quad\amp =3\pi</mrow>
          </md>.
        </p>

        <p>
          Even though the surfaces used in this example and in <xref ref="ex_stokes1"/> are very different,
          because they share the same boundary, Stokes' Theorem guarantees they have equal <q>sum of curls</q>
          across their respective surfaces.
        </p>
      </solution>
    </example>

    <figure xml:id="vid-veccalc-stokesdiv-stokes-eg2" component="video" vshift="0">
      <caption>Another example with Stokes' Theorem</caption>
      <video youtube="sIqNIkmYPiE" label="vid-veccalc-stokesdiv-stokes-eg2"/>
    </figure>
  </subsection>

  <subsection>
    <title>A Common Thread of Calculus</title>
    <p>
      We have threefold interest in each of the major theorems of this chapter:
      the Fundamental Theorem of Line Integrals, Green's, Stokes' and the Divergence Theorems.
      First, we find the beauty of their truth interesting.
      Second, each provides two methods of computing a desired quantity,
      sometimes offering a simpler method of computation.
    </p>

    <p>
      There is yet one more reason of interest in the major theorems of this chapter.
      These important theorems also all share an important principle with the Fundamental Theorem of Calculus,
      introduced in <xref ref="chapter_integration"/>.
    </p>

    <p>
      Revisit this fundamental theorem,
      adopting the notation used heavily in this chapter.
      Let <m>I</m> be the interval <m>[a,b]</m> and let <m>y=F(x)</m> be differentiable on <m>I</m>,
      with <m>F\,'(x) = f(x)</m>.
      The Fundamental Theorem of Calculus states that
      <me>
        \int_I f(x)\, dx = F(b) - F(a)
      </me>.
    </p>

    <p>
      That is, the sum of the rates of change of a function <m>F</m> over an interval <m>I</m> can also be calculated with a certain sum of <m>F</m> itself on the boundary of <m>I</m>
      (in this case, at the points <m>x=a</m> and <m>x=b</m>).
    </p>

    <p>
      Each of the named theorems above can be expressed in similar terms.
      Consider the Fundamental Theorem of Line Integrals:
      given a function <m>f(x,y)</m>,
      the gradient <m>\nabla f</m> is a type of rate of change of <m>f</m>.
      Given a curve <m>C</m> with initial and terminal points <m>A</m> and <m>B</m>,
      respectively,
      this fundamental theorem states that
      <me>
        \int_C \nabla f\, ds = f(B) - f(A)
      </me>,
      where again the sum of a rate of change of <m>f</m> along a curve <m>C</m> can also be evaluated by a certain sum of <m>f</m> at the boundary of <m>C</m> (<ie/>, the points <m>A</m> and <m>B</m>).
    </p>

    <p>
      Green's Theorem is essentially a special case of Stokes' Theorem,
      so we consider just Stokes' Theorem here.
      Recalling that the curl of a vector field <m>\vec F</m> is a measure of a rate of change of <m>\vec F</m>, Stokes' Theorem states that over a surface <m>\surfaceS</m> bounded by a closed curve <m>C</m>,
      <me>
        \iint_\surfaceS \big(\curl \vec F\big)\cdot \vec n\, dS = \oint_C \vec F\cdot d\vec r
      </me>,
      <ie/>, the sum of a rate of change of <m>\vec F</m> can be calculated with a certain sum of <m>\vec F</m> itself over the boundary of <m>\surfaceS</m>. In this case,
      the latter sum is also an infinite sum, requiring an integral.
    </p>

    <p>
      Finally, the Divergence Theorems state that the sum of divergences of a vector field
      (another measure of a rate of change of <m>\vec F</m>)
      over a region can also be computed with a certain sum of <m>\vec F</m> over the boundary of that region.
      When the region is planar, the latter sum of <m>\vec F</m> is an integral;
      when the region is spatial,
      the latter sum of <m>\vec F</m> is a double integral.
    </p>

    <p>
      The common thread among these theorems:
      the sum of a rate of change of a function over a region can be computed as another sum of the function itself on the boundary of the region.
      While very general, this is a very powerful and important statement.
    </p>
  </subsection>

  <exercises>
    <subexercises xml:id="TaC-stokes-divergence">
      <title>Terms and Concepts</title>
      <exercise label="TaC-stokes-divergence-1">
        <statement>
          <p>
            What are the differences between the Divergence Theorems of <xref ref="sec_greensthm"/> and this section?
          </p>
        </statement>
        <response />
        
        <answer>
          <p>
            Answers will vary; in <xref ref="sec_greensthm"/>,
            the Divergence Theorem connects outward flux over a closed curve in the plane to the divergence of the vector field,
            whereas in this section the Divergence Theorem connects outward flux over a closed surface in space to the divergence of the vector field.
          </p>
        </answer>
      </exercise>

      <exercise label="TaC-stokes-divergence-2">
        <statement>
          <p>
            What property of a vector field does the Divergence Theorem relate to flux?
          </p>
        </statement>
        <response />
        
        <answer>
          <p>
            Divergence.
          </p>
        </answer>
      </exercise>

      <exercise label="TaC-stokes-divergence-3">
        <statement>
          <p>
            What property of a vector field does Stokes' Theorem relate to circulation?
          </p>
        </statement>
        <response />
        
        <answer>
          <p>
            Curl.
          </p>
        </answer>
      </exercise>

      <exercise label="TaC-stokes-divergence-4">
        <statement>
          <p>
            Stokes' Theorem is the spatial version of what other theorem?
          </p>
        </statement>
        <response />
        
        <answer>
          <p>
            Green's Theorem.
          </p>
        </answer>
      </exercise>
    </subexercises>
    
    <subexercises>
      <title>Problems</title>

      <exercisegroup cols="2" xml:id="exset-divergence-theorem-verify">
        <introduction>
          <p>
            In the following exercises,
            a closed surface <m>\surfaceS</m> enclosing a domain <m>D</m> and a vector field <m>\vec F</m> are given.
            Verify the Divergence Theorem on <m>\surfaceS</m>; that is,
            show <m>\iint_\surfaceS \vec F\cdot \vec n\, dS = \iiint_D\divv \vec F\, dV</m>.
          </p>
        </introduction>

        <exercise label="ex-divergence-theorem-verify-1">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface bounding the domain <m>D</m> enclosed by the plane
              <m>z=2-x/2-2y/3</m> and the coordinate planes in the first octant;
              <m>\vec F = \langle x^2,y^2,x\rangle</m>.
            </p>

              <image>
                <shortdescription>A tetrahedron with vertices (0,0,0), (4,0,0), (0,3,0), and (0,0,2).</shortdescription>
                <description>
                  <p>
                    A surface consisting of the four faces of a tetrahedron is plotted relative to three-dimensional coordinate axes.
                    Each face is a triangle; there is one in each coordinate plane,
                    and the fourth face lies in the plane <m>z=2-x/2-2y/3</m>.
                  </p>

                  <p>
                    The plane <m>z=2-x/2-2y/3</m> is plotted in the first octant.
                    It meets the coordinate axes at the points <m>(4,0,0)</m>, <m>(0,3,0)</m>, and <m>(0,0,2)</m>.
                    These are three of the four vertices of the tetrahedron; the remaining vertex is at the origin.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_05_3D">



                  //ASY file for fig14_07_ex_05_3D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={4};
                  real[] myychoice={3};
                  real[] myzchoice={2};
                  defaultpen(0.5mm);

                  pair xbounds=(-.5,4.5);
                  pair ybounds=(-.5,4.5);
                  pair zbounds=(-0.25,3);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  //triple g(real t) {return (2cos(t),2sin(t),0);}
                  //path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  //path3 mypath=graph(g,-2,2,operator ..);
                  draw((4,0,0)--(0,3,0)--(0,0,2)--cycle,bluepen+linewidth(2));
                  draw((4,0,0)--(0,0,0),bluepen+linewidth(2));
                  draw((0,3,0)--(0,0,0),bluepen+linewidth(2));
                  draw((0,0,2)--(0,0,0),bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y*(3-3t.x/4),2-t.x/2-2t.y*(3-3t.x/4)/3);//
                  }
                  surface s=surface(f,(0,0),(4,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y*(3-3t.x/4),0);//
                  }
                  surface s=surface(f,(0,0),(4,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,0,t.y*(2-t.x/2));//
                  }
                  surface s=surface(f,(0,0),(4,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (0,t.x,t.y*(2-2t.x/3));//
                  }
                  surface s=surface(f,(0,0),(3,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Outward flux across the plane <m>z=2-x/2-2y/3</m> is 14;
              across the plane <m>z=0</m> the outward flux is <m>-8</m>;
              across the planes <m>x=0</m> and <m>y=0</m> the outward flux is 0.
            </p>

            <p>
              Total outward flux: <m>14</m>.
            </p>

            <p>
              <m>\iint_D\divv\vec F\, dV = \int_0^{4}\int_0^{3-3x/4}\int_0^{2-x/2-2y/3}(2x+2y)\, dz\, dy\, dx = 14</m>.
            </p>
          </answer>
        </exercise>

        <exercise label="ex-divergence-theorem-verify-2">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface bounding the domain <m>D</m> enclosed by the cylinder
              <m>x^2+y^2=1</m> and the planes <m>z=-3</m> and <m>z=3</m>;
              <m>\vec F = \langle -x,y,z\rangle</m>.
            </p>

              <image>
                <shortdescription>A circular cylinder, centered on the z axis, capped by disks in the planes z=3 and z=-3.</shortdescription>
                <description>
                  <p>
                    The surface consists of three parts:
                    <ol>
                      <li>
                        <p>
                          The circular cylinder <m>x^2+y^2=1</m>, which is symmetric about the <m>z</m> axis,
                          from <m>z=-3</m> to <m>z=3</m>.
                        </p>
                      </li>
                      <li>
                        <p>
                          The disk bounded by <m>x^2+y^2=1</m> in the plane <m>z=3</m>;
                          this is the top cap of the cylinder.
                        </p>
                      </li>
                      <li>
                        <p>
                          The disk bounded by <m>x^2+y^2=1</m> in the plane <m>z=-3</m>;
                          this is the bottom cap of the cylinder.
                        </p>
                      </li>
                    </ol>
                  </p>
                </description>
                <asymptote label="img_14_07_ex_06_3D">



                  //ASY file for fig14_07_ex_06_3D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={-1,1};
                  real[] myzchoice={-3,3};
                  defaultpen(0.5mm);

                  pair xbounds=(-3.5,3.5);
                  pair ybounds=(-3.5,3.5);
                  pair zbounds=(-3.5,3.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  triple g(real t) {return (cos(t),sin(t),3);}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  triple g(real t) {return (cos(t),sin(t),-3);}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (cos(t.x),sin(t.x),t.y);//
                  }
                  surface s=surface(f,(0,-3),(2pi,3),16,2,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.y*cos(t.x),t.y*sin(t.x),3);//
                  }
                  surface s=surface(f,(0,0),(2pi,1),8,2,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.y*cos(t.x),t.y*sin(t.x),-3);//
                  }
                  surface s=surface(f,(0,0),(2pi,1),8,2,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Outward flux across the cylinder <m>x^2+y^2=1</m> is 0;
              across the plane <m>z=3</m> the outward flux is <m>3\pi</m>;
              across the plane <m>z=-3</m> the outward flux is <m>3\pi</m>.
            </p>

            <p>
              Total outward flux: <m>6\pi</m>.
            </p>

            <p>
              <m>\iint_D\divv\vec F\, dV = \int_0^{2\pi}\int_0^{1}\int_{-3}^{3}r\, dz\, dr\, d\theta = 6\pi</m>.
            </p>
          </answer>
        </exercise>

        <exercise label="ex-divergence-theorem-verify-3">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface bounding the domain <m>D</m> enclosed by
              <m>z=xy(3-x)(3-y)</m> and the plane <m>z=0</m>;
              <m>\vec F = \langle 3x,4y,5z+1\rangle</m>.
            </p>

              <image>
                <shortdescription>A steep hill with a square base in the <m>xy</m> plane.</shortdescription>
                <description>
                  <p>
                    The graph <m>z=xy(3-x)(3-y)</m> is plotted relative to three-dimensional coordinate axes.
                    This surface meets the <m>xy</m> plane along a <em>square</em>,
                    with sides given by the <m>x</m> and <m>y</m> axes, 
                    and the lines <m>x=3</m> and <m>y=3</m> in the <m>xy</m> plane.
                  </p>

                  <p>
                    This square in the plane is part of the surface,
                    and the other part is the graph.
                    The graph is shaped like a steep hill, with a single peak in the center of the square.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_07_3D">



                  //ASY file for fig14_07_ex_07_3D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={3};
                  real[] myychoice={3};
                  real[] myzchoice={4};
                  defaultpen(0.5mm);

                  pair xbounds=(-.5,3.5);
                  pair ybounds=(-.5,3.5);
                  pair zbounds=(-.5,4.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  //triple g(real t) {return (cos(t),sin(t),3);}
                  //path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (cos(t),sin(t),-3);}
                  //path3 mypath=graph(g,0,2pi,operator ..);
                  draw((0,0,0) -- (3,0,0) -- (3,3,0) -- (0,3,0)--cycle,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y,t.x*t.y*(3-t.x)*(3-t.y));//
                  }
                  surface s=surface(f,(0,0),(3,3),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y,0);//
                  }
                  surface s=surface(f,(0,0),(3,3),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Outward flux across the surface <m>z=xy(3-x)(3-y)</m> is 252;
              across the plane <m>z=0</m> the outward flux is <m>-9</m>.
            </p>

            <p>
              Total outward flux: <m>243</m>.
            </p>

            <p>
              <m>\iint_D\divv\vec F\, dV = \int_0^{3}\int_0^{3}\int_{0}^{xy(3-x)(3-y)}12\, dz\, dy\, dx = 243</m>.
            </p>
          </answer>
        </exercise>

        <exercise label="ex-divergence-theorem-verify-4">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface composed of <m>\surfaceS_1</m>,
              the paraboloid <m>z=4-x^2-y^2</m> for <m>z\geq 0</m>,
              and <m>\surfaceS_2</m>, the disk of radius 2 centered at the origin;
              <m>\vec F = \langle x,y,z^2\rangle</m>.
            </p>

              <image>
                <shortdescription>A familiar dome-shaped surface between a circular paraboloid and the x,y plane.</shortdescription>
                <description>
                  <p>
                    The surface consists of the circular paraboloid <m>z=4-x^2-y^2</m>,
                    which opens downward from <m>(0,0,4)</m> and meets the <m>xy</m> plane along the circle <m>x^2+y^2=4</m>,
                    as well as the disk in the <m>xy</m> plane that lies on and inside the circle of intersection
                    between the plane and the paraboloid.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_08_3D">



                  //ASY file for fig14_07_ex_08_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-2,2};
                  real[] myychoice={-2,2};
                  real[] myzchoice={4};
                  defaultpen(0.5mm);

                  pair xbounds=(-2.5,2.5);
                  pair ybounds=(-2.5,2.5);
                  pair zbounds=(-0.25,5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  triple g(real t) {return (2cos(t),2sin(t),0);}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (2*t.y*cos(t.x),t.y*2*sin(t.x),4-4*t.y^2);//
                  }
                  surface s=surface(f,(0,0),(2pi,1),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (2*t.y*cos(t.x),2*t.y*sin(t.x),0);//
                  }
                  surface s=surface(f,(0,0),(2pi,1),8,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Outward flux across the paraboloid is <m>112\pi/3</m>;
              across the disk the outward flux is 0.
            </p>

            <p>
              Total outward flux: <m>112\pi/3</m>.
            </p>

            <p>
              <m>\iint_D\divv\vec F\, dV = \int_0^{2\pi}\int_0^2\int_0^{4-r^2}(2z+2)r\, dz\, dr\, d\theta = 112\pi/3</m>.
            </p>
          </answer>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-stokes-theorem-verify">
        <introduction>
          <p>
            In the following exercises,
            a closed curve <m>C</m> that is the boundary of a surface <m>\surfaceS</m> is given along with a vector field <m>\vec F</m>.
            Verify Stokes' Theorem on <m>C</m>;
            that is, show <m>\oint_C \vec F\cdot d\vec r = \iint_\surfaceS\big(\curl \vec F\,\big)\cdot\vec n\, dS</m>.
          </p>
        </introduction>

        <exercise label="ex-stokes-theorem-verify-1">
          <statement>
            <p>
              <m>C</m> is the curve parametrized by
              <m>\vec r(t) = \langle \cos(t), \sin(t), 1\rangle</m> and <m>\surfaceS</m> is the portion of
              <m>z=x^2+y^2</m> enclosed by <m>C</m>;
              <m>\vec F = \langle z,-x,y\rangle</m>.
            </p>

              <image>
                <shortdescription>A bowl-shaped surface given by a circular paraboloid plotted over the unit disk.</shortdescription>
                <description>
                  <p>
                    The surface <m>z=x^2+y^2</m> is plotted relative to a set of three-dimensional coordinate axes.
                    The domain used for the graph is the unit disk, so that the surface is shaped like a bowl.
                    The boundary of the surface is a circle in the plane <m>z=1</m>.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_09_3D">



                  //ASY file for fig14_07_ex_09_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={-1,1};
                  real[] myzchoice={1};
                  defaultpen(0.5mm);

                  pair xbounds=(-1.5,1.5);
                  pair ybounds=(-1.5,1.5);
                  pair zbounds=(-0.25,2);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  triple g(real t) {return (cos(t),sin(t),1);}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.y*cos(t.x),t.y*sin(t.x),t.y^2);//
                  }
                  surface s=surface(f,(0,0),(2pi,1),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Circulation on <m>C</m>: <m>\oint_C \vec F\cdot d\vec r = -\pi</m>
            </p>

            <p>
              <m>\iint_\surfaceS\big(\curl \vec F\big)\cdot\vec n\, dS = -\pi</m>.
            </p>
          </answer>
        </exercise>

        <exercise label="ex-stokes-theorem-verify-2">
          <statement>
            <p>
              <m>C</m> is the curve parametrized by
              <m>\vec r(t) = \langle \cos(t), \sin(t), e^{-1}\rangle</m> and <m>\surfaceS</m> is the portion of
              <m>z=e^{-x^2-y^2}</m> enclosed by <m>C</m>;
              <m>\vec F = \langle -y,x,1\rangle</m>.
            </p>

              <image>
                <shortdescription>A bell-shaped surface in space, with a circular boundary.</shortdescription>
                <description>
                  <p>
                    The graph <m>z=e^{-x^2-y^2}</m> is plotted relative to a set of three-dimensional coordinate axes,
                    for <m>0\leq x^2+y^2\leq 1</m>.
                    The surface is shaped like a bell or a dome, opening downward from a vertext at <m>(0,0,1)</m>.
                  </p>

                  <p>
                    The boundary of the surface is a circle;
                    the circle lies in the horizontal plane <m>z=e^{-1}</m>, 
                    has radius <m>1</m>, and is centered on the <m>z</m> axis.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_10_3D">



                  //ASY file for fig14_07_ex_10_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={-1,1};
                  real[] myzchoice={1};
                  defaultpen(0.5mm);

                  pair xbounds=(-1.5,1.5);
                  pair ybounds=(-1.5,1.5);
                  pair zbounds=(-0.25,1.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  triple g(real t) {return (cos(t),sin(t),exp(-1));}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.y*cos(t.x),t.y*sin(t.x),exp(-t.y^2));//
                  }
                  surface s=surface(f,(0,0),(2pi,1),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Circulation on <m>C</m>: <m>\oint_C \vec F\cdot d\vec r = \pi</m>
            </p>

            <p>
              <m>\iint_\surfaceS\big(\curl \vec F\big)\cdot\vec n\, dS = \pi</m>.
            </p>
          </answer>
        </exercise>

        <exercise label="ex-stokes-theorem-verify-3">
          <statement>
            <p>
              <m>C</m> is the curve that follows the triangle with vertices at <m>(0,0,2)</m>,
              <m>(4,0,0)</m> and <m>(0,3,0)</m>,
              traversing the the vertices in that order and returning to <m>(0,0,2)</m>,
              and <m>\surfaceS</m> is the portion of the plane
              <m>z=2-x/2-2y/3</m> enclosed by <m>C</m>;
              <m>\vec F = \langle y,-z,y\rangle</m>.
            </p>

              <image>
                <shortdescription>A triangular surface in the first octant, with intercepts at (4,0,0), (0,3,0), and (0,0,2).</shortdescription>
                <description>
                  <p>
                    The curve <m>C</m> is plotted in space relative to three-dimensional coordinate axes.
                    It is a triangle, given by the path from <m>(0,0,2)</m> on the <m>z</m> axis,
                    to <m>(4,0,0)</m> on the <m>x</m> axis, to <m>(0,3,0)</m> on the <m>y</m> axis, and then back to <m>(0,0,2)</m>.
                  </p>

                  <p>
                    The surface <m>\surfaceS</m> is the portion of the plane in the first octant that lies on and inside this triangle.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_11_3D">



                  //ASY file for fig14_07_ex_10_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={4};
                  real[] myychoice={3};
                  real[] myzchoice={2};
                  defaultpen(0.5mm);

                  pair xbounds=(-.5,4.5);
                  pair ybounds=(-.5,4.5);
                  pair zbounds=(-0.25,2.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  //triple g(real t) {return (cos(t),sin(t),exp(-1));}
                  //path3 mypath=graph(g,0,2pi,operator ..);
                  draw((0,0,2)--(4,0,0)--(0,3,0)--cycle,bluepen+linewidth(2));
                  //triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y*(3-3t.x/4),2-t.x/2-2*(t.y*(3-3t.x/4))/3);//
                  }
                  surface s=surface(f,(0,0),(4,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Circulation on <m>C</m>: The flow along the line from <m>(0,0,2)</m> to <m>(4,0,0)</m> is 0;
              from <m>(4,0,0)</m> to <m>(0,3,0)</m> it is <m>-6</m>,
              and from <m>(0,3,0)</m> to <m>(0,0,2)</m> it is 6.
              The total circulation is <m>0+(-6)+6=0</m>.
            </p>

            <p>
              <m>\iint_\surfaceS\big(\curl \vec F\big)\cdot\vec n\, dS = \iint_\surfaceS 0 \, dS = 0</m>.
            </p>
          </answer>
        </exercise>

        <exercise label="ex-stokes-theorem-verify-4">
          <statement>
            <p>
              <m>C</m> is the curve whose <m>x</m> and <m>y</m> coordinates follow the parabola <m>y=1-x^2</m> from <m>x=1</m> to <m>x=-1</m>,
              then follow the line from <m>(-1,0)</m> back to <m>(1,0)</m>,
              where the <m>z</m> coordinates of <m>C</m> are determined by <m>f(x,y) = 2x^2+y^2</m>,
              and <m>\surfaceS</m> is the portion of
              <m>z=2x^2+y^2</m> enclosed by <m>C</m>;
              <m>\vec F = \langle y^2+z,x,x^2-y\rangle</m>.
            </p>

              <image>
                <shortdescription>Graph of an elliptic paraboloid over a parabolic domain.</shortdescription>
                <description>
                  <p>
                    The usual three-dimensional coordinate axes are drawn.
                    The surface is the graph <m>z=2x^2+y^2</m>, which is an elliptic paraboloid.
                  </p>

                  <p>
                    The domain for the graph is not illustrated,
                    but it is the region between the <m>x</m> axis and the parabola <m>y=1-x^2</m>.
                  </p>

                  <p>
                    The surface is shaped like a hammock or a sail.
                    Its boundary consists of two parabolic curves that meet at two cusps.
                    The cusps are the highest points on the surface;
                    they lie in the <m>xz</m> plane at <m>(1,0,2)</m> and <m>(-1,0,2)</m>.
                  </p>

                  <p>
                    One part of the boundary is a parabola in the <m>xz</m> plane,
                    given by <m>z=2x^2</m> for <m>-1\leq x\leq 1</m>.
                    The other part is the portion of the elliptic paraboloid <m>z=2x^2+y^2</m>
                    that lies above the curve <m>y=1-x^2</m> in the <m>xy</m> plane.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_12_3D">



                  //ASY file for fig14_07_ex_10_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={1};
                  real[] myzchoice={2};
                  defaultpen(0.5mm);

                  pair xbounds=(-1.5,1.5);
                  pair ybounds=(-1.5,1.5);
                  pair zbounds=(-0.25,2.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  triple g(real t) {return (t,1-t^2,2t^2+(1-t^2)^2);}
                  path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (t,0,2t^2);}
                  path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y*(1-t.x^2),2t.x^2+(t.y*(1-t.x^2))^2);//
                  }
                  surface s=surface(f,(-1,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              Circulation on <m>C</m>: The flow along the parabola is <m>-32/15</m>;
              the flow along the line is <m>4/3</m>.
              The total circulation is <m>4/3-32/15 = -4/5</m>.
            </p>

            <p>
              <m>\iint_\surfaceS\big(\curl \vec F\big)\cdot\vec n\, dS = -4/5</m>.
            </p>
          </answer>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-divergence-theorem-flux">
        <introduction>
          <p>
            In the following exercises,
            a closed surface <m>\surfaceS</m> and a vector field <m>\vec F</m> are given.
            Find the outward flux of <m>\vec F</m> over <m>\surfaceS</m> either through direct computation or through the Divergence Theorem.
          </p>
        </introduction>

        <exercise label="ex-divergence-theorem-flux-1">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface formed by the intersections of <m>z=0</m> and <m>z=(x^2-1)(y^2-1)</m>;
              <m>\vec F = \langle x^2+1,yz,xz^2\rangle</m>.
            </p>

              <image>
                <shortdescription>A domed hill with a square base in the <m>xy</m> plane.</shortdescription>
                <description>
                  <p>
                    The graph <m>z=(x^2-1)(y^2-1)</m> is plotted relative to three-dimensional coordinate axes.
                    This surface meets the <m>xy</m> plane along a <em>square</em>,
                    with sides given by the lines <m>x=\pm 1</m> and <m>y=\pm 1</m> in the <m>xy</m> plane.
                  </p>

                  <p>
                    The graph is shaped like a hill, with its peak on the <m>z</m> axis at <m>(0,0,1)</m>.
                    The boundary of the graph is the square in the <m>xy</m> plane.
                  </p>

                  <p>
                    The surface consists of this graph and the region in the <m>xy</m>
                    plane bounded by the square <m>-1\leq x,y\leq 1</m>.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_13_3D">



                  //ASY file for fig14_07_ex_13_3D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12,12,5);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={-1,1};
                  real[] myzchoice={-1,1};
                  defaultpen(0.5mm);

                  pair xbounds=(-1.25,1.25);
                  pair ybounds=(-1.25,1.25);
                  pair zbounds=(-0.25,1.25);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  //triple g(real t) {return (cos(t),sin(t),3);}
                  //path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));
                  //triple g(real t) {return (cos(t),sin(t),-3);}
                  //path3 mypath=graph(g,0,2pi,operator ..);
                  draw((-1,-1,0) -- (-1,1,0) -- (1,1,0) -- (1,-1,0)--cycle,bluepen+linewidth(2));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y,(t.x^2-1)*(t.y^2-1));//
                  }
                  surface s=surface(f,(-1,-1),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y,0);//
                  }
                  surface s=surface(f,(-1,-1),(1,1),1,1,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  //label("$z=2y$",(-2,2,7));
                  //draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  //label("$y=4-x^2$",(2.5,2,0));
                  //draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>128/225</m>
            </p>
          </answer>
        </exercise>

        <exercise label="ex-divergence-theorem-flux-2">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface formed by the intersections of the planes <m>z=\frac12(3-x)</m>,
              <m>x=1</m>,
              <m>y=0</m>, <m>y=2</m> and <m>z=0</m>;
              <m>\vec F = \langle x,y^2,z\rangle</m>.
            </p>

              <image>
                <shortdescription>A triangular prism, with two triangular faces and three rectangular faces.</shortdescription>
                <description>
                  <p>
                    The surface <m>\surfaceS</m> consists of all five faces of a triangular prism.
                    The prism is plotted relative to a set of three-dimensional coordinate axes.
                  </p>

                  <p>
                    Two of the faces are triangles. These lie in the planes <m>y=0</m> and <m>y=2</m>.
                    The vertices of the triangles are at <m>(1,0,0)</m>, <m>(3,0,0)</m>, and <m>(1,0,1)</m> for the face in the <m>xz</m> plane,
                    and at <m>(1,2,0)</m>, <m>(3,2,0)</m>, and <m>(1,2,1)</m> for the face in the plane <m>y=2</m>.
                  </p>

                  <p>
                    One face is in the <m>xy</m> plane;
                    it is a square given by <m>1\leq x\leq 3</m> and <m>0\leq y\leq 2</m>.
                  </p>

                  <p>
                    Another face is in the plane <m>x=1</m>;
                    it is a rectangle with <m>0\leq y\leq 2</m> and <m>0\leq z\leq 1</m>.
                  </p>

                  <p>
                    The final face is in the plane <m>z=\frac12(3-x)</m>.
                    This face lies on the hypotenuse of each triangular face.
                    It is a rectangle, with vertices <m>(3,0,0)</m>, <m>(3,2,0)</m>, <m>(1,2,1)</m>, and <m>(1,0,1)</m>.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_14_3D">



                  //ASY file for fig13_06_ex_083D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(8.8,7.8,3);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={1,2,3};
                  real[] myychoice={1,2,3};
                  real[] myzchoice={1};
                  defaultpen(0.5mm);

                  pair xbounds=(-0.5,3.5);
                  pair ybounds=(-0.5,3.5);
                  pair zbounds=(-0.5,1.75);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //edges of object
                  draw((1,0,0)--(1,2,0)--(3,2,0)--(3,0,0)--cycle,bluepen+linewidth(2));
                  draw((3,0,0)--(1,0,1)--(1,2,1)--(3,2,0),bluepen+linewidth(2));
                  draw((3,0,0)--(1,0,1),bluepen+linewidth(2));
                  draw((1,0,0)--(1,0,1),bluepen+linewidth(2));
                  draw((1,2,0)--(1,2,1),bluepen+linewidth(2));

                  //shade faces
                  import three;
                  path3 p=(1,0,0)--(1,2,0)--(3,2,0)--(3,0,0);
                  draw(surface(p -- cycle), surfacepen);
                  path3 p=(1,0,1)--(1,2,1)--(3,2,0)--(3,0,0);
                  draw(surface(p -- cycle), surfacepen);
                  path3 p=(1,0,0)--(1,2,0)--(1,2,1)--(1,0,1);
                  draw(surface(p -- cycle), surfacepen);
                  path3 p=(1,0,0)--(3,0,0)--(1,0,1);
                  draw(surface(p -- cycle), surfacepen);
                  path3 p=(1,2,0)--(3,2,0)--(1,2,1);
                  draw(surface(p -- cycle), surfacepen);

                  //labels and arrow
                  label("$z=\frac{1}{2}(3-x)$",(3,0,1.1));
                  draw((3,0.25,1)--(2,1,0.45),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>8</m>
            </p>
          </answer>
        </exercise>

        <exercise label="ex-divergence-theorem-flux-3">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface formed by the intersections of the planes <m>z=2y</m>,
              <m>y=4-x^2</m> and <m>z=0</m>;
              <m>\vec F = \langle xz,0,xz\rangle</m>.
            </p>

              <image>
                <shortdescription>A wedge-shaped surface given by two intersecting planes and a parabolic cylinder.</shortdescription>
                <description>
                  <p>
                    This is another wedge-shaped surface, similar to one in <xref ref="fig_divthm_space2"/>.
                  </p>

                  <p>
                    There are three components to the surface.
                    <ul>
                      <li>
                        <p>
                          The first is the region in the <m>xy</m> plane bounded by the <m>x</m> axis and the parabola <m>y=4-x^2</m>.
                          It meets the <m>x</m> axis along the interval <m>-2\leq x\leq 2</m>.
                        </p>
                      </li>
                      <li>
                        <p>
                          The second part lies in the plane <m>z=2y</m>.
                          This is a planar surface, bounded below by the segment <m>-2\leq x\leq 2</m> along the <m>x</m> axis,
                          and above by a parabola that lies in the plane <m>z=2y</m>.
                        </p>

                        <p>
                          This part of the surface lies directly above the part in the <m>xy</m> plane,
                          and meets it along the <m>x</m> axis.
                        </p>
                      </li>
                      <li>
                        <p>
                          The last part is the portion of the parabolic cylinder <m>y=4-x^2</m>
                          that lies between the planes <m>z=0</m> and <m>z=2y</m>.
                        </p>
                      </li>
                    </ul>
                  </p>
                </description>
                <asymptote label="img_14_07_ex_15_3D">



                  //ASY file for fig13_06_ex_123D.asy in Chapter 13

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(12.1,-7.1,16);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-2,-1,1,2};
                  real[] myychoice={1,2,3,4};
                  real[] myzchoice={2,4,6,8};
                  defaultpen(0.5mm);

                  pair xbounds=(-2.5,2.5);
                  pair ybounds=(-0.25,5);
                  pair zbounds=(-0.25,10);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //parabola in plane
                  triple g(real t) {return (t,4-t^2,0);}
                  path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));
                  triple g(real t) {return (t,4-t^2,2*(4-t^2));}
                  path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                  //shade object
                  //import three;
                  //int k=12;
                  //for (int i=-2*k; i&lt;2*k; ++i)
                  //{
                  //path3 p=(i/k,4-(i/k)^2,0)--((i+1)/k,4-((i+1)/k)^2,0)--((i+1)/k,4-((i+1)/k)^2,2*(4-((i+1)/k)^2))--((i)/k,4-((i)/k)^2,2*(4-((i)/k)^2));
                  //draw(surface(p -- cycle), simplesurfacepen2);
                  //path3 p=(i/k,0,0)--(i/k,4-(i/k)^2,2*(4-(i/k)^2))--((i+1)/k,4-((i+1)/k)^2,2*(4-((i+1)/k)^2))--((i+1//)/k,0,0);
                  //draw(surface(p -- cycle), simplesurfacepen);
                  //}

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y*(4-t.x^2),2*t.y*(4-t.x^2));//
                  }
                  surface s=surface(f,(-2,0),(2,1),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,(4-t.x^2),2*t.y*(4-t.x^2));//
                  }
                  surface s=surface(f,(-2,0),(2,1),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y*(4-t.x^2),0);//
                  }
                  surface s=surface(f,(-2,0),(2,1),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //label and arrow
                  label("$z=2y$",(-2,2,7));
                  draw((-1.8,2,6.8)--(-1,2,4.1),Arrow3(size=2mm));
                  label("$y=4-x^2$",(2.5,2,0));
                  draw((2.3,2.5,0.2)--(1.55,2.25,2.5),Arrow3(size=2mm));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>8192/105\approx 78.019</m>
            </p>
          </answer>
        </exercise>

        <exercise label="ex-divergence-theorem-flux-4">
          <statement>
            <p>
              <m>\surfaceS</m> is the surface formed by the intersections of the cylinder <m>z=1-x^2</m> and the planes <m>y=-2</m>,
              <m>y=2</m> and <m>z=0</m>;
              <m>\vec F = \langle 0,y^3,0\rangle</m>.
            </p>

              <image>
                <shortdescription>A surface resembling a barn or greenhouse with an arched roof.</shortdescription>
                <description>
                  <p>
                    There are four components to this surface.
                    Overall, the surface looks like the exterior of a barn or greenhouse with an arched roof.
                  </p>

                  <p>
                    <ul>
                      <li>
                        <p>
                          The graph <m>z=1-x^2</m> is a parabolic cylinder, opening downwards.
                          It is shaped like an arch, with its peak along the line with <m>z=1</m> directly above the <m>y</m> axis.
                          The cylinder extends to the <m>xy</m> plane, and is plotted for <m>-2\leq y\leq 2</m>.
                        </p>
                      </li>

                      <li>
                        <p>
                          The <q>ends</q> of the surface lie in the planes <m>y=2</m> and <m>y=-2</m>.
                          They are bounded above by the parabola <m>z=1-x^2</m>,
                          and below by the <m>xy</m> plane, for <m>-1\leq x\leq 1</m>.
                        </p>
                      </li>

                      <li>
                        <p>
                          The bottom of the surface is a rectangle in the <m>xy</m> plane,
                          given by <m>-1\leq x\leq 1</m> and <m>-2\leq y\leq 2</m>.
                          This is where the parabolic cylinder, and the two ends, meet the <m>xy</m> plane.
                        </p>
                      </li>
                    </ul>
                  </p>
                </description>
                <asymptote label="img_14_07_ex_16_3D">



                  //ASY file for fig14_05_ex_23_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(14,14,4);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={-2,2};
                  real[] myzchoice={1};
                  defaultpen(0.5mm);

                  pair xbounds=(-2.5,2.5);
                  pair ybounds=(-2.5,2.5);
                  pair zbounds=(-0.25,1.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y,1-t.x^2);//
                  }
                  surface s=surface(f,(-1,-2),(1,2),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,-2,t.y*(1-t.x^2));//
                  }
                  surface s=surface(f,(-1,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,2,t.y*(1-t.x^2));//
                  }
                  surface s=surface(f,(-1,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  triple f(pair t) {
                    return (t.x,t.y,0);//
                  }
                  surface s=surface(f,(-1,-2),(1,2),2,2,Spline);
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  triple g(real t) {return (t,-2,1-t^2);}
                  path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (t,2,1-t^2);}
                  path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  draw((1,-2,0)--(1,2,0)--(-1,2,0)--(-1,-2,0)--cycle,bluepen+linewidth(2));

                  //label and arrow
                  label("$z=1-x^2$",(0,1,1.55));
                  draw((0,.9,1.45)--(0,.5,1.05),Arrow3(size=2mm));

                  //triple g(real t) {return (0,t,6-t^2);}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>64/3</m>
            </p>
          </answer>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-stokes-theorem-circulation">
        <introduction>
          <p>
            In the following exercises,
            a closed curve <m>C</m> that is the boundary of a surface <m>\surfaceS</m> is given along with a vector field <m>\vec F</m>.
            Find the circulation of <m>\vec F</m> around <m>C</m> either through direct computation or through Stokes' Theorem.
          </p>
        </introduction>

        <exercise label="ex-stokes-theorem-circulation-1">
          <statement>
            <p>
              <m>C</m> is the curve whose <m>x</m>- and <m>y</m>-values are determined by the three sides of a triangle with vertices at <m>(-1,0)</m>,
              <m>(1,0)</m> and <m>(0,1)</m>, traversed in that order,
              and the <m>z</m>-values are determined by the function <m>z=xy</m>;
              <m>\vec F = \langle z-y^2,x,z\rangle</m>.
            </p>

              <image>
                <shortdescription>A twisted-looking surface given by a portion of a hyperbolic paraboloid.</shortdescription>
                <description>
                  <p>
                    The graph <m>z=xy</m> is a hyperbolic paraboloid;
                    it is plotted here relative to the usual three-dimensional coordinate axes, over a triangular domain.
                  </p>

                  <p>
                    The surface has a twisted, wavy shape.
                    It has one edge that lies along the <m>x</m> axis, for <m>-1\leq x\leq 1</m>.
                    For <m>0\leq x\leq 1</m>, the surface bends upward, with its highest points above the line <m>y=x</m>.
                    It then bends back down to meet the <m>y</m> axis.
                  </p>

                  <p>
                    The portion for <m>-1\leq x\leq 0</m> is like a mirror image of the other side,
                    but it lies below the <m>xy</m> plane.
                    The lowest points lie below the line <m>y=-x</m>, 
                    and the surface dips down from the <m>x</m> and <m>y</m> axes to meet these points.
                  </p>

                  <p>
                    The other part of the boundary begins on the <m>x</m> axis at <m>(1,0,0)</m>.
                    It curves upward in a parabolic arch, meeting the <m>y</m> axis at <m>(0,1,0)</m>.
                    The boundary then dips downward in another parabolic curve
                    that rises up to meet the <m>x</m> axis again at <m>(-1,0,0)</m>.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_17_3D">



                  //ASY file for fig14_07_ex_23_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(-10,22,1);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={1};
                  real[] myzchoice={.25};
                  defaultpen(0.5mm);

                  pair xbounds=(-1.25,1.25);
                  pair ybounds=(-.25,1.25);
                  pair zbounds=(-.25,.3);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x-1+t.y*(2-2*t.x),t.x,(t.x-1+t.y*(2-2*t.x))*t.x);//
                  }
                  surface s=surface(f,(0,0),(1,1),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //triple g(real t) {return (t,-2,1-t^2);}
                  //path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (t,0,0);}
                  path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (t,1-t,t*(1-t));}
                  path3 mypath=graph(g,0,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (t,t+1,t*(t+1));}
                  path3 mypath=graph(g,-1,0,operator ..);draw(mypath,bluepen+linewidth(2));

                  //draw((-1,0,0)--(1,0,0)--(0,1,0)--cycle,bluepen+linewidth(2));

                  //label and arrow
                  //label("$z=1-x^2$",(0,1,1.55));
                  //draw((0,.9,1.45)--(0,.5,1.05),Arrow3(size=2mm));

                  //triple g(real t) {return (0,t,6-t^2);}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>5/3</m>
            </p>
          </answer>
        </exercise>

        <exercise label="ex-stokes-theorem-circulation-2">
          <statement>
            <p>
              <m>C</m> is the curve whose <m>x</m>- and <m>y</m>-values are given by
              <m>\vec r(t) = \langle 2\cos(t),2\sin(t)\rangle</m> and the <m>z</m>-values are determined by the function <m>z=x^2+y^3-3y+1</m>;
              <m>\vec F = \langle -y,x,z\rangle</m>.
            </p>

              <image>
                <shortdescription>A surface that looks something like a ladle, if the handle had melted and drooped downward.</shortdescription>
                <description>
                  <p>
                    This might be one of the more complicated surfaces in the book.
                    It is plotted relative to the usual set of coordinate axes in three dimensions.
                    There is a local minimum that lies along the <m>y</m> axis.
                    The surface is bowl-shaped near the minimum.
                  </p>

                  <p>
                    The boundary of the surface is wavy.
                    There is a peak on the boundary at the point <m>(0,2,6)</m>.
                    If we travel along the boundary in either direction from this point,
                    the surface dips down when <m>y</m> is close to <m>1</m>, and then climbs back up again.
                  </p>

                  <p>
                    Above the <m>y</m> axis, the surface climbs from the minimum to a saddle point when <m>y=-1</m>.
                    The surface climbs up if we move away from the saddle point in the <m>x</m> direction,
                    and it dips back down if we move in the <m>y</m> direction.
                  </p>

                  <p>
                    If the surface were flipped over, it would look like a saddle with a back rest,
                    and a hump in the front.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_18_3D">



                  //ASY file for fig14_07_ex_18_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(14,14,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-2,2};
                  real[] myychoice={-2,2};
                  real[] myzchoice={6};
                  defaultpen(0.5mm);

                  pair xbounds=(-2.5,2.5);
                  pair ybounds=(-2.5,2.5);
                  pair zbounds=(-.25,6.5);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.y*cos(t.x),t.y*sin(t.x),(t.y*cos(t.x))^2+(t.y*sin(t.x))^3-3t.y*sin(t.x)+1);//
                  }
                  surface s=surface(f,(0,0),(2pi,2),16,8,Spline);
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //triple g(real t) {return (t,-2,1-t^2);}
                  //path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (2cos(t),2sin(t),4cos(t)^2+8sin(t)^3-6sin(t)+1);}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (t,1-t,t*(1-t));}
                  //path3 mypath=graph(g,0,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (t,t+1,t*(t+1));}
                  //path3 mypath=graph(g,-1,0,operator ..);draw(mypath,bluepen+linewidth(2));

                  //draw((-1,0,0)--(1,0,0)--(0,1,0)--cycle,bluepen+linewidth(2));

                  //label and arrow
                  //label("$z=1-x^2$",(0,1,1.55));
                  //draw((0,.9,1.45)--(0,.5,1.05),Arrow3(size=2mm));

                  //triple g(real t) {return (0,t,6-t^2);}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>8\pi</m>
            </p>
          </answer>
        </exercise>

        <exercise label="ex-stokes-theorem-circulation-3">
          <statement>
            <p>
              <m>C</m> is the curve whose <m>x</m>- and <m>y</m>-values are given by
              <m>\vec r(t) = \langle \cos(t),3\sin(t)\rangle</m> and the <m>z</m>-values are determined by the function <m>z=5-2x-y</m>;
              <m>\vec F = \langle -\frac13y,3x,\frac23y-3x\rangle</m>.
            </p>

              <image>
                <shortdescription>A region in a plane in space, bounded by an ellipse in that plane.</shortdescription>
                <description>
                  <p>
                    The surface is planar; it is bounded by an ellipse that lies in the plane <m>z=5-2x-y</m>.
                    The ellipse is centered on the <m>z</m> axis.
                    The surface consists of all points in the plane that lie on or inside this ellipse.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_19_3D">



                  //ASY file for fig14_07_ex_18_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(14,14,10);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-2,2};
                  real[] myychoice={-2,2};
                  real[] myzchoice={10};
                  defaultpen(0.5mm);

                  pair xbounds=(-2.5,2.5);
                  pair ybounds=(-2.5,2.5);
                  pair zbounds=(-.25,11);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.y*cos(t.x),3*t.y*sin(t.x),-(t.y*cos(t.x))*2-3*(t.y*sin(t.x))+5);//
                  }
                  surface s=surface(f,(0,0),(2pi,1),16,8,Spline);
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //triple g(real t) {return (t,-2,1-t^2);}
                  //path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  triple g(real t) {return (cos(t),3sin(t),-2cos(t)-3sin(t)+5);}
                  path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (t,1-t,t*(1-t));}
                  //path3 mypath=graph(g,0,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (t,t+1,t*(t+1));}
                  //path3 mypath=graph(g,-1,0,operator ..);draw(mypath,bluepen+linewidth(2));

                  //draw((-1,0,0)--(1,0,0)--(0,1,0)--cycle,bluepen+linewidth(2));

                  //label and arrow
                  //label("$z=1-x^2$",(0,1,1.55));
                  //draw((0,.9,1.45)--(0,.5,1.05),Arrow3(size=2mm));

                  //triple g(real t) {return (0,t,6-t^2);}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>23\pi</m>
            </p>
          </answer>
        </exercise>

        <exercise label="ex-stokes-theorem-circulation-4">
          <statement>
            <p>
              <m>C</m> is the curve whose <m>x</m>- and <m>y</m>-values are sides of the square with vertices at <m>(1,1)</m>,
              <m>(-1,1)</m>,
              <m>(-1,-1)</m> and <m>(1,-1)</m>, traversed in that order,
              and the <m>z</m>-values are determined by the function <m>z=10-5x-2y</m>;
              <m>\vec F = \langle 5y^2,2y^2,y^2\rangle</m>.
            </p>

              <image>
                <shortdescription>A rectangle lying within a plane in space.</shortdescription>
                <description>
                  <p>
                    The image shows a rectangle in space, viewed in perspective,
                    relative to a set of three-dimensional coordinate axes.
                  </p>

                  <p>
                    The sides of the rectangle lie above the square given by <m>-1\leq x\leq 1</m> and <m>-1\leq y\leq 1</m>.
                    The <m>z</m> coordinates of the points on the rectangle are given by the plane equation <m>z=10-5x-2y</m>.
                  </p>
                </description>
                <asymptote label="img_14_07_ex_20_3D">



                  //ASY file for fig14_07_ex_20_3D.asy in Chapter 14

                  size(200,200,IgnoreAspect);
                  //currentprojection=perspective(7,2,1);
                  currentprojection=orthographic(11,11,80);
                  defaultrender.merge=true;

                  // setup and draw the axes
                  real[] myxchoice={-1,1};
                  real[] myychoice={-1,1};
                  real[] myzchoice={5,10,15};
                  defaultpen(0.5mm);

                  pair xbounds=(-1.25,1.25);
                  pair ybounds=(-1.25,1.25);
                  pair zbounds=(-.25,18);

                  xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                  yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                  zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                  label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                  label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                  label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                  //Draw paraboloid over unit disk
                  triple f(pair t) {
                    return (t.x,t.y,10-5t.x-2t.y);//
                  }
                  surface s=surface(f,(-1,-1),(1,1),3,3,Spline);
                  pen p=apexmeshpen;
                  draw(s,surfacepen,meshpen=p);

                  //triple g(real t) {return (t,-2,1-t^2);}
                  //path3 mypath=graph(g,-1,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (cos(t),3sin(t),-2cos(t)-3sin(t)+5);}
                  //path3 mypath=graph(g,0,2pi,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (t,1-t,t*(1-t));}
                  //path3 mypath=graph(g,0,1,operator ..);draw(mypath,bluepen+linewidth(2));

                  //triple g(real t) {return (t,t+1,t*(t+1));}
                  //path3 mypath=graph(g,-1,0,operator ..);draw(mypath,bluepen+linewidth(2));

                  draw((1,1,3)--(-1,1,13)--(-1,-1,17)--(1,-1,7)--cycle,bluepen+linewidth(2));

                  //label and arrow
                  //label("$z=1-x^2$",(0,1,1.55));
                  //draw((0,.9,1.45)--(0,.5,1.05),Arrow3(size=2mm));

                  //triple g(real t) {return (0,t,6-t^2);}
                  //path3 mypath=graph(g,-2,2,operator ..);draw(mypath,bluepen+linewidth(2));

                </asymptote>
              </image>
          </statement>
          <answer>
            <p>
              <m>0</m>
            </p>
          </answer>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-stokes-divergence-understand">
        <introduction>
          <p>
            The following exercises<nbsp/>are designed to challenge your understanding and require no computation.
          </p>
        </introduction>


        <exercise label="exset-stokes-divergence-understand-1">
          <statement>
            <p>
              Let <m>\surfaceS</m> be any closed surface enclosing a domain <m>D</m>.
              Consider <m>\vec F_1 = \langle x,0,0\rangle</m> and <m>\vec F_2=\langle y,y^2,z-2yz\rangle</m>.
            </p>

            <p>
              These fields are clearly very different.
              Why is it that the total outward flux of each field across <m>\surfaceS</m> is the same?
            </p>
          </statement>
          <answer>
            <p>
              Each field has a divergence of 1;
              by the Divergence Theorem,
              the total outward flux across <m>\surfaceS</m> is <m>\iint_D 1\, dS</m> for each field.
            </p>
          </answer>
        </exercise>

        <exercise label="exset-stokes-divergence-understand-2">
          <task label="exset-stokes-divergence-understand-2a">
            <statement>
              <p>
                Green's Theorem can be used to find the area of a region enclosed by a curve by evaluating a line integral with the appropriate choice of vector field <m>\vec F</m>.
                What condition on <m>\vec F</m> makes this possible?
              </p>
            </statement>
            <answer>
              <p>
                <m>\curl\vec F = 1</m>.
              </p>
            </answer>
          </task>

          <task label="exset-stokes-divergence-understand-2b">
            <statement>
              <p>
                Likewise, Stokes' Theorem can be used to find the surface area of a region enclosed by a curve in space by evaluating a line integral with the appropriate choice of vector field <m>\vec F</m>.
                What condition on <m>\vec F</m> makes this possible?
              </p>
            </statement>
            <answer>
              <p>
                <m>\curl\vec F\cdot \vec n = 1</m>,
                where <m>\vec n</m> is a unit vector normal to <m>\surfaceS</m>.
              </p>
            </answer>
          </task>
        </exercise>

        <exercise label="exset-stokes-divergence-understand-3">
          <statement>
            <p>
              The Divergence Theorem establishes equality between a particular double integral and a particular triple integral.
              What types of circumstances would lead one to choose to evaluate the triple integral over the double integral?
            </p>
          </statement>
          <answer>
            <p>
              Answers will vary.
              Often the closed surface <m>\surfaceS</m> is composed of several smooth surfaces.
              To measure total outward flux,
              this may require evaluating multiple double integrals.
              Each double integral requires the parametrization of a surface and the computation of the cross product of partial derivatives.
              One triple integral may require less work,
              especially as the divergence of a vector field is generally easy to compute.
            </p>
          </answer>
        </exercise>

        <exercise label="exset-stokes-divergence-understand-4">
          <statement>
            <p>
              Stokes' Theorem establishes equality between a particular line integral and a particular double integral.
              What types of circumstances would lead one to choose to evaluate the double integral over the line integral?
            </p>
          </statement>
          <answer>
            <p>
              Answers will vary.
              Often the closed curve <m>C</m> is composed of several smooth curves.
              To measure the total circulation,
              one may have to evaluate line integrals along each curve.
              Each line integral requires the parametrization of its curve.
              It may be less work to evaluate one single double (<ie/>, surface) integral.
            </p>
          </answer>
        </exercise>
      </exercisegroup>
    </subexercises>
  </exercises>
</section>
