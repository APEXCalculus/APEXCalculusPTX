<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_IBP" label="sec_IBP">
  <title>Integration by Parts</title>
  <p>
    Here's a simple integral that we can't yet evaluate:
    <me>
      \int x\cos(x) \,dx
    </me>.
  </p>

  <p>
    It's a simple matter to take the derivative of the integrand using the Product Rule,
    but there is no Product Rule for integrals.
    However, this section introduces
    <em>Integration by Parts</em>,
    a method of integration that is based on the Product Rule for derivatives.
    It will enable us to evaluate this integral.
  </p>

  <figure xml:id="vid-int-parts-intro" component="video" vshift="0">
    <caption>Video introduction to <xref ref="sec_IBP"/></caption>
    <video youtube="v7KGuoM-cgU" label="vid-int-parts-intro"/>
  </figure>

  <p>
    The Product Rule says that if <m>u</m> and <m>v</m> are functions of <m>x</m>,
    then <m>(uv)' = u'v + uv'</m>.
    For simplicity,
    we've written <m>u</m> for <m>u(x)</m> and <m>v</m> for <m>v(x)</m>.
    Suppose we integrate both sides with respect to <m>x</m>.
    This gives
    <me>
      \int (uv)'\,dx = \int (u'v+uv')\,dx
    </me>.
  </p>

  <p>
    By the Fundamental Theorem of Calculus,
    the left side integrates to <m>uv</m>.
    The right side can be broken up into two integrals, and we have
    <me>
      uv = \int u'v\,dx + \int uv'\,dx
    </me>.
  </p>

  <p>
    Solving for the second integral we have
    <me>
      \int uv'\,dx = uv - \int u'v\,dx
    </me>.
  </p>

  <p>
    Using differential notation,
    we can write <m>du = u'(x)dx</m> and
    <m>dv=v'(x)dx</m> and the expression above can be written as follows:
    <me>
      \int u\,dv = uv - \int v\,du
    </me>.
  </p>

  <p>
    This is the Integration by Parts formula.
    For reference purposes, we state this in a theorem.
  </p>

  <theorem xml:id="thm_IBP">
    <title>Integration by Parts</title>
    <statement>
      <p>
        Let <m>u</m> and <m>v</m> be differentiable functions of
        <m>x</m> on an interval <m>I</m> containing <m>a</m> and <m>b</m>.
        Then
        <me>
          \int u\, dv = uv - \int v\, du
        </me>,
        and <idx><h>integration</h><h>by parts</h></idx>
        <me>
          \int_{x=a}^{x=b} u\, dv = uv\Big|_a^b - \int_{x=a}^{x=b}v\, du
        </me>.
      </p>
    </statement>
  </theorem>

  <aside vshift="3">
    <p>
      The integration by parts formula can also be written as
      <md>
        <mrow>\amp\int f(x)\,g'(x) \,dx</mrow>
        <mrow>\amp\quad\quad =f(x)g(x)-\int \fp(x)\,g(x)\,dx</mrow>
      </md>
      for differentiable functions <m>f</m> and <m>g</m>.
    </p>
  </aside>

  <p>
    Let's try an example to understand our new technique.
  </p>

  <example xml:id="ex_ibp1">
    <title>Integrating using Integration by Parts</title>
    <statement>
      <p>
        Evaluate <m>\ds\int x\cos(x) \, dx</m>.
      </p>
    </statement>
    <solution>
      <p>
        The key to Integration by Parts is to identify part of the integrand as
        <q><m>u</m></q> and part as <q><m>dv</m>.</q>
        Regular practice will help one make good identifications,
        and later we will introduce some principles that help.
        For now, let <m>u=x</m> and <m>dv=\cos(x) \, dx</m>.
      </p>

      <p>
        It is generally useful to make a small table of these values as done below.
        Right now we only know <m>u</m> and <m>dv</m> as shown on the left of
        <xref ref="fig_ibp1"/>;
        on the right we fill in the rest of what we need.
        If <m>u = x</m>, then <m>du = dx</m>.
        Since <m>dv = \cos(x)\, dx</m>,
        <m>v</m> is an antiderivative of <m>\cos(x)</m>.
        We choose <m>v = \sin(x)</m>.
      </p>

      <figure xml:id="fig_ibp1">
        <caption>Setting up Integration by Parts</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>u\amp = x \amp  v\amp =\mathord{?}</mrow>
              <mrow>du\amp = \mathord{?}  \amp  dv\amp =\cos(x) \, dx</mrow>
            </md>
          </p>

          <p>
            <m>\implies</m>
          </p>

          <p>
            <md>
              <mrow>u\amp = x \amp  v\amp =\sin(x)</mrow>
              <mrow>du\amp = dx \amp  dv\amp =\cos(x) \, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        Now substitute all of this into the Integration by Parts formula, giving
        <me>
          \int x\cos(x)\,dx = x\sin(x) - \int \sin(x) \,dx
        </me>.
      </p>

      <p>
        We can then integrate <m>\sin(x)</m> to get
        <m>-\cos(x) + C</m> and overall our answer is
        <me>
          \int x\cos(x)\, dx = x\sin(x) + \cos(x) + C
        </me>.
      </p>

      <p>
        Note how the antiderivative contains a product, <m>x\sin(x)</m>.
        This product is what makes Integration by Parts necessary.
      </p>

      <p>
        We can check our work by taking the derivative:
        <md>
          <mrow>\lzoo{x}{x\sin(x) + \cos(x) + C} \amp =x\cos(x)+\sin(x)-\sin(x)+0</mrow>
          <mrow>\amp = x\cos(x)</mrow>
        </md>.
      </p>
    </solution>
    <solution component="video" vshift="2">
      <title>Video solution</title>
      <video width="98%" youtube="gKtzlaH2EPo" label="vid-int-parts-ex-onestep" component="video"/>
    </solution>
  </example>

  <p>
    You may wonder what would have happened in <xref ref="ex_ibp1"/>
    if we had chosen our <m>u</m> and <m>dv</m> differently.
    If we had chosen <m>u=\cos(x)</m> and
    <m>dv=x \, dx</m> then <m>du=-\sin(x)\, dx</m> and <m>v=x^2/2</m>.
    Our second integral is not simpler than the first;
    we would have
    <me>
      \int x\cos(x)\,dx=\cos(x)\frac{x^2}{2}-\int \frac{x^2}{2}\left(-\sin(x)\right)\,dx
    </me>.
    The only way to approach this second integral would be yet another integration by parts.
  </p>

  <p>
    <xref ref="ex_ibp1"/>
    demonstrates how Integration by Parts works in general.
    We try to identify <m>u</m> and <m>dv</m> in the integral we are given,
    and the key is that we usually want to choose <m>u</m> and <m>dv</m>
    so that <m>du</m> is simpler than <m>u</m> and <m>v</m>
    is hopefully not too much more complicated than <m>dv</m>.
    This will mean that the integral on the right side of the Integration by Parts formula,
    <m>\int v\,du</m> will be simpler to integrate than the original integral <m>\int u\,dv</m>.
  </p>

  <p>
    In the example above, we chose <m>u=x</m> and <m>dv=\cos(x)\,dx</m>.
    Then <m>du=dx</m> was simpler than <m>u</m> and
    <m>v=\sin(x)</m> is no more complicated than <m>dv</m>.
    Therefore, instead of integrating <m>x\cos(x) \,dx</m>,
    we could integrate <m>\sin(x)\,dx</m>, which we knew how to do.
  </p>

  <p>
    A useful mnemonic for helping to determine <m>u</m> is <q><acro>LIATE</acro>,</q> where
  </p>

  <p>
    <acro>L</acro> = <em>L</em>ogarithmic, <acro>I</acro> = <em>I</em>nverse Trig., <acro>A</acro> =
    <em>A</em>lgebraic (polynomials, roots,
    power functions), <acro>T</acro> = <em>T</em>rigonometric,
    and <acro>E</acro> = <em>E</em>xponential.
  </p>

  <p>
    If the integrand contains both a logarithmic and an algebraic term,
    in general letting <m>u</m> be the logarithmic term works best,
    as indicated by <acro>L</acro> coming before <acro>A</acro> in <acro>LIATE</acro>.
  </p>

  <p>
    We now consider another example.
  </p>

  <example xml:id="ex_ibp2">
    <title>Integrating using Integration by Parts</title>
    <statement>
      <p>
        Evaluate <m>\displaystyle \int x e^x\,dx</m>.
      </p>
    </statement>
    <solution>
      <p>
        The integrand contains an <em>A</em>lgebraic term (<m>x</m>) and an
        <em>E</em>xponential term
        (<m>e^x</m>).
        Our mnemonic suggests letting <m>u</m> be the algebraic term,
        so we choose <m>u=x</m> and <m>dv=e^x\,dx</m>.
        Then <m>du=dx</m> and <m>v=e^x</m> as indicated by the tables below.
      </p>

      <figure xml:id="fig_ibp2">
        <caption>Setting up Integration by Parts</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>u\amp = x \amp  v\amp =\mathord{?}</mrow>
              <mrow>du\amp = \mathord{?}  \amp  dv\amp =e^x \, dx</mrow>
            </md>
          </p>

          <p>
            <m>\implies</m>
          </p>

          <p>
            <md>
              <mrow>u\amp = x \amp  v\amp =e^x</mrow>
              <mrow>du\amp = dx \amp  dv\amp =e^x \, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        We see <m>du</m> is simpler than <m>u</m>,
        while there is no change in going from <m>dv</m> to <m>v</m>.
        This is good.
        The Integration by Parts formula gives
        <me>
          \int x e^x\,dx = xe^x - \int e^x\,dx
        </me>.
      </p>

      <p>
        The integral on the right is simple; our final answer is
        <me>
          \int xe^x\, dx = xe^x - e^x + C
        </me>.
      </p>

      <p>
        Note again how the antiderivatives contain a product term.
      </p>
    </solution>
  </example>

  <example xml:id="ex_ibp3">
    <title>Integrating using Integration by Parts</title>
    <statement>
      <p>
        Evaluate <m>\displaystyle \int x^2\cos(x) \,dx</m>.
      </p>
    </statement>
    <solution>
      <p>
        The mnemonic suggests letting <m>u=x^2</m> instead of the trigonometric function,
        hence <m>dv=\cos(x)\,dx</m>.
        Then <m>du=2x\,dx</m> and <m>v=\sin(x)</m> as shown below.
      </p>

      <figure xml:id="fig_ibp3">
        <caption>Setting up Integration by Parts</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>u\amp = x^2 \amp  v\amp =\mathord{?}</mrow>
              <mrow>du\amp = \mathord{?}  \amp  dv\amp =\cos(x) \, dx</mrow>
            </md>
          </p>

          <p>
            <m>\implies</m>
          </p>

          <p>
            <md>
              <mrow>u\amp = x^2 \amp  v\amp =\sin(x)</mrow>
              <mrow>du\amp = 2x\, dx \amp  dv\amp =\cos(x) \, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        The Integration by Parts formula gives
        <me>
          \int x^2\cos(x)\,dx = x^2\sin(x) - \int 2x\sin(x)\,dx
        </me>.
      </p>

      <p>
        At this point,
        the integral on the right is indeed simpler than the one we started with,
        but to evaluate it, we need to do Integration by Parts again.
        Here we choose <m>r=2x</m> and
        <m>ds=\sin(x)</m> and fill in the rest below.
        (We are choosing new names since we have already used <m>u</m> and <m>v</m>.
        Our integration by parts formula is now <m>\int r\,ds=rs-\int s\,dr</m>.)
      </p>

      <figure xml:id="fig_ibp3b">
        <caption>Setting up Integration by Parts (again)</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>u\amp = 2x \amp  v\amp =\text{?}</mrow>
              <mrow>du\amp = \text{?}  \amp  dv\amp =\sin(x)\, dx</mrow>
            </md>
          </p>

          <p>
            <m>\Rightarrow</m>
          </p>

          <p>
            <md>
              <mrow>u\amp = 2x \amp  v\amp =-\cos(x)</mrow>
              <mrow>du\amp = 2\, dx \amp  dv\amp =\sin(x)\, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        <me>
          \int x^2\cos(x)\,dx = x^2\sin(x) - \left(-2x\cos(x) - \int -2\cos(x)\,dx\right)
        </me>.
      </p>

      <p>
         The integral all the way on the right is now something we can evaluate.
        It evaluates to <m>-2\sin(x)</m>.
        Then going through and simplifying,
        being careful to keep all the signs straight, our answer is
        <me>
          \int x^2\cos(x)\, dx = x^2\sin(x)  + 2x\cos(x) - 2\sin(x) + C
        </me>.
      </p>
    </solution>
    <solution component="video" vshift="3">
      <title>Video solution</title>
      <video width="98%" youtube="j9pCcQMSjbg" label="vid-int-parts-ex-twostep" component="video"/>
    </solution>
  </example>

  <example xml:id="ex_ibp4">
    <title>Integrating using Integration by Parts</title>
    <statement>
      <p>
        Evaluate <m>\displaystyle \int e^x\cos(x) \,dx</m>.
      </p>
    </statement>
    <solution>
      <p>
        This is a classic problem.
        Our mnemonic suggests letting <m>u</m>
        be the trigonometric function instead of the exponential.
        In this particular example,
        one can let <m>u</m> be either <m>\cos(x)</m> or <m>e^x</m>;
        to demonstrate that we do not have to follow <acro>LIATE</acro>, we choose
        <m>u=e^x</m> and hence <m>dv = \cos(x)\,dx</m>.
        Then <m>du=e^x\,dx</m> and <m>v=\sin(x)</m> as shown below.
      </p>

      <figure xml:id="fig_ibp4">
        <caption>Setting up Integration by Parts</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>u\amp = e^x \amp  v\amp =\mathord{?}</mrow>
              <mrow>du\amp = \mathord{?}  \amp  dv\amp =\cos(x) \, dx</mrow>
            </md>
          </p>

          <p>
            <m>\implies</m>
          </p>

          <p>
            <md>
              <mrow>u\amp = e^x \amp  v\amp =\sin(x)</mrow>
              <mrow>du\amp = e^x  \amp  dv\amp =\cos(x) \, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        Notice that <m>du</m> is no simpler than <m>u</m>,
        going against our general rule
        (but bear with us).
        The Integration by Parts formula yields
        <me>
          \int e^x\cos(x)\, dx = e^x\sin(x) - \int e^x\sin(x)\,dx
        </me>.
      </p>

      <p>
        The integral on the right is not much different than the one we started with,
        so it seems like we have gotten nowhere.
        Let's keep working and apply Integration by Parts to the new integral,
        using <m>u=e^x</m> and <m>dv = \sin(x)\,dx</m>.
        This leads us to the following:
      </p>

      <figure xml:id="fig_ibp4a">
        <caption>Setting up Integration by Parts (again)</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>r\amp = e^x \amp  s\amp =\mathord{?}</mrow>
              <mrow>dr\amp = \mathord{?}  \amp  ds\amp =\sin(x) \, dx</mrow>
            </md>
          </p>

          <p>
            <m>\implies</m>
          </p>

          <p>
            <md>
              <mrow>r\amp = e^x \amp  s\amp =-\cos(x)</mrow>
              <mrow>dr\amp = e^x\, dx \amp  ds\amp =\sin(x) \, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        The Integration by Parts formula then gives:
        <md>
          <mrow>\int e^x\cos(x)\,dx \amp = e^x\sin(x) - \left(-e^x\cos(x) - \int -e^x\cos(x)\,dx\right)</mrow>
          <mrow>\amp = e^x\sin(x)+ e^x\cos(x) - \int e^x\cos(x)\, dx</mrow>
        </md>.
      </p>

      <p>
        It seems we are back right where we started,
        as the right hand side contains <m>\int e^x\cos(x)\,dx</m>.
        But this is actually a good thing.
      </p>

      <p>
        Add <m>\ds\int e^x\cos(x)\, dx</m> to both sides.
        This gives
        <md>
          <mrow>2\int e^x\cos(x) \, dx \amp  = e^x\sin(x) + e^x\cos(x)</mrow>
          <intertext>Now divide both sides by 2 and then add the integration constant:</intertext>
          <mrow>\int e^x\cos(x) \, dx \amp  = \frac{1}{2}\big(e^x\sin(x) + e^x\cos(x) \big)+C</mrow>
        </md>.
      </p>

      <p>
        Simplifying a little, our answer is thus
        <me>
          \int e^x\cos(x)\, dx = \frac12e^x\left(\sin(x) + \cos(x)\right)+C
        </me>.
      </p>
    </solution>
    <solution component="video" vshift="3">
      <title>Video solution</title>
      <video width="98%" youtube="z0A1v2Zkfns" label="vid-int-parts-ex-exp-times-cos" component="video"/>
    </solution>
  </example>

  <example xml:id="ex_ibp5">
    <title>Integrating using Integration by Parts: antiderivative of <m>\ln(x)</m></title>
    <statement>
      <p>
        Evaluate <m>\int \ln(x)\,dx</m>.
      </p>
    </statement>
    <solution>
      <p>
        One may have noticed that we have rules for integrating the familiar trigonometric functions and <m>e^x</m>,
        but we have not yet given a rule for integrating <m>\ln(x)</m>.
        That is because <m>\ln(x)</m> can't easily be integrated with any of the rules we have learned up to this point.
        But we can find its antiderivative by a clever application of Integration by Parts.
        Set <m>u=\ln(x)</m> and <m>dv=dx</m>.
        This is a good,
        sneaky trick to learn as it can help in other situations.
        This determines <m>du=(1/x)\,dx</m> and <m>v=x</m> as shown below.
      </p>

      <figure xml:id="fig_ibp5">
        <caption>Setting up Integration by Parts</caption>
        <sidebyside widths="40% 10% 40%" valign="middle">
          <p>
            <md>
              <mrow>u\amp = \ln(x) \amp  v\amp =\mathord{?}</mrow>
              <mrow>du\amp = \mathord{?}  \amp  dv\amp =1 \, dx</mrow>
            </md>
          </p>

          <p>
            <m>\implies</m>
          </p>

          <p>
            <md>
              <mrow>u\amp = \ln(x) \amp  v\amp =x</mrow>
              <mrow>du\amp = 1/x\, dx  \amp  dv\amp =1 \, dx</mrow>
            </md>
          </p>
        </sidebyside>
      </figure>

      <p>
        Putting this all together in the Integration by Parts formula,
        things work out very nicely:
        <me>
          \int \ln(x)\,dx = x\ln(x) - \int x\,\frac1x\,dx
        </me>.
      </p>

      <p>
        The new integral simplifies to <m>\int 1\,dx</m>,
        which is about as simple as things get.
        Its integral is <m>x+C</m> and our answer is
        <me>
          \int \ln(x) \, dx = x\ln(x) - x + C
        </me>.
      </p>
    </solution>
    <solution component="video" vshift="3">
      <title>Video solution</title>
      <video width="98%" youtube="NGkLj7djFSw" label="vid-int-parts-ex-log" component="video"/>
    </solution>
  </example>

  <example xml:id="ex_ibp6">
    <title>Integrating using Int. by Parts: antiderivative of <m>\arctan x</m></title>
    <statement>
      <p>
        Evaluate <m>\displaystyle \int \arctan x \,dx</m>.
      </p>
    </statement>
    <solution>
      <p>
        The same sneaky trick we used above works here.
        Let <m>u=\arctan x</m> and <m>dv=dx</m>.
        Then <m>du=1/(1+x^2)\,dx</m> and <m>v=x</m>.
        The Integration by Parts formula gives
        <me>
          \int \arctan x \,dx = x\arctan x - \int \frac x{1+x^2}\,dx
        </me>.
      </p>

      <p>
        The integral on the right can be solved by substitution.
        Taking <m>w=1+x^2</m>, we get <m>dw=2x\,dx</m>.
        The integral then becomes
        <me>
          \int \arctan x \,dx = x\arctan x - \frac12\int \frac 1{w}\,dw
        </me>.
      </p>

      <p>
        The integral on the right evaluates to <m>\ln\abs{w}+C</m>,
        which becomes <m>\ln(1+x^2)+C</m>
        (we can drop the absolute values as <m>1+x^2</m> is always positive).
        Therefore, the answer is
        <me>
          \int \arctan x\, dx = x\arctan x - \frac12\ln(1+x^2) + C
        </me>.
      </p>
    </solution>
    <solution component="video" vshift="3">
      <title>Video solution</title>
      <video width="98%" youtube="md3-8bv5E5M" label="vid-int-parts-ex-arctan" component="video"/>
    </solution>
  </example>

  <paragraphs>
    <title>Substitution Before Integration</title>
    <p>
      When taking derivatives, it was common to employ multiple rules
      (such as using both the Quotient and the Chain Rules).
      It should then come as no surprise that some integrals are best evaluated by combining integration techniques.
      In particular, here we illustrate making an <q>unusual</q>
      substitution first before using Integration by Parts.
    </p>

    <example xml:id="ex_ibp8">
      <title>Integration by Parts after substitution</title>
      <statement>
        <p>
          Evaluate <m>\ds \int \cos(\ln(x))\, dx</m>.
        </p>
      </statement>
      <solution>
        <p>
          The integrand contains a composition of functions,
          leading us to think Substitution would be beneficial.
          Letting <m>u=\ln(x)</m>, we have <m>du = 1/x\, dx</m>.
          This seems problematic, as we do not have a <m>1/x</m> in the integrand.
          But consider:
          <me>
            du = \frac 1x\, dx \quad \Rightarrow \quad x\cdot du = dx
          </me>.
        </p>

        <p>
          Since <m>u = \ln(x)</m>,
          we can use inverse functions and conclude that <m>x = e^u</m>.
          Therefore we have that
          <md>
            <mrow>dx \amp = x\cdot du</mrow>
            <mrow>\amp = e^u\, du</mrow>
          </md>.
        </p>

        <p>
          We can thus replace <m>\ln(x)</m> with <m>u</m> and <m>dx</m> with <m>e^u\, du</m>.
          Thus we rewrite our integral as
          <me>
            \int \cos(\ln(x))\, dx = \int e^u\cos u \, du
          </me>.
        </p>

        <p>
          We evaluated this integral on the right in <xref ref="ex_ibp4"/>. (This integral can also be found in a table of integrals).
          Using the result there, we have:
          <md>
            <mrow>\int \cos(\ln(x) )\, dx \amp = \int e^u\cos(u) \, du</mrow>
            <mrow>\amp = \frac12e^u\big(\sin(u) + \cos(u) \big) + C</mrow>
            <mrow>\amp = \frac12e^{\ln(x) } \big(\sin(\ln(x) ) + \cos(\ln(x) )\big)+C</mrow>
            <mrow>\amp = \frac12x \big(\sin(\ln(x) ) + \cos(\ln(x) )\big)+C</mrow>
          </md>.
        </p>
      </solution>
      <solution component="video" vshift="3">
        <title>Video solution</title>
        <video width="98%" youtube="0j0vM0nosYs" label="vid-int-parts-ex-sub-first" component="video"/>
      </solution>
    </example>
  </paragraphs>

  <paragraphs>
    <title>Definite Integrals and Integration By Parts</title>
    <p>
      So far we have focused only on evaluating indefinite integrals.
      Of course, we can use Integration by Parts to evaluate definite integrals as well,
      as <xref ref="thm_IBP"/> states.
      We do so in the next example.
    </p>

    <example xml:id="ex_ibp7">
      <title>Definite integration using Integration by Parts</title>
      <statement>
        <p>
          Evaluate <m>\displaystyle \int_1^2 x^2 \ln(x) \,dx</m>.
        </p>
      </statement>
      <solution>
        <p>
          Our mnemonic suggests letting <m>u=\ln(x)</m>, hence <m>dv =x^2\,dx</m>.
          We then get <m>du = (1/x)\,dx</m> and <m>v=x^3/3</m> as shown below.
        </p>

        <figure xml:id="fig_ibp7">
          <caption>Setting up Integration by Parts</caption>
          <sidebyside widths="40% 10% 40%" valign="middle">
            <p>
              <md>
                <mrow>u\amp = \ln(x) \amp  v\amp =\text{?}</mrow>
                <mrow>du\amp = \text{?}  \amp  dv\amp =x^2\, dx</mrow>
              </md>
            </p>

            <p>
              <m>\Rightarrow</m>
            </p>

            <p>
              <md>
                <mrow>u\amp = \ln(x)\amp  v\amp =x^3/3</mrow>
                <mrow>du\amp = 1/x\, dx \amp  dv\amp =x^2\, dx</mrow>
              </md>
            </p>
          </sidebyside>
        </figure>

        <p>
          The Integration by Parts formula then gives
          <md>
            <mrow>\int_1^2 x^2 \ln(x)\,dx \amp = \left.\frac{x^3}3\ln(x)\right|_1^2 - \int_1^2 \frac{x^3}{3}\,\frac 1x\,dx</mrow>
            <mrow>\amp =  \left.\frac{x^3}3\ln(x)\right|_1^2 - \int_1^2 \frac{x^2}{3}\,dx</mrow>
            <mrow>\amp =  \left.\frac{x^3}3\ln(x)\right|_1^2 - \left.\frac{x^3}{9}\right|_1^2</mrow>
            <mrow>\amp =  \left.\left(\frac{x^3}3\ln(x) - \frac{x^3}{9}\right)\right|_1^2</mrow>
            <mrow>\amp =	\left(\frac83\ln(2) - \frac89\right)-\left(\frac13\ln(1) - \frac19\right)</mrow>
            <mrow>\amp = \frac83\ln(2) - \frac79</mrow>
            <mrow>\amp \approx 1.07</mrow>
          </md>.
        </p>
      </solution>
      <solution component="video" vshift="3">
        <title>Video solution</title>
        <video width="98%" youtube="O9_0B2gatMo" label="vid-int-parts-ex-definite" component="video"/>
      </solution>
    </example>

    <p>
      In general, Integration by Parts is useful for integrating certain products of functions,
      like <m>\int x e^x\,dx</m> or <m>\int x^3\sin(x)\,dx</m>.
      It is also useful for integrals involving logarithms and inverse trigonometric functions.
    </p>

    <p>
      As stated before,
      integration is generally more difficult than derivation.
      We are developing tools for handling a large array of integrals,
      and experience will tell us when one tool is preferable/necessary over another.
      For instance,
      consider the three similar-looking integrals
      <me>
        \int xe^x\,dx, \qquad  \int x e^{x^2}\,dx \qquad \text{ and }  \qquad \int xe^{x^3}\,dx
      </me>.
    </p>

    <p>
      While the first is calculated easily with Integration by Parts,
      the second is best approached with Substitution.
      Taking things one step further,
      the third integral has no answer in terms of elementary functions,
      so none of the methods we learn in calculus will get us the exact answer.
    </p>

    <p>
      Integration by Parts is a very useful method,
      second only to Substitution.
      In the following sections of this chapter,
      we continue to learn other integration techniques.
      <xref ref="sec_trigint"/>
      focuses on handling integrals containing trigonometric functions.
    </p>
  </paragraphs>

  <exercises>
    <subexercises xml:id="TaC-int-by-parts">
      <title>Terms and Concepts</title>

      <exercise label="TaC-int-by-parts-1">
        <webwork xml:id="webwork-TaC-int-by-parts-1">
          <pg-code>
            $false = PopUp(['?','True','False'],2);
            $true = PopUp(['?','True','False'],1);
          </pg-code>
          <statement>
            <p>
              <var name="$true" form="popup"/>
              Integration by Parts is useful in evaluating integrands that contain products of functions.
            </p>
          </statement>
        </webwork>
      </exercise>
      <!-- Exercise 2 -->
      <exercise label="TaC-int-by-parts-2">
        <webwork xml:id="webwork-TaC-int-by-parts-2">
          <pg-code>
            $false = PopUp(['?','True','False'],2);
            $true = PopUp(['?','True','False'],1);
          </pg-code>
          <statement>
            <p>
              <var name="$false" form="popup"/>
              Integration by Parts can be thought of as the
              <q>opposite of the Chain Rule.</q>
            </p>
          </statement>
        </webwork>
      </exercise>
      <!-- Exercise 3 -->
      <exercise label="TaC-int-by-parts-3">
        <webwork xml:id="webwork-TaC-int-by-parts-3">
          <statement>
            <p>
              For what is <q><acro>LIATE</acro></q> useful?
            </p>
            <p>
              <var form="essay"/>
            </p>
          </statement>
          <solution>
            <p>
              Determining which functions in the integrand to set equal to <q><m>u</m></q>
              and which to set equal to <q><m>dv</m></q>.
            </p>
          </solution>
        </webwork>
      </exercise>
      <!-- New in V4 -->
      <exercise label="TaC-int-by-parts-4">
        <webwork xml:id="webwork-TaC-int-by-parts-4">
          <pg-code>
            $false = PopUp(['?','True','False'],2);
            $true = PopUp(['?','True','False'],1);
          </pg-code>
          <statement>
            <p>
              <var name="$false" form="popup"/>
              If the integral that results from Integration by Parts appears to also need Integration by Parts,
              then a mistake was made in the original choice of <q><m>u</m></q>.
            </p>
          </statement>
          <solution>
            <p>
              F; it is not uncommon to need to use Integration by Parts several times to fully evaluate an integral.
            </p>
          </solution>
        </webwork>
      </exercise>
    </subexercises>

    <subexercises>
      <title>Problems</title>

      <exercisegroup cols="2" xml:id="exset-int-by-parts-evaluate">
        <introduction>
          <p>
            Evaluate the given indefinite integral.
          </p>
        </introduction>
        <!-- Exercise 5 -->
        <exercise xml:id="ibp_prob_5" label="ex-int-by-parts-evaluate-1">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-1">
            <pg-code>
              $F = FormulaUpToConstant("sin(x)-x*cos(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\sin(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
            <solution>
              <p>
                <m>\sin(x) - x\cos(x) +C</m>
              </p>
            </solution>
          </webwork>
        </exercise>
        <!-- Exercise 6 -->
        <exercise label="ex-int-by-parts-evaluate-2">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-2">
            <pg-code>
              $F = FormulaUpToConstant("-e^(-x)*(x+1)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int xe^{-x}\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 7 -->
        <exercise label="ex-int-by-parts-evaluate-3">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-3">
            <pg-code>
              $F = FormulaUpToConstant("-x^2*cos(x)+2x*sin(x)+2*cos(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x^2\sin(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 8 -->
        <exercise label="ex-int-by-parts-evaluate-4">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-4">
            <pg-code>
              $F = FormulaUpToConstant("-x^3*cos(x)+3x^2*sin(x)+6x*cos(x)-6*sin(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x^3\sin(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 9 -->
        <exercise label="ex-int-by-parts-evaluate-5">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-5">
            <pg-code>
              Context("Fraction");
              $F = FormulaUpToConstant("1/2*e^(x^2)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int xe^{x^2}\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 10 -->
        <exercise label="ex-int-by-parts-evaluate-6">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-6">
            <pg-code>
              $F = FormulaUpToConstant("e^x*(x^3-3x^2+6x-6)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x^3e^{x}\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 11 -->
        <exercise label="ex-int-by-parts-evaluate-7">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-7">
            <pg-code>
              Context("Fraction");
              $F = FormulaUpToConstant("-1/2*x*e^(-2x)-e^(-2x)/4");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int xe^{-2x}\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 12 -->
        <exercise label="ex-int-by-parts-evaluate-8">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-8">
            <pg-code>
              Context("Fraction");
              $F = FormulaUpToConstant("1/2*e^x*(sin(x)-cos(x))");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int e^x\sin(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 13 -->
        <exercise xml:id="ibp_prob_13" label="ex-int-by-parts-evaluate-9">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-9">
            <pg-code>
              Context("Fraction");
              $F = FormulaUpToConstant("1/5*e^(2x)*(sin(x)+2*cos(x))");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int e^{2x}\cos(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 14 -->
        <exercise label="ex-int-by-parts-evaluate-10">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-10">
            <pg-code>
              ($m,$n) = (2..9)[NchooseK(8,2)];
              if($envir{problemSeed}==1){$m=2;$n=3};
              $g = gcd($m,$n);
              $M = $m/$g;
              $N = $n/$g;
              $f = Formula("e^($m x) sin($n x)");
              Context("Fraction");
              $frac = Fraction($g,$m**2+$n**2);
              $F = FormulaUpToConstant("$frac  e^($m x)*($M sin($n x) - $N cos($n x))");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 15 -->
        <exercise label="ex-int-by-parts-evaluate-11">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-11">
            <pg-code>
              $m = random(2,9,1);
              if($envir{problemSeed}==1){$m=5;};
              $f = Formula("e^($m x) cos($m x)");
              Context("Fraction");
              $frac = Fraction(1,2*$m);
              $F = FormulaUpToConstant("$frac  e^($m x) (sin($m x) + cos($m x))");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 16 -->
        <exercise label="ex-int-by-parts-evaluate-12">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-12">
            <pg-code>
              $F = FormulaUpToConstant("1/2*sin(x)^2");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int \sin(x) \cos(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 17 -->
        <exercise label="ex-int-by-parts-evaluate-13">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-13">
            <pg-code>
              $f = Formula("sin^-1(x)");
              $F = FormulaUpToConstant("sqrt(1-x^2)+x*asin(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 18 -->
        <exercise label="ex-int-by-parts-evaluate-14">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-14">
            <pg-code>
              $m = random(2,9,1);
              if($envir{problemSeed}==1){$m = 2;};
              $f = Formula("tan^-1($m x)");
              $F = FormulaUpToConstant("x*tan^-1($m x)-1/(2*$m)*ln($m^2x^2+1)")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 19 -->
        <exercise label="ex-int-by-parts-evaluate-15">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-15">
            <pg-code>
              $F = FormulaUpToConstant("1/2*x^2*atan(x)-x/2+1/2*atan(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\tan^{-1}(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 20 -->
        <exercise label="ex-int-by-parts-evaluate-16">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-16">
            <pg-code>
              $f = Formula("cos^-1(x)");
              $F = FormulaUpToConstant("-sqrt(1-x^2)+x*acos(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 21 -->
        <exercise label="ex-int-by-parts-evaluate-17">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-17">
            <pg-code>
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
              $F = FormulaUpToConstant("1/2*x^2*ln(x)-x^2/4");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\ln(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 22 -->
        <exercise label="ex-int-by-parts-evaluate-18">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-18">
            <pg-code>
              $b = non_zero_random(-9,9,1);
              if($envir{problemSeed}==1){$b = -2;};
              $f = Formula("(x+$b)ln(x)")-&gt;reduce;
              Context("Fraction");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
              $F = FormulaUpToConstant("1/2*x^2*ln(x)-x^2/4 + $b x ln(x) - $b x")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 23 -->
        <exercise label="ex-int-by-parts-evaluate-19">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-19">
            <pg-code>
              $b = non_zero_random(-9,9,1);
              if($envir{problemSeed}==1){$b = 1;};
              $f = Formula("x ln(x-$b)")-&gt;reduce;
              Context("Fraction");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[$b,$b+4]});
              $frac = Fraction(($b)**2,2);
              $F = FormulaUpToConstant("1/2 x^2 ln(x-$b) - 1/4 (x-$b)^2 - $b x - $frac ln(x-$b)")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 24 -->
        <exercise label="ex-int-by-parts-evaluate-20">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-20">
            <pg-code>
              $F = FormulaUpToConstant("1/2*x^2*ln(x^2) - x^2/2");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\ln(x^2)\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 25 -->
        <exercise label="ex-int-by-parts-evaluate-21">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-21">
            <pg-code>
              Context()-&gt;variables-&gt;set(x =&gt; {limits =&gt; [0,4]});
              $F = FormulaUpToConstant("1/3*x^3*ln(x) - x^3/9");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x^2\ln(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 26 -->
        <exercise label="ex-int-by-parts-evaluate-22">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-22">
            <pg-code>
              $F = FormulaUpToConstant("2x+x*(ln(x))^2-2x*ln(x)");
              $F-&gt;{limits} = [1,5];
            </pg-code>
            <statement>
              <p>
                <m>\ds \int \left(\ln(x) \right)^2\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 27 -->
        <exercise label="ex-int-by-parts-evaluate-23">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-23">
            <pg-code>
              $b = non_zero_random(-9,9,1);
              if($envir{problemSeed}==1){$b = 1;};
              $f = Formula("(ln(x+$b))^2")-&gt;reduce;
              Context("Fraction");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[-$b,-$b+4]});
              $F = FormulaUpToConstant("2(x+$b)+(x+$b)*ln(x+$b)^2-2*(x+$b)*ln(x+$b)")-&gt;reduce;
              $F-&gt;{limits} = [-$b+1,-$b+5];
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 28 -->
        <exercise label="ex-int-by-parts-evaluate-24">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-24">
            <pg-code>
              $F = FormulaUpToConstant("x*tan(x)+ln(abs(cos(x)))");
              $F-&gt;{test_at} = [[pi/4],[3*pi/4],[5*pi/4],[7*pi/4]];
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\sec^2(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 29 -->
        <exercise label="ex-int-by-parts-evaluate-25">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-25">
            <pg-code>
              $F = FormulaUpToConstant("ln(abs(sin(x)))-x*cot(x)");
              $F-&gt;{test_at} = [[pi/4],[3*pi/4],[5*pi/4],[7*pi/4]];
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\csc^2(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 30 -->
        <exercise label="ex-int-by-parts-evaluate-26">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-26">
            <pg-code>
              $b = non_zero_random(-9,9,1);
              if($envir{problemSeed}==1){$b = -2;};
              $f = Formula("x sqrt(x+$b)")-&gt;reduce;
              Context("Fraction");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[-$b,-$b+4]});
              $frac = Fraction(2*$b,3);
              $F = FormulaUpToConstant("(2/5 (x+$b)^2 - $frac (x+$b))sqrt(x+$b)")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 31 -->
        <exercise label="ex-int-by-parts-evaluate-27">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-27">
            <pg-code>
              $b = non_zero_random(2,9,1);
              if($envir{problemSeed}==1){$b = 2;};
              $f = Formula("x sqrt(x^2-$b)")-&gt;reduce;
              Context("Fraction");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[sqrt($b),sqrt($b)+4]});
              $F = FormulaUpToConstant("1/3(x^2-$b)^(3/2)")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 32 -->
        <exercise label="ex-int-by-parts-evaluate-28">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-28">
            <pg-code>
              $F = FormulaUpToConstant("sec(x)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int \sec(x) \tan(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 33 -->
        <exercise label="ex-int-by-parts-evaluate-29">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-29">
            <pg-code>
              $F = FormulaUpToConstant("x*sec(x)-ln(abs(sec(x)+tan(x)))");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\sec(x) \tan(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 34 -->
        <exercise label="ex-int-by-parts-evaluate-30">
          <webwork xml:id="webwork-ex-int-by-parts-evaluate-30">
            <pg-code>
              $F = FormulaUpToConstant("-x*csc(x)-ln(abs(csc(x)+cot(x)))");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int x\csc(x) \cot(x) \, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-int-by-parts-sub-first">
        <introduction>
          <p>
            Evaluate the indefinite integral after first making a substitution.
          </p>
        </introduction>
        <!-- Exercise 35 -->
        <exercise label="ex-int-by-parts-sub-first-1">
          <webwork xml:id="webwork-ex-int-by-parts-sub-first-1">
            <pg-code>
              $trig = list_random('sin','cos');
              if($envir{problemSeed}==1){$trig = 'sin';};
              $f = Formula("$trig(ln(x))");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
              $F = FormulaUpToConstant("x/2*(sin(ln(x)) - cos(ln(x)))");
              $F = FormulaUpToConstant("x/2*(sin(ln(x)) + cos(ln(x)))") if ($trig eq 'cos');
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 36 -->
        <exercise label="ex-int-by-parts-sub-first-2">
          <webwork xml:id="webwork-ex-int-by-parts-sub-first-2">
            <pg-code>
              $trig = list_random('sin','cos');
              if($envir{problemSeed}==1){$trig = 'cos';};
              $f = Formula("e^(2x) $trig(e^x)");
              $F = FormulaUpToConstant("cos(e^x)+(e^x)*sin(e^x)");
              $F = FormulaUpToConstant("sin(e^x)-(e^x)*cos(e^x)") if ($trig eq 'sin');
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 37 -->
        <exercise label="ex-int-by-parts-sub-first-3">
          <webwork xml:id="webwork-ex-int-by-parts-sub-first-3">
            <pg-code>
              $trig = list_random('sin','cos');
              if($envir{problemSeed}==1){$trig = 'sin';};
              $f = Formula("$trig(sqrt(x))");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
              $F = FormulaUpToConstant("2*sin(sqrt(x)) - 2*sqrt(x)*cos(sqrt(x))");
              $F = FormulaUpToConstant("2*cos(sqrt(x)) + 2*sqrt(x)*sin(sqrt(x))") if ($trig eq 'cos');
            </pg-code>
            <statement>
              <p>
                <m>\ds \int <var name="$f"/>\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 38 -->
        <exercise label="ex-int-by-parts-sub-first-4">
          <webwork xml:id="webwork-ex-int-by-parts-sub-first-4">
            <pg-code>
              $F = FormulaUpToConstant("x ln(sqrt(x)) - x/2");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
            </pg-code>
            <statement>
              <p>
                <m>\ds \int \ln(\sqrt{x})\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 39 -->
        <exercise label="ex-int-by-parts-sub-first-5">
          <webwork xml:id="webwork-ex-int-by-parts-sub-first-5">
            <pg-code>
              $F = FormulaUpToConstant("2*sqrt(x)*e^sqrt(x)-2*e^sqrt(x)");
              Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
            </pg-code>
            <statement>
              <p>
                <m>\ds \int e^{\sqrt{x}}\, dx</m>
              </p>
              <p>
                <var name="$F" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 40 -->
        <exercise label="ex-int-by-parts-sub-first-6">
          <webwork xml:id="webwork-ex-int-by-parts-sub-first-6">
              <pg-code>
                $F = FormulaUpToConstant("x^2/2");
                Context()-&gt;variables-&gt;set(x=&gt;{limits=&gt;[0,4]});
              </pg-code>
              <statement>
                <p>
                  <m>\ds \int e^{\ln(x) }\, dx</m>
                </p>
                <p>
                  <var name="$F" width="40"/>
                </p>
              </statement>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-int-by-parts-definite">
        <introduction>
          <p>
            Evaluate the definite integral.
            Note: the corresponding indefinite integral appears in
            <xref first="ibp_prob_5" last="ibp_prob_13" text="local">Exercises</xref>.
          </p>
        </introduction>
        <!-- Exercise 41 -->
        <exercise label="ex-int-by-parts-definite-1">
          <webwork xml:id="webwork-ex-int-by-parts-definite-1">
            <pg-code>
              $b = list_random('\pi/2','\pi','3\pi/2','2\pi');
              if($envir{problemSeed}==1){$b = '\pi';};
              $F = Formula("sin(x)-x*cos(x)");
              %r = ('\pi/2'=&gt;'1','\pi'=&gt;'pi','3\pi/2'=&gt;'-1','2\pi'=&gt;'-2pi');
              $r = Compute($r{$b});
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_0^{<var name="$b"/>} x\sin(x) \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 42 -->
        <exercise label="ex-int-by-parts-definite-2">
          <webwork xml:id="webwork-ex-int-by-parts-definite-2">
            <pg-code>
              ($a,$b) = num_sort((-2,-1,1,2)[NchooseK(4,2)]);
              if($envir{problemSeed}==1){$a=-1;$b=1;};
              $f = Formula("x e^(-x)");
              $F = Formula("-e^(-x)*(x+1)");
              $r = Formula("-($b+1)e^(-$b)+($a+1)e^(-$a)")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 43 -->
        <exercise label="ex-int-by-parts-definite-3">
          <webwork xml:id="webwork-ex-int-by-parts-definite-3">
            <pg-code>
              $b = list_random('\pi/6','\pi/4','\pi/3','\pi/2');
              if($envir{problemSeed}==1){$b='\pi/4';};
              $a = '-'.$b;
              $f = Formula("x^2 sin(x)");
              $F = Formula("-x^2*cos(x)+2x*sin(x)+2*cos(x)");
              $r = Formula("0")-&gt;reduce;
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 44 -->
        <exercise label="ex-int-by-parts-definite-4">
          <webwork xml:id="webwork-ex-int-by-parts-definite-4">
            <pg-code>
              $b = list_random('\pi/6','\pi/4','\pi/3','\pi/2');
              if($envir{problemSeed}==1){$b='\pi/2';};
              $a = '-'.$b;
              $f = Formula("x^3 sin(x)");
              $F = Formula("-x^3*cos(x)+3x^2*sin(x)+6x*cos(x)-6*sin(x)");
              $r = Formula("-pi^3/(32sqrt(2))+3pi^2/(8sqrt(2))+3pi/sqrt(2)-12/sqrt(2)")-&gt;reduce;
              $r = Formula("-pi^3sqrt(3)/216+pi^2/12+pi sqrt(3)-6")-&gt;reduce if ($b eq '\pi/6');
              $r = Formula("-pi^3/27+pi^2sqrt(3)/3+2pi-6*sqrt(3)")-&gt;reduce if ($b eq '\pi/3');
              $r = Formula("3pi^2/2-12")-&gt;reduce if ($b eq '\pi/2');
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 45 -->
        <exercise label="ex-int-by-parts-definite-5">
          <webwork xml:id="webwork-ex-int-by-parts-definite-5">
            <pg-code>
              $c = random(2,9,1);
              if($envir{problemSeed}==1){$c=2;};
              $a = 0;
              Context()-&gt;flags-&gt;set(reduceConstantFunctions=&gt;0);
              $b = Formula("sqrt(ln(2))");
              $f = Formula("x e^(x^2)");
              $F = Formula("1/2*e^(x^2)");
              Context("Fraction");
              $r = Fraction($c/2-1/2);
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 46 -->
        <exercise label="ex-int-by-parts-definite-6">
          <webwork xml:id="webwork-ex-int-by-parts-definite-6">
            <pg-code>
              $a = 0;
              $b = 1;
              $F = Formula("x^3*e^x-3*x^2*e^x+6*x*e^x-6*e^x");
              $r = $F-&gt;eval(x=&gt;$b) - $F-&gt;eval(x=&gt;$a);
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_0^1 x^3e^{x}\, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 47 -->
        <exercise label="ex-int-by-parts-definite-7">
          <webwork xml:id="webwork-ex-int-by-parts-definite-7">
            <pg-code>
              ($a,$b) = num_sort((1..4)[NchooseK(4,2)]);
              if($envir{problemSeed}==1){$a=1;$b=2};
              $f = Formula("x e^(-2x)");
              $F = Formula("(-x/2-1/4) e^(-2x)");
              Context("Fraction");
              $fracb = Fraction(-$b/2-1/4);
              $fraca = Fraction(-$a/2-1/4);
              $b2 = 2*$b;
              $a2 = 2*$a;
              $r = Formula("$fracb e^(-$b2) - $fraca e^(-$a2)");
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 48 -->
        <exercise label="ex-int-by-parts-definite-8">
          <webwork xml:id="webwork-ex-int-by-parts-definite-8">
            <pg-code>
              $b = list_random('\pi/2','\pi','3\pi/2','2\pi');
              if($envir{problemSeed}==1){$b='\pi'};
              $a=0;
              $f = Formula("e^x sin(x)");
              $F = Formula("1/2*e^x*(sin(x)-cos(x))");
              $r = Formula("1/2*e^(pi/2) + 1/2");
              $r = Formula("1/2*e^pi + 1/2") if ($b eq '\pi');
              $r = Formula("-1/2*e^(3pi/2) + 1/2") if ($b eq '3\pi/2');
              $r = Formula("-1/2*e^(2pi) + 1/2") if ($b eq '2\pi');
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
        <!-- Exercise 49 -->
        <exercise label="ex-int-by-parts-definite-9">
          <webwork xml:id="webwork-ex-int-by-parts-definite-9">
            <pg-code>
              $b = list_random('\pi/2','\pi','3\pi/2','2\pi');
              if($envir{problemSeed}==1){$b='\pi/2'};
              $a='-'.$b;
              $f = Formula("e^(2x) cos(x)");
              $F = Formula("1/5*e^(2x)*(sin(x)+2*cos(x))");
              $r = Formula("1/5 (e^(pi) + e^(-pi))");
              $r = Formula("2/5 (-e^(2pi) + e^(-2pi))") if ($b eq '\pi');
              $r = Formula("1/5 (-e^(3pi) - e^(-3pi))") if ($b eq '3\pi/2');
              $r = Formula("2/5 (e^(4pi) - e^(-4pi))") if ($b eq '2\pi');
            </pg-code>
            <statement>
              <p>
                <m>\ds \int_{<var name="$a"/>}^{<var name="$b"/>} <var name="$f"/> \, dx</m>
              </p>
              <p>
                <var name="$r" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>
    </subexercises>
  </exercises>
</section>
