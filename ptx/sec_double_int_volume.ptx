<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_double_int_volume" label="sec_double_int_volume">
  <title>Double Integration and Volume</title>
  <p>
    The definite integral of <m>f</m> over <m>[a,b]</m>, <m>\int_a^b f(x)\, dx</m>,
    was introduced as <q>the signed area under the curve.</q>
    We approximated the value of this area by first subdividing <m>[a,b]</m> into <m>n</m> subintervals,
    where the <m>i</m>th subinterval has length <m>\dx_i</m>,
    and letting <m>c_i</m> be any value in the <m>i</m>th subinterval.
    We formed rectangles that approximated part of the region under the curve with width <m>\dx_i</m>,
    height <m>f(c_i)</m>, and hence with area <m>f(c_i)\dx_i</m>.
    Summing all the rectangle's areas gave an approximation of the definite integral,
    and <xref ref="thm_riemann_sum"/> stated that
    <me>
      \int_a^bf(x)\, dx = \lim_{\norm{\Delta x}\to 0}\sum f(c_i)\dx_i
    </me>,
    connecting the area under the curve with sums of the areas of rectangles.
  </p>

  <p>
    We use a similar approach in this section to find volume under a surface.
  </p>

  <figure xml:id="vid-multint-double-intro" component="video" vshift="0">
    <caption>Introducing the double integral</caption>
    <video youtube="5FpKcnG-5vY" label="vid-multint-double-intro"/>
  </figure>

  <p>
    Let <m>R</m> be a closed,
    bounded region in the <m>xy</m>-plane and let
    <m>z=f(x,y)</m> be a continuous function defined on <m>R</m>.
    We wish to find the signed volume under the graph of <m>f</m> over <m>R</m>.
    (We use the term <q>signed volume</q>
    to denote that space above the <m>xy</m>-plane,
    under <m>f</m>, will have a positive volume;
    space above <m>f</m> and under the <m>xy</m>-plane will have a
    <q>negative</q> volume,
    similar to the notion of signed area used before.)
  </p>

  <p>
    We start by partitioning <m>R</m> into <m>n</m> rectangular subregions as shown in <xref ref="fig_double_introa"/>.
    For simplicity's sake,
    we let all widths be <m>\dx</m> and all heights be <m>\dy</m>.
    Note that the sum of the areas of the rectangles is not equal to the area of <m>R</m>,
    but rather is a close approximation.
    Arbitrarily number the rectangles 1 through <m>n</m>,
    and pick a point <m>(x_i,y_i)</m> in the <m>i</m>th subregion.
  </p>

  <figure xml:id="fig_double_intro">
    <caption>Developing a method for finding signed volume under a surface</caption>
    <sidebyside widths="47% 47%" valign="bottom" margins="0%">
      <figure xml:id="fig_double_introa">
        <caption/>
        <!-- START figures/fig_double_intro1.tex -->
        <image>
          <shortdescription>An illustration of the partition of a plane region into small rectangles.</shortdescription>
          <description>
            <p>
              A region in the plane is plotted against <m>x</m> and <m>y</m> coordinate axes.
              <ul>
                <li>
                  <p>
                    The region is symmetric about the <m>x</m> axis,
                    and extends from the origin to the point <m>(2,0)</m>.
                  </p>
                </li>
                <li>
                  <p>
                    It is close to a circle in shape, but it is not a true circle:
                    it is more egg-like, being more sharply curved near the origin.
                  </p>
                </li>
                <li>
                  <p>
                    The precise shape is not that important in this context.
                  </p>
                </li>
              </ul>
            </p>

            <p>
              A grid of small rectangles is drawn over the region,
              to illustrate how it can be approximated by subdividing it into rectangles.
            </p>
          </description>
          <latex-image label="img_double_introa">

          \begin{tikzpicture}

          \begin{axis}[
          axis on top,
          ymin=-.85,ymax=.85,
          xmin=-.3,xmax=2.2
          ]

          \addplot+ [domain=-90:90,samples=80] ({cos(x)*(1+cos(2*x))},{sin(x)*(1+cos(2*x))});

          \draw (axis cs: 0,-.3) -- (axis cs:0,.3)
                (axis cs: .2,-.4) -- (axis cs:.2,.4)
                (axis cs: 0.4,-.6) -- (axis cs:.4,.6)
                (axis cs: 0.6,-.7) -- (axis cs:.6,.7)
                (axis cs: .8,-.8) -- (axis cs:.8,.8)
                (axis cs: 1,-.8) -- (axis cs:1,.8)
                (axis cs: 1.2,-.8) -- (axis cs:1.2,.8)
                (axis cs: 1.4,-.8) -- (axis cs:1.4,.8)
                (axis cs: 1.6,-.7) -- (axis cs:1.6,.7)
                (axis cs: 1.8,-.6) -- (axis cs:1.8,.6)
                (axis cs: 2,-.4) -- (axis cs:2,.4);

          \draw (axis cs: .8,.8) -- (axis cs:1.4,.8)
              (axis cs: .6,.7) -- (axis cs:1.6,.7)
              (axis cs: .4,.6) -- (axis cs:1.8,.6)
              (axis cs: .4,.5) -- (axis cs:1.8,.5)
              (axis cs: .2,.4) -- (axis cs:2,.4)
              (axis cs: 0,.3) -- (axis cs:2,.3)
              (axis cs: 0,.2) -- (axis cs:2,.2)
              (axis cs: 0,.1) -- (axis cs:2,.1)
              (axis cs: .8,-.8) -- (axis cs:1.4,-.8)
              (axis cs: .6,-.7) -- (axis cs:1.6,-.7)
              (axis cs: .4,-.6) -- (axis cs:1.8,-.6)
              (axis cs: .4,-.5) -- (axis cs:1.8,-.5)
              (axis cs: .2,-.4) -- (axis cs:2,-.4)
              (axis cs: 0,-.3) -- (axis cs:2,-.3)
              (axis cs: 0,-.2) -- (axis cs:2,-.2)
              (axis cs: 0,-.1) -- (axis cs:2,-.1);

          \end{axis}

          \end{tikzpicture}

          </latex-image>
        </image>
      <!-- figures/fig_double_intro1.tex END -->
      </figure>

      <figure xml:id="fig_double_introb_3d">
        <caption/>

        <!-- START figures/figdouble_intro2_3D.asy -->
        <image>
          <shortdescription>A surface in three dimensions lies over a partitioned region in the xy plane. A rectangular prism extends from one rectangle to the surface.</shortdescription>
          <description>
            <p>
              A surface is plotted in space, against three-dimensional coordinate axes.
              In the <m>xy</m> plane, there is a copy of the region from <xref ref="fig_double_introa"/>,
              including a rendering of the rectangular grid representing the partition of the region into small rectangles.
            </p>

            <p>
              The surface lies above the <m>xy</m> plane.
              On the surface, we can see a curve that corresponds to the boundary of the region in the <m>xy</m> plane.
              The grid lines on the surface also appear to correspond to the partition of the region below the surface.
            </p>

            <p>
              Over one of the small rectangles in the <m>xy</m> plane,
              there is a rectangular box. The base of the box is the rectangle in the plane.
              The box extends upward to the surface, 
              with its height equal to the <m>z</m> coordinate on the surface at one point in the rectangle.
            </p>
          </description>
          <asymptote label="img_double_introb_3D">



            //ASY file for figdouble_intro23D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(7.5,3.1,3);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={2};
            real[] myychoice={-1,1};
            real[] myzchoice={2};
            defaultpen(0.5mm);

            pair xbounds=(-1,2.5);
            pair ybounds=(-1.25,1.25);
            pair zbounds=(0,2.25);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=-.5*(x-1)^2-.5*(y)^2+2};
            triple f(pair t) {
              return (t.x,t.y,-.5*(t.x-1)^2-.5*(t.y)^2+2);
            }
            surface s=surface(f,(-0.221,-1),(2.2,1),12,20,vsplinetype=new splinetype[] {notaknot,notaknot,monotonic},usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            pen pp=linewidth(.25mm);
            //draw the grid in the xy-plane
            //along fixed x
            draw((0,-.3,0) -- (0,.3,0),pp);
            draw((.2,-.4,0) -- (.2,.4,0),pp);
            draw((0.4,-.6,0) -- (.4,.6,0),pp);
            draw((0.6,-.7,0) -- (.6,.7,0),pp);
            draw((.8,-.8,0) -- (.8,.8,0),pp);
            draw((1,-.8,0) -- (1,.8,0),pp);
            draw((1.2,-.8,0) -- (1.2,.8,0),pp);
            draw((1.4,-.8,0) -- (1.4,.8,0),pp);
            draw((1.6,-.7,0) -- (1.6,.7,0),pp);
            draw((1.8,-.6,0) -- (1.8,.6,0),pp);
            draw((2,-.4,0) -- (2,.4,0),pp);
            //along fixed y
            draw((.8,.8,0) -- (1.4,.8,0),pp);
            draw((.6,.7,0) -- (1.6,.7,0),pp);
            draw((.4,.6,0) -- (1.8,.6,0),pp);
            draw((.4,.5,0) -- (1.8,.5,0),pp);
            draw((.2,.4,0) -- (2,.4,0),pp);
            draw((0,.3,0) -- (2,.3,0),pp);
            draw((0,.2,0) -- (2,.2,0),pp);
            draw((0,.1,0) -- (2,.1,0),pp);
            draw((.8,-.8,0) -- (1.4,-.8,0),pp);
            draw((.6,-.7,0) -- (1.6,-.7,0),pp);
            draw((.4,-.6,0) -- (1.8,-.6,0),pp);
            draw((.4,-.5,0) -- (1.8,-.5,0),pp);
            draw((.2,-.4,0) -- (2,-.4,0),pp);
            draw((0,-.3,0) -- (2,-.3,0),pp);
            draw((0,-.2,0) -- (2,-.2,0),pp);
            draw((0,-.1,0) -- (2,-.1,0),pp);

            //Draw curve on top of the grid in xy plane ({cos(x)*(1+cos(2*x))},{sin(x)*(1+cos(2*x))},0);
            triple g(real t) {return (cos(t)*(1+cos(2*t)),sin(t)*(1+cos(2*t)),0);}
            path3 mypath=graph(g,-pi/2,pi/2,operator ..);
            draw(mypath,bluepen);

            // draw curve on surface
            triple g(real t) {
              return (cos(t)*(1+cos(2*t)),sin(t)*(1+cos(2*t)),-.5*(cos(t)*(1+cos(2*t))-1)^2-.5*(sin(t)*(1+cos(2*t)))^2+2);
            }
            path3 mypath=graph(g,-pi/2,pi/2,operator ..);
            draw(mypath,bluepen);

            //surface s=surface(f,(-pi/2,0),(pi/2,2*pi),8,8,Spline);
            //pen p=apexmeshpen;
            //draw(s,surfacepen,bluepen+linewidth(2));
            //path3 mypath=graph(g,0,32.5,operator ..); draw(mypath,bluepen);

            //Draw the top of the column on the surface
            //draw((1.6,0.3,1.865)--(1.8,.3,1.725),bluepen+linewidth(2));
            //draw((1.8,0.3,1.7)--(1.8,.4,1.7),bluepen+linewidth(2));
            //draw((1.8,0.4,1.7)--(1.6,.4,1.7),bluepen+linewidth(2));
            //draw((1.6,0.4,1.7)--(1.6,.3,1.7),bluepen+linewidth(2));
            draw((1.6,.3,1.775) -- (1.6,.4,1.74) -- (1.8,.4,1.6) -- (1.8,.3,1.635) --cycle,bluepen+.4mm);

            //Draw the rectangular column
            //base
            draw((1.6,0.3,0)--(1.8,.3,0)--(1.8,.4,0)--(1.6,.4,0)--cycle,redpen+.4mm);

            //  //verticals plotted to average of 4 function heights
            //draw((1.6,0.3,0)--(1.6,.3,1.7),redpen+.4mm);//base
            //draw((1.8,0.3,0)--(1.8,.3,1.7),redpen+.4mm);//base
            //draw((1.8,0.4,0)--(1.8,.4,1.7),redpen+.4mm);//base
            //draw((1.6,0.4,0)--(1.6,.4,1.7),redpen+.4mm);//base
            //top
            draw((1.6,0.3,1.7)--(1.8,.3,1.7)--(1.8,.4,1.7)--(1.6,.4,1.7)--cycle,redpen);

            pen q=redcurvepen+.4mm;
            //  draw(ss,surfacepen2,meshpen=q,nolight,render(merge=true));
            //   emissive(redpen+opacity(0.7))

            //Shade the column now
            //import three;

            path3 p =  (1.6,0.3,0)--(1.8,.3,0) -- (1.8,0.3,1.7)--(1.6,.3,1.7); //Left
            draw(surface(p -- cycle),surfacepen2,meshpen=q,nolight,render(merge=true));
            path3 p =  (1.6,0.3,1.7)--(1.8,.3,1.7)--(1.8,.4,1.7)--(1.6,.4,1.7); //top
            draw(surface(p -- cycle),surfacepen2,meshpen=q,nolight,render(merge=true));
            //draw(surface(p -- cycle), emissive(redpen+opacity(0.7)));
            path3 p =  (1.6,0.4,0)--(1.8,.4,0) -- (1.8,0.4,1.7)--(1.6,.4,1.7); //right
            draw(surface(p -- cycle),surfacepen2,meshpen=q,nolight,render(merge=true));
            //draw(surface(p -- cycle), emissive(redpen+opacity(0.7)));
            path3 p =  (1.6,0.3,0)--(1.6,.4,0) -- (1.6,0.4,1.7)--(1.6,.3,1.7); //back
            draw(surface(p -- cycle),surfacepen2,meshpen=q,nolight,render(merge=true));
            //draw(surface(p -- cycle), emissive(redpen+opacity(0.7)));
            path3 p =  (1.8,0.3,0)--(1.8,.4,0) -- (1.8,0.4,1.7)--(1.8,.3,1.7); //front
            draw(surface(p -- cycle),surfacepen2,meshpen=q,nolight,render(merge=true));
            //draw(surface(p -- cycle), emissive(redpen+opacity(0.7)));
            path3 p =  (1.6,0.3,0)--(1.8,.3,0)--(1.8,.4,0)--(1.6,.4,0); //bottom
            draw(surface(p -- cycle),surfacepen2,meshpen=q,nolight,render(merge=true));
            //draw(surface(p -- cycle), emissive(redpen+opacity(0.7)));

          </asymptote>
        </image>
      <!-- figures/figdouble_intro2_3D.asy END -->
      </figure>
    </sidebyside>

  </figure>

  <p>
    The volume of the rectangular solid whose base is the
    <m>i</m>th subregion and whose height is
    <m>f(x_i,y_i)</m> is <m>V_i=f(x_i,y_i)\dx\dy</m>.
    Such a solid is shown in <xref ref="fig_double_introb_3d"/>.
    Note how this rectangular solid only approximates the true volume under the surface;
    part of the solid is above the surface and part is below.
  </p>

  <p>
    For each subregion <m>R_i</m> used to approximate <m>R</m>,
    create the rectangular solid with base area <m>\dx\dy</m> and height <m>f(x_i,y_i)</m>.
    The sum of all rectangular solids is
    <me>
      \ds \sum_{i=1}^n f(x_i,y_i)\dx\dy
    </me>.
  </p>

  <p>
    This approximates the signed volume under <m>f</m> over <m>R</m>.
    As we have done before,
    to get a better approximation we can use more rectangles to approximate the region <m>R</m>.
  </p>

  <p>
    In general, each rectangle could have a different width <m>\dx_j</m> and height <m>\dy_k</m>,
    giving the <m>i</m>th rectangle an area <m>\Delta A_i = \dx_j\dy_k</m> and the
    <m>i</m>th rectangular solid a volume of <m>f(x_i,y_i)\Delta A_i</m>.
    Let <m>\norm{\Delta A}</m> denote the length of the longest diagonal of all rectangles in the subdivision of <m>R</m>;
    <m>\norm{\Delta A}\to 0</m> means each rectangle's width and height are both approaching 0.
    If <m>f</m> is a continuous function,
    as <m>\norm{\Delta A}</m> shrinks
    (and hence <m>n\to\infty</m>)
    the summation <m>\ds \sum_{i=1}^n f(x_i,y_i)\Delta A_i</m> approximates the signed volume better and better.
    This leads to a definition.
  </p>

  <aside xml:id="note_doubleint" vshift="-1.5">
    <title>Double integrals as limits of double sums</title>

    <p>
      Recall that the integration symbol
      <q><m>\int</m></q> is an <q>elongated S,</q>
      representing the word <q>sum.</q>
      We interpreted <m>\int_a^bf(x)\, dx</m> as <q>take the
      <em>sum</em> of the areas of rectangles over the interval <m>[a,b]</m>.</q>
      The double integral uses two integration symbols to represent a <q>double sum.</q>
      When adding up the volumes of rectangular solids over a partition of a region <m>R</m>,
      as done in <xref ref="fig_double_intro"/>,
      one could first add up the volumes across each row
      (one type of sum),
      then add these totals together
      (another sum),
      as in
      <me>
        \sum_{j=1}^n\sum_{i=1}^mf(x_i,y_j)\Delta x_i\Delta y_j
      </me>.
    </p>

    <p>
      One can rewrite this as
      <me>
        \sum_{j=1}^n\left(\sum_{i=1}^mf(x_i,y_j)\Delta x_i\right)\Delta y_j
      </me>.
    </p>

    <p>
      The summation inside the parenthesis indicates the sum of heights <times/> widths,
      which gives an area;
      multiplying these areas by the thickness <m>\Delta y_j</m> gives a volume.
      The illustration in <xref ref="fig_double_intro3"/>
      relates to this understanding.
    </p>
  </aside>

  <definition xml:id="def_double_int">
    <title>Double Integral, Signed Volume</title>
    <statement>
      <p>
        Let <m>z=f(x,y)</m> be a continuous function defined over a closed,
        bounded region <m>R</m> in the <m>xy</m>-plane.
        The <term>signed volume</term> <m>V</m> under <m>f</m> over <m>R</m> is denoted by the
        <term>double integral</term>
        <me>
          V = \iint_R f(x,y)\, dA
        </me>.
      </p>

      <p>
        Alternate notations for the double integral are
            <idx><h>integration</h><h>double</h></idx>
            <idx><h>double integral</h></idx>
            <idx><h>iterated integration</h></idx>
            <idx><h>signed volume</h></idx>
            <idx><h>volume</h></idx>
        <me>
          \iint_R f(x,y)\, dA=\iint_R f(x,y)\, dx\, dy=\iint_R f(x,y)\, dy\, dx
        </me>.
      </p>
    </statement>
  </definition>

  <figure xml:id="vid-multint-double-def" component="video" vshift="-5.5">
    <caption>Defining the double integral</caption>
    <video youtube="l7hGaXcsq9g" label="vid-multint-double-def"/>
  </figure>

  <p>
    <xref ref="def_double_int"/> does not state how to find the signed volume,
    though the notation offers a hint.
    We need the next two theorems to evaluate double integrals to find volume.
  </p>

  <theorem xml:id="thm_double_int">
    <title>Double Integrals and Signed Volume</title>
    <statement>
      <p>
        Let <m>z=f(x,y)</m> be a continuous function defined over a closed , bounded region <m>R</m> in the <m>xy</m>-plane.
        Then the signed volume <m>V</m> under <m>f</m> over <m>R</m> is
        <me>
          V = \iint_R f(x,y)\, dA = \lim_{\norm{\Delta A}\to 0}\sum_{i=1}^n f(x_i,y_i)\Delta A_i
        </me>.
      </p>
    </statement>
  </theorem>

  <p>
    This theorem states that we can find the exact signed volume using a limit of sums.
    The partition of the region <m>R</m> is not specified,
    so any partitioning where the diagonal of each rectangle shrinks to 0 results in the same answer.
  </p>

  <p>
    This does not offer a very satisfying way of computing volume, though.
    Our experience has shown that evaluating the limits of sums can be tedious.
    We seek a more direct method.
  </p>

  <p>
    Recall <xref ref="thm_volume_by_cross_section"/>
    in <xref ref="sec_disk"/>.
    This stated that if <m>A(x)</m> gives the cross-sectional area of a solid at <m>x</m>,
    then <m>\int_a^b A(x)\, dx</m> gave the volume of that solid over <m>[a,b]</m>.
  </p>

  <p>
    Consider <xref ref="fig_double_intro3"/>,
    where a surface <m>z=f(x,y)</m> is drawn over a region <m>R</m>.
    Fixing a particular <m>x</m> value,
    we can consider the area under <m>f</m> over <m>R</m> where <m>x</m> has that fixed value.
    That area can be found with a definite integral, namely
    <me>
      A(x)=\int_{g_1(x)}^{g_2(x)} f(x,y)\, dy
    </me>.
  </p>

  <p>
    Remember that though the integrand contains <m>x</m>,
    we are viewing <m>x</m> as fixed.
    Also note that the bounds of integration are functions of <m>x</m>:
    the bounds depend on the value of <m>x</m>.
  </p>

  <figure xml:id="fig_double_intro3" vshift="1.5">
    <caption>Finding volume under a surface by sweeping out a cross-sectional area</caption>

    <!-- START figures/figdouble_intro3_3D.asy -->
    <image width="47%">
      <shortdescription>A parabolic surface in space is intersected by a plane of constant x value.</shortdescription>
      <description>
        <p>
          The plot begins with a set of three-dimensional coordinate axes.
          In the <m>xy</m> plane, there is a curve that appears to be a circle of radius 1, centered at <m>(1,0,0)</m>.
        </p>

        <p>
          The circle is the boundary of a region <m>R</m>.
          Above this region, there is a surface; the surface has the shape of a downward-opening circular paraboloid.
        </p>

        <p>
          A portion of a vertical plane is also drawn.
          The plane corresponds to a fixed value of <m>x</m>, and extends in the <m>y</m> direction across the circle.
          The plane is shown extending upward to the surface, which it intersects along a curve.
          We can think of this portion of the plane as a <q>slice</q> of the solid that lies below the paraboloid and above the circle.
        </p>
      </description>
      <asymptote label="img_double_intro3">



        //ASY file for figdouble_intro23D.asy in Chapter 13

        size(200,200,IgnoreAspect);
        //currentprojection=perspective(7,2,1);
        currentprojection=orthographic(5,5.5,1.8);
        defaultrender.merge=true;

        // setup and draw the axes
        real[] myxchoice={2};
        real[] myychoice={-1,1};
        real[] myzchoice={2};
        defaultpen(0.5mm);

        pair xbounds=(-1,2.5);
        pair ybounds=(-1.25,1.25);
        pair zbounds=(0,2.25);

        xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
        yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
        zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

        label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
        label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
        label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

        //Create a shaded slice

        pen q=redcurvepen+.4mm;
        path3 p =  (1.6,-0.65,0)--(1.6,0.65,0) -- (1.6,0.65,1.65)..(1.6,0,1.8)..(1.6,-0.65,1.65)--cycle;
        draw(surface(p), surfacepen2,meshpen=invisible,nolight,render(merge=true));
        draw(p,q);

        //Draw the surface//{z=-.5*(x-1)^2-.5*(y)^2+2};
        triple f(pair t) {
          return (t.x,t.y,-.5*(t.x-1)^2-.5*(t.y)^2+2);
        }
        surface s=surface(f,(-0.221,-1),(2.2,1),12,20,vsplinetype=new splinetype[] {notaknot,notaknot,monotonic},usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
        pen p=apexmeshpen;
        draw(s,surfacepen,meshpen=p);

        //Draw curve in xy plane ({cos(x)*(1+cos(2*x))},{sin(x)*(1+cos(2*x))},0);
        triple g(real t) {return (cos(t)*(1+cos(2*t)),sin(t)*(1+cos(2*t)),0);}
        path3 mypath=graph(g,-pi/2,pi/2,operator ..);
        draw(mypath,.4mm+bluepen);
        label("$R$",(0.5,0.6,0),E);

        //Draw curve on the surface //{z=-.5*(cos(t)*(1+cos(2*t))-1)^2-.5*(sin(t)*(1+cos(2*t)))^2+2};
        triple gg(real t) {
          return (cos(t)*(1+cos(2*t)),sin(t)*(1+cos(2*t)),-.5*(cos(t)*(1+cos(2*t))-1)^2-.5*(sin(t)*(1+cos(2*t)))^2+2);
        }
        path3 mypath=graph(gg,-pi/2,pi/2,operator ..);
        draw(mypath,.4mm+bluepen);

        //draw the edge in thick red  pen q=redcurvepen+.4mm;
        //draw((1.6,-0.65,0)--(1.6,0.65,0)--(1.6,0.65,1.625)..(1.6,0,1.825)..(1.6,-0.65,1.625)--(1.6,-0.65,0),redcurvepen+.4mm);

      </asymptote>
    </image>
    <!-- figures/figdouble_intro3_3D.asy END -->
  </figure>

  <p>
    As <m>A(x)</m> is a cross-sectional area function,
    we can find the signed volume <m>V</m> under <m>f</m> by integrating it:
    <me>
      V = \int_a^b A(x)\, dx = \int_a^b\left(\int_{g_1(x)}^{g_2(x)} f(x,y)\, dy\right)dx = \int_a^b\int_{g_1(x)}^{g_2(x)} f(x,y)\, dy\, dx
    </me>.
  </p>

  <p>
    This gives a concrete method for finding signed volume under a surface.
    We could do a similar procedure where we started with <m>y</m> fixed,
    resulting in an iterated integral with the order of integration <m>dx\, dy</m>.
    The following theorem states that both methods give the same result,
    which is the value of the double integral.
    It is such an important theorem it has a name associated with it.
  </p>

  <theorem xml:id="thm_fubini">
    <title>Fubini's Theorem</title>
    <statement>
      <p>
        Let <m>R</m> be a closed,
        bounded region in the <m>xy</m>-plane and let
        <m>z=f(x,y)</m> be a continuous function on <m>R</m>.
            <idx><h>double integral</h></idx>
            <idx><h>iterated integration</h></idx>
            <idx><h>signed volume</h></idx>
            <idx><h>volume</h></idx>
            <idx><h>Fubini's Theorem</h></idx>
      </p>

      <p>
        <ol>
          <li>
            <p>
              If <m>R</m> is bounded by <m>a\leq x\leq b</m> and <m>g_1(x)\leq y\leq g_2(x)</m>,
              where <m>g_1</m> and <m>g_2</m> are continuous functions on <m>[a,b]</m>, then
              <me>
                \iint_R f(x,y)\, dA = \int_a^b\int_{g_1(x)}^{g_2(x)} f(x,y)\, dy\, dx
              </me>.
            </p>
          </li>

          <li>
            <p>
              If <m>R</m> is bounded by <m>c\leq y\leq d</m> and <m>h_1(y)\leq x\leq h_2(y)</m>,
              where <m>h_1</m> and <m>h_2</m> are continuous functions on <m>[c,d]</m>, then
              <me>
                \iint_R f(x,y)\, dA = \int_c^d\int_{h_1(y)}^{h_2(y)} f(x,y)\, dx\, dy
              </me>.
            </p>
          </li>
        </ol>
      </p>
    </statement>
  </theorem>

  <p>
    Note that once again the bounds of integration follow the <q>curve to curve,
    point to point</q> pattern discussed in the previous section.
    In fact, one of the main points of the previous section is developing the skill of describing a region <m>R</m> with the bounds of an iterated integral.
    Once this skill is developed,
    we can use double integrals to compute many quantities,
    not just signed volume under a surface.
  </p>

  <figure xml:id="vid-multint-double-fubini" component="video" vshift="4">
    <caption>Fubini's Theorem and iterated integrals</caption>
    <video youtube="smdRuI_ztAw" label="vid-multint-double-fubini"/>
  </figure>

  <example xml:id="ex_double1">
    <title>Evaluating a double integral</title>
    <statement>
      <p>
        Let <m>f(x,y) = xy+e^y</m>.
        Find the signed volume under <m>f</m> on the region <m>R</m>,
        which is the rectangle with corners <m>(3,1)</m> and <m>(4,2)</m> pictured in <xref ref="fig_double1"/>,
        using Fubini's Theorem and both orders of integration.
      </p>
      <figure xml:id="fig_double1" vshift="0">
        <caption>Finding the signed volume under a surface in <xref ref="ex_double1"/></caption>

        <!-- START figures/figdouble1_3D.asy -->
        <image width="47%">
          <shortdescription>A ramp-like surface in space, with the portion over a rectangular domain highlighted.</shortdescription>
          <description>
            <p>
              The surface given by the graph of <m>f(x,y)=xy+e^y</m> has the appearance of a curved, twisted, and very steep ramp.
              Along the <m>x</m> axis we have the constant value <m>z=1</m>.
              For small, fixed values of <m>x</m>, the traces are exponential curves that increase with <m>y</m>.
              For larger values of <m>x</m>, the <m>xy</m> term contributes, and the rate of growth is larger.
            </p>

            <p>
              In the <m>xy</m> plane, a rectangular region <m>R</m> is shown.
              Dashed lines move upward from the boundary of this region to the surface.
              Along the surface, a corresponding rectangle-shaped curve is shown.
              The two rectangular curves, and the dashed lines between corresponding corners,
              illustrate the region whose volume is computed in this example.
            </p>
          </description>
          <asymptote label="img_double1">



            //ASY file for figdouble13D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(10,-8,25);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={1,2,3,4};
            real[] myychoice={1,2};
            real[] myzchoice={10};
            defaultpen(0.5mm);

            pair xbounds=(0,5);
            pair ybounds=(0,2.5);
            pair zbounds=(0,15);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=xy+e^y};
            triple f(pair t) {
              return (t.x,t.y,t.x*t.y+exp(t.y));
            }
            surface s=surface(f,(0,0),(4.25,2.25),12,20,Spline);
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            //Draw rectangle in plane
            draw((3,1,0)--(4,1,0)--(4,2,0)--(3,2,0)--(3,1,0),bluepen+linewidth(2));
            label("$R$",(3.5,1.5,0));

            //Draw rectangle on surface
            draw((3,1,3+exp(1))--(4,1,4+exp(1))..(4,1.5,6+exp(1.5))..(4,2,8+exp(2))--(3,2,6+exp(2))..(3,1.5,4.5+exp(1.5))..(3,1,3+exp(1)),bluepen+linewidth(2));

            //Draw vertical lines
            draw((3,1,0)--(3,1,3+exp(1)),bluepen+dashed+linewidth(0.75));
            draw((3,2,0)--(3,2,6+exp(2)),bluepen+dashed+linewidth(0.75));
            draw((4,1,0)--(4,1,4+exp(1)),bluepen+dashed+linewidth(0.75));
            draw((4,2,0)--(4,2,8+exp(2)),bluepen+dashed+linewidth(0.75));

          </asymptote>
        </image>
        <!-- figures/figdouble1_3D.asy END -->
      </figure>
    </statement>
    <solution>
      <p>
        We wish to evaluate <m>\iint_R \big(xy+e^y\big)\, dA</m>.
        As <m>R</m> is a rectangle,
        the bounds are easily described as
        <m>3\leq x\leq 4</m> and <m>1\leq y\leq 2</m>.
      </p>

      <p>
        Using the order <m>dy\, dx</m>:
        <md>
          <mrow>\iint_R\big(xy+e^y\big) \, dA \amp = \int_3^4\int_1^2\big(xy+e^y\big)\, dy \, dx</mrow>
          <mrow>\amp = \int_3^4 \left(\left.\left[\frac12xy^2+e^y\right]\right|_1^2\, \right) dx</mrow>
          <mrow>\amp = \int_3^4\left(\frac 32x + e^2-e\right)dx</mrow>
          <mrow>\amp = \left.\left(\frac 34x^2 + \big(e^2-e\big)x\right)\right|_3^4</mrow>
          <mrow>\amp = \frac {21}4+ e^2-e\approx 9.92</mrow>
        </md>.
      </p>

      <p>
        Now we check the validity of Fubini's Theorem by using the order <m>dx\, dy</m>:
        <md>
          <mrow>\iint_R\big(xy+e^y\big) \, dA \amp = \int_1^2\int_3^4\big(xy+e^y\big)\, dx \, dy</mrow>
          <mrow>\amp = \int_1^2\left(\left.\left[\frac12x^2y+xe^y\right]\right|_3^4\right)dy</mrow>
          <mrow>\amp = \int_1^2\left(\frac72y+e^y\right)\, dy</mrow>
          <mrow>\amp = \left.\left(\frac74y^2+e^y\right)\right|_1^2</mrow>
          <mrow>\amp =\frac{21}4+e^2-e\approx 9.92</mrow>
        </md>.
      </p>

      <p>
        Both orders of integration return the same result, as expected.
      </p>
    </solution>
  </example>

  <example xml:id="ex_double2">
    <title>Evaluating a double integral</title>
    <statement>
      <p>
        Evaluate <m>\iint_R \big(3xy-x^2-y^2+6\big)\, dA</m>,
        where <m>R</m> is the triangle bounded by <m>x=0</m>,
        <m>y=0</m> and <m>x/2+y=1</m>,
        as shown in <xref ref="fig_double2"/>.
      </p>
      <figure xml:id="fig_double2" vshift="0">
        <caption>Finding the signed volume under the surface in <xref ref="ex_double2"/></caption>

        <!-- START figures/figdouble2_3D.asy -->
        <image width="47%">
          <shortdescription>A surface in space, plotted over a triangular domain.</shortdescription>
          <description>
            <p>
              The graph <m>z = 3xy-x^2-y^2+6</m> is plotted in the first octant of a three-dimensional coordinate system.
              It appears to be a hyperbolic paraboloid,
              with slight upward curvature when viewed along the plane <m>y=1-x</m>,
              and a larger downward curvature when viewed along the plane <m>y=x</m>.
            </p>

            <p>
              In the <m>xy</m> plane, a triangular region is plotted.
              This region is bounded by the <m>x</m> and <m>y</m> axes,
              and a line segment running from <m>(2,0,0)</m> to <m>(0,1,0)</m>.
              There are also dashed, vertical lines running from these two points up to the surface.
            </p>

            <p>
              On the surface, there are curves corresponding to the three edges of the triangle in the <m>xy</m> plane.
              These curves illustrate the portion of the surface under which the solid whose volume we are finding lies.
              Each curve has the shape of a downward-opening parabola.
            </p>
          </description>
          <asymptote label="img_double2">



            //ASY file for figdouble23D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(1.6,-5.5,12.4);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={1,2,3,4};
            real[] myychoice={1};
            real[] myzchoice={2,4,6,8};
            defaultpen(0.5mm);

            pair xbounds=(0,2.5);
            pair ybounds=(0,1.5);
            pair zbounds=(0,9);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=3xy-x^2-y^2+6};
            triple f(pair t) {
              return (t.x,t.y,3*t.x*t.y-t.x^2-t.y^2+6);
            }
            surface s=surface(f,(-0.1,-0.1),(2.1,1.1),12,20,Spline);
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            //Draw triangle in plane
            draw((0,0,0)--(2,0,0)--(0,1,0)--(0,0,0),bluepen+linewidth(2));
            label("$R$",(0,0.5,0),E);

            //Draw triangle on surface
            triple g(real t) {return (t,0,6-t^2);}
            path3 mypath=graph(g,0,2,operator ..);
            draw(mypath,bluepen+linewidth(2));

            triple g(real t) {return (0,t,6-t^2);}
            path3 mypath=graph(g,0,1,operator ..);
            draw(mypath,bluepen+linewidth(2));

            triple g(real t) {return (2-2*t,t,3*(2-2*t)*(t)-(2-2*t)^2-(t)^2+6);}
            path3 mypath=graph(g,0,1,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw vertical lines
            draw((2,0,0)--(2,0,2),bluepen+dashed+linewidth(0.75));
            draw((0,1,0)--(0,1,5),bluepen+dashed+linewidth(0.75));

          </asymptote>
        </image>
        <!-- figures/figdouble2_3D.asy END -->
      </figure>
    </statement>
    <solution>
      <p>
        While it is not specified which order we are to use,
        we will evaluate the double integral using both orders to help drive home the point that it does not matter which order we use.
      </p>

      <p>
        Using the order <m>dy\, dx</m>:
        The bounds on <m>y</m> go from <q>curve to curve,</q>
        <ie/>, <m>0\leq y\leq 1-x/2</m>,
        and the bounds on <m>x</m> go from
        <q>point to point,</q> <ie/>, <m>0\leq x\leq 2</m>.
        <md>
          <mrow>\iint_R \big(3xy-x^2-y^2+6\big)\, dA \amp = \int_0^2\int_0^{-\frac x2+1} \big(3xy-x^2-y^2+6\big)\, dy\, dx</mrow>
          <mrow>\amp = \int_0^2\left.\left(\frac32xy^2-x^2y-\frac13y^3+6y\right)\right|_0^{-\frac x2+1}dx</mrow>
          <mrow>\amp = \int_0^2 \left(\frac{11}{12}x^3-\frac{11}{4}x^2-x+\frac{17}3\right)dx</mrow>
          <mrow>\amp = \left.\left(\frac{11}{48}x^4-\frac{11}{12}x^3-\frac12x^2+\frac{17}3x\right)\right|_0^2</mrow>
          <mrow>\amp = \frac{17}3=5.\overline{6}</mrow>
        </md>.
      </p>

      <p>
        Now lets consider the order <m>dx \, dy</m>.
        Here <m>x</m> goes from <q>curve to curve,</q> <m>0\leq x\leq 2-2y</m>,
        and <m>y</m> goes from <q>point to point,</q> <m>0\leq y\leq 1</m>:
        <md>
          <mrow>\iint_R \big(3xy-x^2-y^2+6\big)\, dA \amp = \int_0^1\int_0^{2-2y} \big(3xy-x^2-y^2+6\big)\, dx\, dy</mrow>
          <mrow>\amp = \int_0^1\left.\left(\frac32x^2y-\frac13x^3-xy^2+6x\right)\right|_0^{2-2y} dy</mrow>
          <mrow>\amp = \int_0^1\left(\frac{32}3y^3-22y^2+2y+\frac{28}3\right)dy</mrow>
          <mrow>\amp =\left.\left(\frac83y^4-\frac{22}3y^3+y^2+\frac{28}3y\right)\right|_0^1</mrow>
          <mrow>\amp =\frac{17}3=5.\overline{6}</mrow>
        </md>.
      </p>

      <p>
        We obtained the same result using both orders of integration.
      </p>
    </solution>
  </example>

  <figure xml:id="vid-multint-double-rectangle-eg" component="video" vshift="3.5">
    <caption>Further examples of double integrals over rectangles</caption>
    <video youtube="MMbLzFw-5Rg" label="vid-multint-double-rectangle-eg"/>
  </figure>
  <p>
    Note how in these examples that the bounds of integration depend only on <m>R</m>;
    the bounds of integration have nothing to do with <m>f(x,y)</m>.
    This is an important concept,
    so we include it as a Key Idea.
  </p>

  <insight xml:id="idea_bounds_on_double">
    <title>Double Integration Bounds</title>
    <p>
      When evaluating <m>\iint_R f(x,y)\, dA</m> using an iterated integral,
      the bounds of integration depend only on <m>R</m>.
      The function <m>f</m> does not determine the bounds of integration.
    </p>
  </insight>

  <p>
    Before doing another example,
    we give some properties of double integrals.
    Each should make sense if we view them in the context of finding signed volume under a surface,
    over a region.
  </p>

  <theorem xml:id="thm_double_prop">
    <title>Properties of Double Integrals</title>
    <statement>
      <p>
        Let <m>f</m> and <m>g</m> be continuous functions over a closed,
        bounded plane region <m>R</m>,
        and let <m>c</m> be a constant.
            <idx><h>double integral</h><h>properties</h></idx>
            <idx><h>iterated integration</h><h>properties</h></idx>
      </p>

      <p>
        <ol>
          <li>
            <p>
              <m>\ds \iint_Rc\,f(x,y)\, dA = c\iint_Rf(x,y)\, dA</m>.
            </p>
          </li>

          <li>
            <p>
              <m>\ds \iint_R \big(f(x,y)\pm g(x,y)\big)\, dA = \iint_R f(x,y)\, dA \pm \iint_R g(x,y)\, dA</m>
            </p>
          </li>

          <li>
            <p>
              If <m>f(x,y)\geq 0</m> on <m>R</m>,
              then <m>\ds \iint_R f(x,y)\, dA\geq 0</m>.
            </p>
          </li>

          <li>
            <p>
              If <m>f(x,y)\geq g(x,y)</m> on <m>R</m>,
              then <m>\ds \iint_R f(x,y)\, dA\geq \iint_R g(x,y)\, dA</m>.
            </p>
          </li>

          <li xml:id="thm_double_prop_regions">

            <p>
              Let <m>R</m> be the union of two nonoverlapping regions,
              <m>R = R_1\bigcup R_2</m>
              (see <xref ref="fig_double_region"/>).
              Then
              <me>
                \iint_R f(x,y)\, dA = \iint_{R_1}f(x,y)\, dA+ \iint_{R_2}f(x,y)\, dA
              </me>.
            </p>

            <figure xml:id="fig_double_region" vshift="12">
              <caption><m>R</m> is the union of two nonoverlapping regions, <m>R_1</m> and <m>R_2</m></caption>
              <!-- START figures/fig_double_region.tex -->
              <image width="35%">
                <shortdescription>Illustration of a pond-like region in the plane that has been divided into two sub-regions.</shortdescription>
                <description>
                  <p>
                    The sketch shows a generic region <m>R</m> in the plane.
                    The precise shape of the region is unimportant,
                    but its shape is like that of a pond with a rounded but uneven boundary.
                  </p>

                  <p>
                    A straight line passes through the middle of the region,
                    dividing it into two smaller, nonoverlapping regions <m>R_1</m> and <m>R_2</m>.
                  </p>
                </description>
                <latex-image label="img_double_region">

                \begin{tikzpicture}

                \draw [firstcolor,thick,fill=firstcolor!15,smooth] plot coordinates {(0,2.)(0.06639,2.527)(0.2407,2.839)(0.4857,3.009)(0.7641,3.112)(1.039,
                3.221)(1.294,3.367)(1.532,3.53)(1.759,3.689)(1.98,3.823)(2.2,3.915)(2.
                42,3.967)(2.64,3.992)(2.86,4.)(3.08,4.)(3.305,3.987)(3.543,3.93)(3.
                808,3.797)(4.107,3.558)(4.45,3.185)(4.815,2.703)(5.17,2.152)(5.483,1.
                577)(5.723,1.018)(5.872,0.5022)(5.938,0.02083)(5.93,-0.4363)(5.861,-0.
                88)(5.741,-1.319)(5.58,-1.742)(5.389,-2.128)(5.179,-2.456)(4.96,-2.
                705)(4.737,-2.865)(4.502,-2.953)(4.243,-2.991)(3.95,-3.)(3.614,-2.999)
                (3.244,-2.984)(2.86,-2.935)(2.484,-2.829)(2.137,-2.646)(1.832,-2.378)(
                1.558,-2.06)(1.299,-1.734)(1.039,-1.443)(0.7641,-1.222)(0.4857,-0.
                9779)(0.2407,-0.5015)(0.06639,0.4201)(0,2.)};

                \draw [thick,firstcolor] (3,4) -- (4,-3);

                \draw (2,1) node {$R_1$};
                \draw (5,.5) node {$R_2$};
                \draw (1,-2) node {$R$};

                \end{tikzpicture}

                </latex-image>
              </image>
              <!-- figures/fig_double_region.tex END -->
            </figure>
          </li>
        </ol>
      </p>
    </statement>
  </theorem>

  <figure xml:id="vid-multint-double-general-region" component="video" vshift="5">
    <caption>Evaluating a double integral over a more general region</caption>
    <video youtube="FcxnuFSNOfY" label="vid-multint-double-general-region"/>
  </figure>

  <example xml:id="ex_double3">
    <title>Evaluating a double integral</title>
    <statement>
      <p>
        Let <m>f(x,y) = \sin(x) \cos(y)</m> and <m>R</m> be the triangle with vertices <m>(-1,0)</m>,
        <m>(1,0)</m> and <m>(0,1)</m>
        (see <xref ref="fig_double3"/>).
        Evaluate the double integral <m>\iint_Rf(x,y)\, dA</m>.
      </p>

      <figure xml:id="fig_double3" vshift="1">
        <caption>Finding the signed volume under a surface in <xref ref="ex_double3"/></caption>

        <!-- START figures/figdouble3_3D.asy -->
        <image width="47%">
          <shortdescription>A wave-like surface on which a triangular curve is drawn, corresponding to a domain in the plane z=0 below.</shortdescription>
          <description>
            <p>
              The graph <m>z=\sin(x)\cos(y)</m> is plotted against a set of three-dimensional coordinate axes.
              It is a wave-like surface, but no crests or troughs are visible,
              as we only see the portion of the surface with <m>-1\leq x\leq 1</m> and <m>0\leq y\leq 1</m>.
            </p>

            <p>
              In the <m>xy</m> plane, the domain of <m>f(x,y)</m> for this integral is shown as a triangle,
              with vertices at <m>(-1,0,0)</m>, <m>(1,0,0)</m>, and <m>(0,1,0)</m>.
              In the default view of the image, this triangle is only partially visible below the surface.
            </p>

            <p>
              On the surface, we can see a triangular curve given by the points on the graph that lie above the boundary of the domain.
            </p>
          </description>
          <asymptote label="img_double3">



            //ASY file for figdouble33D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(.92,4,3.7);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={-1,1};
            real[] myychoice={1};
            real[] myzchoice={-1,1};
            defaultpen(0.5mm);

            pair xbounds=(-1.5,1.5);
            pair ybounds=(0,1.5);
            pair zbounds=(-1.5,1.5);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=sin(x)cos(y)};
            triple f(pair t) {
              return (t.x,t.y,sin(t.x)*cos(t.y));
            }
            surface s=surface(f,(-1.25,-0.25),(1.25,1.5),12,20,Spline);
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            //Draw triangle in plane
            draw((-1,0,0)--(1,0,0)--(0,1,0)--(-1,0,0),bluepen+dashed+linewidth(0.75));
            label("$R$",(0.8,0.25,0),E);

            //Draw triangle on surface
            triple g(real t) {return (t,0,sin(t));}
            path3 mypath=graph(g,-1,1,operator ..);
            draw(mypath,bluepen+linewidth(2));

            triple g(real t) {return (t-1,t,sin(t-1)*cos(t));}
            path3 mypath=graph(g,0,1,operator ..);
            draw(mypath,bluepen+linewidth(2));

            triple g(real t) {return (t,1-t,sin(t)*cos(1-t));}
            path3 mypath=graph(g,0,1,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw vertical lines
            //draw((-1,0,0)--(-1,0,sin(-1)),bluepen+dashed+linewidth(0.75));
            //draw((1,0,0)--(1,0,sin(1)),bluepen+dashed+linewidth(0.75));

          </asymptote>
        </image>
        <!-- figures/figdouble3_3D.asy END -->
      </figure>
    </statement>
    <solution>
      <p>
        If we attempt to integrate using an iterated integral with the order <m>dy\, dx</m>,
        note how there are two upper bounds on <m>R</m> meaning we'll need to use two iterated integrals.
        We would need to split the triangle into two regions along the <m>y</m>-axis,
        then use <xref ref="thm_double_prop"/>,
        <xref ref="thm_double_prop_regions" text="local">Part</xref>.
      </p>

      <p>
        Instead, let's use the order <m>dx\, dy</m>.
        The curves bounding <m>x</m> are <m>y-1\leq x\leq 1-y</m>;
        the bounds on <m>y</m> are <m>0\leq y\leq 1</m>.
        This gives us:
        <md>
          <mrow>\iint_R f(x,y)\, dA \amp = \int_0^1\int_{y-1}^{1-y}\sin(x) \cos(y) \, dx\, dy</mrow>
          <mrow>\amp = \int_0^1\left.\Big( -\cos(x) \cos(y) \Big)\right|_{y-1}^{1-y}\,dy</mrow>
          <mrow>\amp = \int_0^1 \cos(y) \Big(-\cos(1-y) + \cos(y-1)\Big)dy</mrow>
        </md>.
      </p>

      <p>
        Recall that the cosine function is an even function;
        that is, <m>\cos(x) = \cos(-x)</m>.
        Therefore, from the last integral above,
        we have <m>\cos(y-1) = \cos(1-y)</m>.
        Thus the integrand simplifies to 0, and we have
        <md>
          <mrow>\iint_R f(x,y)\, dA \amp = \int_0^1 0\, dy</mrow>
          <mrow>\amp = 0</mrow>
        </md>.
      </p>

      <p>
        It turns out that over <m>R</m>,
        there is just as much volume above the <m>xy</m>-plane as below
        (look again at <xref ref="fig_double3"/>),
        giving a final signed volume of 0.
      </p>
    </solution>
  </example>

  <figure xml:id="vid-multint-double-tetrahedron-volume" component="video" vshift="2">
    <caption>Finding the volume of a tetrahedron</caption>
    <video youtube="m_8kBmNVxEM" label="vid-multint-double-tetrahedron-volume"/>
  </figure>

  <example xml:id="ex_double4">
    <title>Evaluating a double integral</title>
    <statement>
      <p>
        Evaluate <m>\iint_R (4-y)\, dA</m>,
        where <m>R</m> is the region bounded by the parabolas <m>y^2=4x</m> and <m>x^2=4y</m>,
        graphed in <xref ref="fig_double4"/>.
      </p>

      <figure xml:id="fig_double4" vshift="-3">
        <caption>Finding the volume under the surface in <xref ref="ex_double4"/></caption>

        <!-- START figures/figdouble4_3D.asy -->
        <image width="47%">
          <shortdescription>A rectangular portion of a plane in space, and a petal-like curve on the plane.</shortdescription>
          <description>
            <p>
              The graph <m>z=4-y</m> is a plane.
              It is plotted as a rectangular region in the first octant,
              intersecting the <m>xy</m> plane along the line <m>y=4</m>,
              and the <m>xz</m> plane along the line <m>z=4</m>.
            </p>

            <p>
              The parabolas <m>y^2=4x</m> and <m>x^2=4y</m> are sketched in the <m>xy</m> plane,
              from the origin to their intersection at <m>(4,4,0)</m>.
              On the plane, we see the corresponding curves,
              which are also parabolas. The region between them has the shape of a narrow leaf or petal.
            </p>
          </description>
          <asymptote label="img_double4">



            //ASY file for figdouble43D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(16,6.2,5.6);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={2,4};
            real[] myychoice={2,4};
            real[] myzchoice={2,4};
            defaultpen(0.5mm);

            pair xbounds=(0,5);
            pair ybounds=(0,5);
            pair zbounds=(0,5);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=4-y};
            triple f(pair t) {
              return (t.x,t.y,4-t.y);
            }
            surface s=surface(f,(-0.25,-0.25),(4.5,4.25),12,20,Spline);
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            //Draw parabolas in plane
            triple g(real t) {return (t^2/4,t,0);}
            path3 mypath=graph(g,0,4.25,operator ..);
            draw(mypath,bluepen+linewidth(2));
            triple g(real t) {return (t,t^2/4,0);}
            path3 mypath=graph(g,0,4.25,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw parabolas on surface
            triple g(real t) {return (t^2/4,t,4-t);}
            path3 mypath=graph(g,0,4.,operator ..);
            draw(mypath,bluepen+linewidth(2));
            triple g(real t) {return (t,t^2/4,4-t^2/4);}
            path3 mypath=graph(g,0,4.,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw vertical lines
            //draw((-1,0,0)--(-1,0,sin(-1)),bluepen+dashed+linewidth(0.75));
            //draw((1,0,0)--(1,0,sin(1)),bluepen+dashed+linewidth(0.75));

          </asymptote>
        </image>
        <!-- figures/figdouble4_3D.asy END -->
      </figure>
    </statement>
    <solution>
      <p>
        Graphing each curve can help us find their points of intersection.
        Solving analytically, the second equation tells us that <m>y=x^2/4</m>.
        Substituting this value in for <m>y</m> in the first equation gives us <m>x^4/16 = 4x</m>.
        Solving for <m>x</m>:
        <md>
          <mrow>\frac{x^4}{16} \amp = 4x</mrow>
          <mrow>x^4-64x \amp =0</mrow>
          <mrow>x(x^3-64) \amp =0</mrow>
          <mrow>x\amp = 0,\, 4</mrow>
        </md>.
      </p>

      <p>
        Thus we've found analytically what was easy to approximate graphically:
        the regions intersect at <m>(0,0)</m> and <m>(4,4)</m>,
        as shown in <xref ref="fig_double4"/>.
      </p>

      <p>
        We now choose an order of integration:
        <m>dy\, dx</m> or <m>dx\, dy</m>?
        Either order works; since the integrand does not contain <m>x</m>,
        choosing <m>dx\, dy</m> might be simpler <mdash/> at least,
        the first integral is very simple.
      </p>

      <p>
        Thus we have the following <q>curve to curve,
        point to point</q> bounds:
        <me>
          y^2/4\leq x\leq 2\sqrt y, \text{ and } 0\leq y\leq 4
        </me>.
        Therefore,
        <md>
          <mrow>\iint_R (4-y)\, dA \amp = \int_0^4\int_{y^2/4}^{2\sqrt{y}}(4-y)\, dx\, dy</mrow>
          <mrow>\amp = \int_0^4 \big(x(4-y)\big)\Big|_{y^2/4}^{2\sqrt{y}} dy</mrow>
          <mrow>\amp = \int_0^4 \Big(\big(2\sqrt{y}-\frac{y^2}{4}\big)\big(4-y\big)\Big)\, dy</mrow>
          <mrow>\amp = \int_0^4 \Big( \frac{y^3}{4}-y^2-2y^{3/2}+8y^{1/2}\Big)\, dy</mrow>
          <mrow>\amp = \left.\left(\frac{y^4}{16}-\frac{y^3}{3}-\frac{4y^{5/2}}5+\frac{16y^{3/2}}3\right)\right|_0^4</mrow>
          <mrow>\amp = \frac{176}{15} = 11.7\overline{3}</mrow>
        </md>.
      </p>

      <p>
        The signed volume under the surface <m>z=f(x,y)</m> is about 11.7 cubic units.
      </p>
    </solution>
  </example>

  <figure xml:id="vid-multint-double-general-example" component="video" vshift="4">
    <caption>Evaluating a double integral over a general region</caption>
    <video youtube="a4XiokkzyrU" label="vid-multint-double-general-example"/>
  </figure>
  <p>
    In the previous section we practiced changing the order of integration of a given iterated integral,
    where the region <m>R</m> was not explicitly given.
    Changing the bounds of an integral is more than just an test of understanding.
    Rather, there are cases where integrating in one order is really hard,
    if not impossible,
    whereas integrating with the other order is feasible.
  </p>

  <example xml:id="ex_double6">
    <title>Changing the order of integration</title>
    <statement>
      <p>
        Rewrite the iterated integral
        <m>\ds \int_0^3\int_y^3 e^{-x^2}\, dx\, dy</m> with the order <m>dy\, dx</m>.
        Comment on the feasibility to evaluate each integral.
      </p>
    </statement>
    <solution>
      <p>
        Once again we make a sketch of the region over which we are integrating to facilitate changing the order.
        The bounds on <m>x</m> are from <m>x=y</m> to <m>x=3</m>;
        the bounds on <m>y</m> are from <m>y=0</m> to <m>y=3</m>.
        These curves are sketched in <xref ref="fig_double6"/>,
        enclosing the region <m>R</m>.
      </p>

      <figure xml:id="fig_double6" vshift="4">
        <caption>Determining the region <m>R</m> determined by the bounds of integration in <xref ref="ex_double6"/></caption>
        <!-- START figures/fig_double6.tex -->
        <image width="47%">
          <shortdescription>Several lines are plotted in the plane. Three of these lines form a triangle.</shortdescription>
          <description>
            <p>
              The <m>x</m> and <m>y</m> coordinate axes are plotted in the plane,
              with the origin to the bottom-left of the image,
              so that the first quadrant is shown.
            </p>

            <p>
              Four lines are plotted: the horizontal lines <m>y=0</m> (along the <m>x</m> axis) and <m>y=3</m>,
              the vertical line <m>x=3</m>, and the diagonal line <m>y=x</m>.
              The line <m>y=x</m> divides the square <m>0\leq x,y\leq 3</m> into two triangles,
              one below the line, and one above.
            </p>

            <p>
              The line <m>y=3</m> illustrates that the upper bound for <m>y</m> is <m>3</m>, 
              but this line is otherwise not really needed.
              The remaining lines <m>y=0</m>, <m>x=3</m>, and <m>y=x</m> form a triangle with vertices at
              <m>(0,0)</m>, <m>(3,0)</m>, and <m>(3,3)</m>.
            </p>

            <p>
              A label <m>R</m> placed inside the triangle hepls to illustrate that the region lies below <m>y=x</m>,
              and not above.
            </p>
          </description>

          <latex-image label="img_double6">

          \begin{tikzpicture}

          \begin{axis}[
          axis on top,
          ymin=-.5,ymax=3.5,
          xmin=-.5,xmax=3.5
          ]

          \addplot+ [very thick,domain=-.5:3.5] {x} node [pos=.5,sloped,above,black] { $y=x$};

          \draw [very thick,firstcolor] (axis cs:3,-.5) -- (axis cs:3,3.5);

          \draw [very thick,secondcolor] (axis cs:-.5,0) -- (axis cs:3.5,0)
                                         (axis cs:-.5,3) -- (axis cs:3.5,3);

          \draw (axis cs:2,1) node {$R$};

          \end{axis}

          \end{tikzpicture}

          </latex-image>
        </image>
        <!-- figures/fig_double6.tex END -->
      </figure>

      <p>
        To change the bounds,
        note that the curves bounding <m>y</m> are <m>y=0</m> up to <m>y=x</m>;
        the triangle is enclosed between <m>x=0</m> and <m>x=3</m>.
        Thus the new bounds of integration are
        <m>0\leq y\leq x</m> and <m>0\leq x\leq 3</m>,
        giving the iterated integral <m>\ds \int_0^3\int_0^x e^{-x^2}\, dy\, dx</m>.
      </p>

      <p>
        How easy is it to evaluate each iterated integral?
        Consider the order of integrating <m>dx\, dy</m>,
        as given in the original problem.
        The first indefinite integral we need to evaluate is <m>\int e^{-x^2}\, dx</m>;
        we have stated before
        (see <xref ref="sec_numerical_integration"/>)
        that this integral cannot be evaluated in terms of elementary functions.
        We are stuck.
      </p>

      <p>
        Changing the order of integration makes a big difference here.
        In the second iterated integral,
        we are faced with <m>\int e^{-x^2}\, dy</m>;
        integrating with respect to <m>y</m> gives us <m>ye^{-x^2}+C</m>,
        and the first definite integral evaluates to
        <me>
          \int_0^x e^{-x^2}\, dy = xe^{-x^2}
        </me>.
      </p>

      <p>
        Thus
        <me>
          \int_0^3\int_0^x e^{-x^2}\, dy\, dx = \int_0^3\Big(xe^{-x^2}\Big)dx
        </me>.
      </p>

      <p>
        This last integral is easy to evaluate with substitution,
        giving a final answer of <m>\frac12(1-e^{-9})\approx 0.5</m>.
        <xref ref="fig_double6b"/>
        shows the surface over <m>R</m>.
      </p>

      <figure xml:id="fig_double6b" vshift="6">
        <caption>Showing the surface <m>z=f(x,y)</m> defined in <xref ref="ex_double6"/> over its region <m>R</m></caption>

        <!-- START figures/figdouble6b_3D.asy -->
        <image width="47%">
          <shortdescription>A wave-like surface in three dimensions, and a curve on the surface illustrating a triangular domain.</shortdescription>
          <description>
            <p>
              In two dimensions, the graph <m>y=e^{-x^2}</m> is a bell  curve, with a peak at <m>(0,1)</m>.
              The surface <m>z=e^{-x^2}</m> is a cylinder through this curve.
              We are shown a portion of this surface with <m>x\geq 0</m>,
              which has the appearance of a wave parallel to the <m>y</m> axis that reaches its crest when <m>x=0</m>.
            </p>

            <p>
              The triangular domain is sketched in the <m>xy</m> plane,
              with vertices at <m>(0,0,0)</m>, <m>(3,0,0)</m>, and <m>(3,3,0)</m>,
              but it is mostly obscured by the surface.
            </p>

            <p>
              On the surface itself we see the corresponding triangular curve,
              illustrating the region under which we are computing a volume with this integral.
            </p>
          </description>
          <asymptote label="img_double6b">



            //ASY file for figdouble6b3D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(6.3,9.6,2.4);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={2};
            real[] myychoice={2};
            real[] myzchoice={1};
            defaultpen(0.5mm);

            pair xbounds=(0,4);
            pair ybounds=(0,3);
            pair zbounds=(0,1.5);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=exp(-x^2)};
            triple f(pair t) {
              return (t.x,t.y,exp(-t.x^2));
            }
            surface s=surface(f,(-0.25,0),(3.5,3.5),12,20,Spline);
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            //Draw lines in plane
            draw((0,0,0)--(3,0,0)--(3,3,0)--cycle,bluepen+dashed+linewidth(0.75));

            //Draw lines on surface
            draw((3,0,0)--(3,3,0),bluepen+linewidth(2));
            triple g(real t) {return (t,0,exp(-t^2));}
            path3 mypath=graph(g,0,3,operator ..);
            draw(mypath,bluepen+linewidth(2));
            triple g(real t) {return (t,t,exp(-t^2));}
            path3 mypath=graph(g,0,3,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw vertical lines
            //draw((-1,0,0)--(-1,0,sin(-1)),bluepen+dashed+linewidth(0.75));
            //draw((1,0,0)--(1,0,sin(1)),bluepen+dashed+linewidth(0.75));

          </asymptote>
        </image>
        <!-- figures/figdouble6b_3D.asy END -->
      </figure>

      <p>
        In short, evaluating one iterated integral is impossible;
        the other iterated integral is relatively simple.
      </p>
    </solution>
  </example>

  <figure xml:id="vid-multint-double-changing-order" component="video" vshift="0.5">
    <caption>Two more examples of changing the order of integration</caption>
    <video youtube="2lQA7pTALGk" label="vid-multint-double-changing-order"/>
  </figure>

  <p>
    <xref ref="def_av_val"/>
    defines the average value of a single-variable function <m>f(x)</m> on the interval <m>[a,b]</m> as
    <me>
      \text{ average value of \(f(x)\) on \([a,b]\) }  = \frac1{b-a}\int_a^b f(x)\, dx;
    </me>
    that is, it is the <q>area under <m>f</m> over an interval divided by the length of the interval.</q>
    We make an analogous statement here:
    the average value of <m>z=f(x,y)</m> over a region <m>R</m> is the volume under <m>f</m> over <m>R</m> divided by the area of <m>R</m>.
  </p>

  <definition xml:id="def_av_val2">
    <title>The Average Value of <m>f</m> on <m>R</m></title>
    <statement>
      <p>
        Let <m>z=f(x,y)</m> be a continuous function defined over a closed,
        bounded region <m>R</m> in the <m>xy</m>-plane.
        The <term>average value</term> of <m>f</m> on <m>R</m> is
        <idx><h>average value of a function</h></idx>
        <me>
          \text{ average value of \(f\) on \(R\) }  = \frac{\ds \iint_R f(x,y)\, dA}{\ds\iint_R \, dA}
        </me>.
      </p>
    </statement>
  </definition>

  <example xml:id="ex_double8">
    <title>Finding average value of a function over a region <m>R</m></title>
    <statement>
      <p>
        Find the average value of <m>f(x,y) = 4-y</m> over the region <m>R</m>,
        which is bounded by the parabolas <m>y^2=4x</m> and <m>x^2=4y</m>.
        Note: this is the same function and region as used in <xref ref="ex_double4"/>.
      </p>
    </statement>
    <solution>
      <p>
        In <xref ref="ex_double4"/> we found
        <me>
          \iint_R f(x,y)\, dA = \int_0^4\int_{y^2/4}^{2\sqrt{y}}(4-y)\, dx\, dy = \frac{176}{15}
        </me>.
      </p>

      <p>
        We find the area of <m>R</m> by computing <m>\iint_R \, dA</m>:
        <me>
          \iint_R \, dA = \int_0^4\int_{y^2/4}^{2\sqrt{y}} \, dx\, dy = \frac{16}{3}
        </me>.
      </p>

      <p>
        Dividing the volume under the surface by the area gives the average value:
        <me>
          \text{ average value of \(f\) on \(R\) }  = \frac{176/15}{16/3} = \frac{11}5 = 2.2
        </me>.
      </p>

      <p>
        While the surface, as shown in <xref ref="fig_double8"/>,
        covers <m>z</m>-values from <m>z=0</m> to <m>z=4</m>,
        the <q>average</q> <m>z</m>-value on <m>R</m> is 2.2.
      </p>

      <figure xml:id="fig_double8" vshift="5">
        <caption>Finding the average value of <m>f</m> in <xref ref="ex_double8"/></caption>

        <!-- START figures/figdouble4_3D.asy -->
        <image width="47%">
          <shortdescription>A rectangular portion of a plane in space, and a petal-like curve on the plane.</shortdescription>
          <description>
            <p>
              This is the same image as the one used in <xref ref="fig_double4"/>.
              We repeat the description here for convenience.
            </p>

            <p>
              The graph <m>z=4-y</m> is a plane.
              It is plotted as a rectangular region in the first octant,
              intersecting the <m>xy</m> plane along the line <m>y=4</m>,
              and the <m>xz</m> plane along the line <m>z=4</m>.
            </p>

            <p>
              The parabolas <m>y^2=4x</m> and <m>x^2=4y</m> are sketched in the <m>xy</m> plane,
              from the origin to their intersection at <m>(4,4,0)</m>.
              On the plane, we see the corresponding curves,
              which are also parabolas. The region between them has the shape of a narrow leaf or petal.
            </p>
          </description>
          <asymptote label="img_double8">



            //ASY file for figdouble43D.asy in Chapter 13

            size(200,200,IgnoreAspect);
            //currentprojection=perspective(7,2,1);
            currentprojection=orthographic(16,6.2,5.6);
            defaultrender.merge=true;

            // setup and draw the axes
            real[] myxchoice={2,4};
            real[] myychoice={2,4};
            real[] myzchoice={2,4};
            defaultpen(0.5mm);

            pair xbounds=(0,5);
            pair ybounds=(0,5);
            pair zbounds=(0,5);

            xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
            yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
            zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

            label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
            label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
            label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

            //Draw the surface//{z=4-y};
            triple f(pair t) {
              return (t.x,t.y,4-t.y);
            }
            surface s=surface(f,(-0.25,-0.25),(4.5,4.25),12,20,Spline);
            pen p=apexmeshpen;
            draw(s,surfacepen,meshpen=p);

            //Draw parabolas in plane
            triple g(real t) {return (t^2/4,t,0);}
            path3 mypath=graph(g,0,4.25,operator ..);
            draw(mypath,bluepen+linewidth(2));
            triple g(real t) {return (t,t^2/4,0);}
            path3 mypath=graph(g,0,4.25,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw parabolas on surface
            triple g(real t) {return (t^2/4,t,4-t);}
            path3 mypath=graph(g,0,4.,operator ..);
            draw(mypath,bluepen+linewidth(2));
            triple g(real t) {return (t,t^2/4,4-t^2/4);}
            path3 mypath=graph(g,0,4.,operator ..);
            draw(mypath,bluepen+linewidth(2));

            //Draw vertical lines
            //draw((-1,0,0)--(-1,0,sin(-1)),bluepen+dashed+linewidth(0.75));
            //draw((1,0,0)--(1,0,sin(1)),bluepen+dashed+linewidth(0.75));

          </asymptote>
        </image>
        <!-- figures/figdouble4_3D.asy END -->
      </figure>
    </solution>
  </example>

  <p>
    The previous section introduced the iterated integral in the context of finding the area of plane regions.
    This section has extended our understanding of iterated integrals;
    now we see they can be used to find the signed volume under a surface.
  </p>

  <p>
    This new understanding allows us to revisit what we did in the previous section.
    Given a region <m>R</m> in the plane,
    we computed <m>\iint_R 1\, dA</m>;
    again, our understanding at the time was that we were finding the area of <m>R</m>.
    However, we can now view the graph <m>z=1</m> as a surface,
    a flat surface with constant <m>z</m>-value of 1.
    The double integral <m>\iint_R 1\, dA</m> finds the volume,
    under <m>z=1</m>, over <m>R</m>,
    as shown in <xref ref="fig_double_summary"/>.
    Basic geometry tells us that if the base of a general right cylinder has area <m>A</m>,
    its volume is <m>A\cdot h</m>,
    where <m>h</m> is the height.
    In our case, the height is 1.
    We were <q>actually</q> computing the volume of a solid,
    though we interpreted the number as an area.
  </p>

  <figure xml:id="fig_double_summary" vshift="1">
    <caption>Showing how an iterated integral used to find area also finds a certain volume</caption>

    <!-- START figures/figdouble_summary_3D.asy -->
    <image width="47%">
      <shortdescription>A circular cylinder, bounded below by the xy plane, and above by the plane z=1.</shortdescription>
      <description>
        <p>
          A circular cylinder is plotted in three dimensions.
          The cylinder appears to lie over a circle with center <m>(1,0,0)</m> and radius <m>1</m> in the <m>xy</m> plane.
        </p>

        <p>
          The plane <m>z=1</m> sits at the top of the cylinder.
        </p>

        <p>
          The image is used to illustrate that for any region in the plane,
          there is a cylinder that lies over the region, between the planes <m>z=0</m> and <m>z=1</m>.
          A double integral of the form <m>\iint_R 1 \, dA</m> can be thought of as either computing the area of the region <m>R</m>,
          or the volume of the corresponding cylinder of height <m>1</m> over <m>R</m>.
        </p>
      </description>
      <asymptote label="img_double_summary">



        //ASY file for figdouble_intro23D.asy in Chapter 13

        size(200,200,IgnoreAspect);
        //currentprojection=perspective(7,2,1);
        currentprojection=orthographic(8.2,4.6,1.5);
        defaultrender.merge=true;

        // setup and draw the axes
        real[] myxchoice={2};
        real[] myychoice={-1,1};
        real[] myzchoice={1};
        defaultpen(0.5mm);

        pair xbounds=(-1,2.5);
        pair ybounds=(-1.25,1.25);
        pair zbounds=(-.05,1.5);

        xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
        yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
        zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

        label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
        label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
        label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

        //Draw the surface//{z=-.5*(x-1)^2-.5*(y)^2+2};
        //triple f(pair t) {
        //  return (t.x,t.y,-.5*(t.x-1)^2-.5*(t.y)^2+2);
        //}
        //surface s=surface(f,(-0.221,-1),(2.2,1),12,20,vsplinetype=new splinetype[] {notaknot,notaknot,monotonic},usplinetype=new splinetype[] {notaknot,notaknot,monotonic});
        //pen p=apexmeshpen;
        //draw(s,surfacepen,meshpen=p);

        //Draw curve on top of the grid in xy plane ({cos(x)*(1+cos(2*x))},{sin(x)*(1+cos(2*x))},0);
        triple g(real t) {return (cos(t)*(1+cos(2*t)),sin(t)*(1+cos(2*t)),0);}
        path3 mypath=graph(g,-pi/2,pi/2,operator ..);
        draw(mypath,bluepen);

        // draw curve on surface
        triple g(real t) {
          return (cos(t)*(1+cos(2*t)),sin(t)*(1+cos(2*t)),1);
        }
        path3 mypath=graph(g,-pi/2,pi/2,operator ..);
        draw(mypath,bluepen);

        pen q=redcurvepen;
        triple gg(pair t) {return (cos(t.x)*(1+cos(2*t.x)),sin(t.x)*(1+cos(2*t.x)),t.y);}
        surface s=surface(gg,(-pi/2,0),(pi/2,1),16,4,Spline);
        draw(s,surfacepen2,meshpen=q,nolight,render(merge=true));

        triple f(pair t) {
          return (t.x,t.y,1);
        }
        surface s=surface(f,(-.1,ybounds.x),(xbounds.y,ybounds.y),8,8);
        pen p=apexmeshpen;
        draw(s,surfacepen,meshpen=p);

      </asymptote>
    </image>
    <!-- figures/figdouble_summary_3D.asy END -->
  </figure>

  <p>
    The next section extends our abilities to find
    <q>volumes under surfaces.</q> Currently,
    some integrals are hard to compute because either the region <m>R</m> we are integrating over is hard to define with rectangular curves,
    or the integrand itself is hard to deal with.
    Some of these problems can be solved by converting everything into polar coordinates.
  </p>

  <exercises>
    <subexercises xml:id="TaC-double-int-volume">
      <title>Terms and Concepts</title>

      <exercise label="TaC-double-int-volume-1">
        <!--<webwork xml:id="webwork-TaC-double-int-volume-1">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                An integral can be interpreted as giving the signed area over an interval;
                a double integral can be interpreted as giving the signed <fillin answer="volume" width="15"/> over a region.
              </p>
            </statement>
            <evaluation>
              <evaluate>
                <test correct="yes">
                  <strcmp use-answer="yes" case="insensitive"/>
                </test>
              </evaluate>
            </evaluation>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-double-int-volume-2">
        <!--<webwork xml:id="webwork-TaC-double-int-volume-2">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                Explain why the following statement is false:
                Fubini's Theorem states that
                <me>
                  \int_a^b\int_{g_1(x)}^{g_2(x)} f(x,y)\, dy\, dx = \int_a^b\int_{g_1(y)}^{g_2(y)} f(x,y)\, dx\, dy
                </me>.
              </p>
            </statement>
            <response />
            
            <solution>
              <p>
                When switching the order of integration,
                the bounds integrals must change to reflect the bounds of the region of integration.
                You cannot merely change the letters <m>x</m> and <m>y</m> in a few places.
              </p>
            </solution>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-double-int-volume-3">
        <!--<webwork xml:id="webwork-TaC-double-int-volume-3">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                Explain why if <m>f(x,y) \gt 0</m> over a region <m>R</m>, then
              </p>

              <p>
                <m>\iint_Rf(x,y)\, dA \gt 0</m>.
              </p>
            </statement>
            <response />
            
            <solution>
              <p>
                The double integral gives the signed volume under the surface.
                Since the surface is always positive,
                it is always above the <m>xy</m>-plane and hence produces only
                <q>positive</q> volume.
              </p>
            </solution>
        <!--</webwork>-->
      </exercise>

      <exercise label="TaC-double-int-volume-4">
        <!--<webwork xml:id="webwork-TaC-double-int-volume-4">
            <pg-code>
            </pg-code> -->
            <statement>
              <p>
                If <m>\iint_R f(x,y)\, dA = \iint_R g(x,y)\, dA</m>,
                does this imply <m>f(x,y) = g(x,y)</m>?
              </p>
            </statement>
            <response />
            
            <solution>
              <p>
                No.
                It means that there is the same amount of signed volume under <m>f</m> and <m>g</m> over <m>R</m>,
                but the functions could be very different.
              </p>
            </solution>
        <!--</webwork>-->
      </exercise>
    </subexercises>
    
    <subexercises>
      <title>Problems</title>
      <exercisegroup cols="2" xml:id="exset-double-int-volume-eval-change-order">

        <introduction>
          <p>
            For the given integral,

            <ol marker="(a)">
              <li>
                <p>
                  Evaluate the given iterated integral, and
                </p>
              </li>

              <li>
                <p>
                  rewrite the integral using the other order of integration.
                </p>
              </li>
            </ol>
          </p>
        </introduction>

        <exercise xml:id="x13_02_ex_05" label="ex-double-int-volume-eval-change-order-1">
          <!--<webwork xml:id="webwork-ex-double-int-volume-eval-change-order-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_1^2\int_{-1}^1\left(\frac xy+3\right)\, dx\, dy</m>
                </p>
              </statement>
              <solution>
                <p>
                  6; <m>\ds \int_{-1}^1\int_{1}^2\left(\frac xy+3\right)\, dy\, dx</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <!--TODO: the WW vode below does NOT produce a good static version-->
        <exercise label="ex-double-int-volume-eval-change-order-2">
          <!-- <webwork xml:id="webwork-ex-double-int-volume-eval-change-order-2">

              <pg-code>
                  Context()->variables->are(x=>"Real", dx=>"Real", y=>"Real", dy=>"Real");
                  $outerbot=Compute("0");
                  $outertop=Compute("pi");
                  $innerbot=Compute("-pi/2");
                  $innertop=Compute("pi/2");
                  $integrand=Compute("sin(x)cos(y)");
                  $innerd=Compute("dy");
                  $outerd=Compute("dx");
                  $multians = MultiAnswer($outertop, $innertop, $integrand, $innerd, $outerd, $outerbot, $innerbot)->with(
                      singleResult => 1,
                      checker => sub {
                          my ( $correct, $student, $self ) = @_;
                          my ( @stu ) = @{$student};
                          my ( @cor ) = @{$correct};
                          my $OK = 1;
                          for my $i (0..$#stu)
                              {Value::Error("stu is @stu and cor is @cor") if ($stu[$i] != $cor[$i]);
                              $OK = 0 if ($stu[$i] != $cor[$i]);};
                          return $OK;
                      }
                  );
                  $value=Compute("4");
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_{-\pi/2}^{\pi/2}\int_{0}^\pi\left(\sin(x) \cos(y) \right)\,dx\,dy</m>
                </p>

                      <!-- <p>
                        <var name="$value" width="10"/>
                      </p> -->

                      <!-- <tabular>
                        <row>
                          <cell><var name="$multians" width="1"/></cell>
                          <cell><var name="$multians" width="1"/></cell>
                        </row>
                        <row>
                          <cell><m>\displaystyle\int</m></cell>
                          <cell><m>\displaystyle\int</m></cell>
                          <cell><var name="$multians" width="15"/> <var name="$multians" width="1"/> <var name="$multians" width="1"/></cell>
                        </row>
                        <row>
                          <cell><var name="$multians" width="1"/></cell>
                          <cell><var name="$multians" width="1"/></cell>
                        </row>
                      </tabular> -->
              </statement>
          <!-- </webwork> -->
        </exercise>

        <exercise label="ex-double-int-volume-eval-change-order-3">
          <!--<webwork xml:id="webwork-ex-double-int-volume-eval-change-order-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_{0}^{4}\int_{0}^{-x/2+2}\left(3x^2-y+2\right)\, dy\, dx</m>
                </p>
              </statement>
              <solution>
                <p>
                  112/3; <m>\ds \int_{0}^{2}\int_{0}^{4-2y}\left(3x^2-y+2\right)\, dx\, dy</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise xml:id="x13_02_ex_08" label="ex-double-int-volume-eval-change-order-4">
          <!-- <webwork xml:id="webwork-ex-double-int-volume-eval-change-order-4">

              <pg-code>
                  Context()->variables->are(x=>"Real", dx=>"Real", y=>"Real", dy=>"Real");
                  $outertop=Compute("3");
                  $innertop=Compute("x");
                  $integrand=Compute("x^2y-xy^2");
                  $innerd=Compute("dy");
                  $outerd=Compute("dx");
                  $outerbot=Compute("1");
                  $innerbot=Compute("1");
                  $multians = MultiAnswer($outertop, $innertop, $integrand, $innerd, $outerd, $outerbot, $innerbot)->with(
                      singleResult => 1,
                      checker => sub {
                          my ( $correct, $student, $self ) = @_;
                          my ( @stu ) = @{$student};
                          my ( @cor ) = @{$correct};
                          my $OK = 1;
                          for my $i (0..$#stu)
                              {Value::Error("stu is @stu and cor is @cor") if ($stu[$i] != $cor[$i]);
                              $OK = 0 if ($stu[$i] != $cor[$i]);};
                          return $OK;
                      }
                  );
                  $value=Formula("76/15");
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_{1}^{3}\int_{y}^{3}\left(x^2y-xy^2\right)\,dx\,dy</m>
                </p>

                      <!-- <p>
                        <var name="$value" width="10"/>
                      </p> -->

  <!--
                      <tabular>
                        <row>
                          <cell><var name="$multians" width="1"/></cell>
                          <cell><var name="$multians" width="1"/></cell>
                        </row>
                        <row>
                          <cell><m>\displaystyle\int</m></cell>
                          <cell><m>\displaystyle\int</m></cell>
                          <cell><var name="$multians" width="15"/> <var name="$multians" width="1"/> <var name="$multians" width="1"/></cell>
                        </row>
                        <row>
                          <cell><var name="$multians" width="1"/></cell>
                          <cell><var name="$multians" width="1"/></cell>
                        </row>
                      </tabular> -->
              </statement>
          <!-- </webwork> -->
        </exercise>

        <exercise label="ex-double-int-volume-eval-change-order-5">
          <!--<webwork xml:id="webwork-ex-double-int-volume-eval-change-order-5">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_{0}^{1}\int_{-\sqrt{1-y}}^{\sqrt{1-y}}\left(x+y+2\right)\, dx\, dy</m>
                </p>
              </statement>
              <solution>
                <p>
                  16/5; <m>\ds \int_{-1}^{1}\int_{0}^{1-x^2}\left(x+y+2\right)\, dy\, dx</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-eval-change-order-6">
          <!-- <webwork xml:id="webwork-ex-double-int-volume-eval-change-order-6">

              <pg-code>
                  Context()->variables->are(x=>"Real", dx=>"Real", y=>"Real", dy=>"Real");
                  $outertop=Compute("3");
                  $innertop=Compute("3x");
                  $integrand=Compute("xy^2");
                  $innerd=Compute("dy");
                  $outerd=Compute("dx");
                  $outerbot=Compute("0");
                  $innerbot=Compute("x^2");
                  $multians = MultiAnswer($outertop, $innertop, $integrand, $innerd, $outerd, $outerbot, $innerbot)->with(
                      singleResult => 1,
                      checker => sub {
                          my ( $correct, $student, $self ) = @_;
                          my ( @stu ) = @{$student};
                          my ( @cor ) = @{$correct};
                          my $OK = 1;
                          for my $i (0..$#stu)
                              {Value::Error("stu is @stu and cor is @cor") if ($stu[$i] != $cor[$i]);
                              $OK = 0 if ($stu[$i] != $cor[$i]);};
                          return $OK;
                      }
                  );
                  $value=Formula("6561/40");
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_{0}^{9}\int_{y/3}^{\sqrt{y}}\left(xy^2\right)\,dx\,dy</m>
                </p>

                      <!-- <p>
                        <var name="$value" width="10"/>
                      </p> -->

                      <!-- <tabular>
                        <row>
                          <cell><var name="$multians" width="1"/></cell>
                          <cell><var name="$multians" width="1"/></cell>
                        </row>
                        <row>
                          <cell><m>\displaystyle\int</m></cell>
                          <cell><m>\displaystyle\int</m></cell>
                          <cell><var name="$multians" width="15"/> <var name="$multians" width="1"/> <var name="$multians" width="1"/></cell>
                        </row>
                        <row>
                          <cell><var name="$multians" width="1"/></cell>
                          <cell><var name="$multians" width="1"/></cell>
                        </row>
                      </tabular> -->

              </statement>
          <!-- </webwork> -->
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-double-int-volume-sketch-eval">

        <introduction>
          <p>
            In the following exercises:

            <ol marker="(a)">
              <li>
                <p>
                  Sketch the region <m>R</m> given by the problem.
                </p>
              </li>

              <li>
                <p>
                  Set up the iterated integrals, in both orders,
                  that evaluate the given double integral for the described region <m>R</m>.
                </p>
              </li>

              <li>
                <p>
                  Evaluate one of the iterated integrals to find the signed volume under the surface
                  <m>z=f(x,y)</m> over the region <m>R</m>.
                </p>
              </li>
            </ol>
          </p>
        </introduction>

        <exercise label="ex-double-int-volume-sketch-eval-1">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R x^2y\, dA</m>,
                  where <m>R</m> is bounded by <m>y=\sqrt{x}</m> and <m>y=x^2</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_11.tex -->
                        <image>
                          <shortdescription>A region in the first quadrant of the plane, bounded by two parabolas.</shortdescription>
                          <description>
                            <p>
                              The correct region is in the first quadrant of the <m>xy</m> plane.
                              It is a leaf-shaped region, bounded by the parabolas <m>y=x^2</m> and <m>x=y^2</m>.
                              The region is symmetric about the line <m>y=x</m>.
                              The two parabolas intersect at <m>(0,0)</m> and <m>(1,1)</m>.
                              The parabola <m>y=x^2</m> lies below the line <m>y=x</m>,
                              and the parabola <m>y=\sqrt{x}</m> lies above.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_11X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={1},
                          ytick={1},
                          ymin=-.1,ymax=1.5,
                          xmin=-.1,xmax=1.5
                          ]

                          \addplot [firstcurvestyle,domain=-.1:1.1] ({x^2},{x}) node [pos=.5,sloped,above,black] {$y=\sqrt{x}$};
                          \addplot [firstcurvestyle,domain=-.1:1.1] ({x},{x^2}) node [pos=.5,sloped,below,black] {$y=x^2$};

                          \draw (axis cs: .5,.5) node {$R$};

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_11.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_0^1\int_{x^2}^{\sqrt{x}}x^2y\, dy\, dx = \int_0^1\int_{y^2}^{\sqrt{y}}x^2y\, dx\, dy</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        <m>\frac3{56}</m>
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-2">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-2">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R x^2y\, dA</m>,
                  where <m>R</m> is bounded by <m>y=\sqrt[3]{x}</m> and <m>y=x^3</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_12.tex -->
                        <image>
                          <shortdescription>A region in the first quadrant of the plane, bounded by a cubic function and its inverse.</shortdescription>
                          <description>
                            <p>
                              The region for this integral lies in the first quadrant.
                            </p>

                            <p>
                              The functions given by <m>y=x^3</m> and <m>y=\sqrt[3]{x}</m> are inverses of each other,
                              so the region is symmetric about the line <m>y=x</m>.
                            </p>

                            <p>
                              The curve <m>y=x^3</m> lies below the line <m>y=x</m>,
                              and the curve <m>y=\sqrt[3]{x}</m> lies above this line.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_12X">

                          \begin{tikzpicture}[&gt;=stealth]

                          \begin{axis}[
                          axis on top,
                          xtick={1},
                          ytick={1},
                          ymin=-1.5,ymax=1.5,
                          xmin=-1.5,xmax=1.5
                          ]

                          \addplot [firstcurvestyle,domain=-1.1:1.1,samples=60] ({x^3},{x}) node [pos=.85,above left,black] {$y=\sqrt[3]{x}$};
                          \addplot [firstcurvestyle,domain=-1.1:1.1,samples=60] ({x},{x^3}) node [pos=.75,below right,black] {$y=x^3$};;

                          \draw (axis cs: -.5,.5) node (A) {$R$};

                          \draw [-&gt;] (A) -- (axis cs: .5,.5);
                          \draw [-&gt;] (A) -- (axis cs: -.5,-.5);

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_12.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_0^1\int_{x^3}^{\sqrt[3]{x}}x^2y\, dy\, dx + \int_{-1}^0\int_{\sqrt[3]{x}}^{x^3}x^2y\, dy\, dx</m> <m>\ds = \int_0^1\int_{y^3}^{\sqrt[3]{y}}x^2y\, dx\, dy +\int_{-1}^0\int_{\sqrt[3]{y}}^{y^3}x^2y\, dx\, dy</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        0
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-3">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R x^2-y^2\, dA</m>,
                  where <m>R</m> is the rectangle with corners <m>(-1,-1)</m>,
                  <m>(1,-1)</m>,
                  <m>(1,1)</m> and <m>(-1,1)</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_13.tex -->
                        <image>
                          <shortdescription>A square of side length 2, with its center at the origin.</shortdescription>
                          <description>
                            <p>
                              A rectangle in the plane. In fact, it is a square, with side length <m>2</m>.
                            </p>

                            <p>
                              The vertices are at <m>(\pm 1,0)</m> and <m>(0,\pm 1)</m>,
                              so that the square is centered at the origin.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_13X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={-1,1},
                          ytick={1,-1},
                          ymin=-1.1,ymax=1.1,
                          xmin=-1.1,xmax=1.1
                          ]

                          \draw [very thick,firstcolor] (axis cs:-1,-1) -- (axis cs:1,-1) -- (axis cs:1,1) -- (axis cs:-1,1) -- cycle;

                          \draw (axis cs: .5,.5) node {$R$};

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_13.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_{-1}^1\int_{-1}^{1}x^2-y^2\, dy\, dx = \int_{-1}^1\int_{-1}^{1}x^2-y^2\, dx\, dy</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        0
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-4">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-4">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R ye^x\, dA</m>,
                  where <m>R</m> is bounded by <m>x=0</m>,
                  <m>x=y^2</m> and <m>y=1</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_14.tex -->
                        <image>
                          <shortdescription>A region in the plane that lies above a rightward-opening parabola, and below a horizontal line.</shortdescription>
                          <description>
                            <p>
                              The parabola <m>x=y^2</m> has its vertex at the origin, and opens toward the right.
                            </p>

                            <p>
                              The region for this integral is in the first quadrant.
                              It lies above the parabola, and below the line <m>y=1</m>.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_14X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={1},
                          ytick={1},
                          ymin=-.5,ymax=1.2,
                          xmin=-.5,xmax=1.2
                          ]

                          \addplot [firstcurvestyle,domain=-.25:1.1] ({x},{1});
                          \addplot [firstcurvestyle,domain=-.25:1.1] ({x^2},{x}) node [pos=.5,below right,black] { $x=y^2$};
                          \addplot [firstcurvestyle,domain=-.25:1.1] ({0},{x});

                          \draw (axis cs: .25,.75) node {$R$};

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_14.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_{0}^1\int_{0}^{y^2}ye^x\, dx\, dy = \int_{0}^1\int_{\sqrt{x}}^{1}ye^x\, dy\, dx</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        <m>e/2-1</m>
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-5">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-5">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R \big(6-3x-2y\big)\, dA</m>,
                  where <m>R</m> is bounded by <m>x=0</m>,
                  <m>y=0</m> and <m>3x+2y=6</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_15.tex -->
                        <image>
                          <shortdescription>A triangular region in the plane, with vertices at (0,0), (2,0), and (0,3).</shortdescription>
                          <description>
                            <p>
                              The region for this integral is a triangle in the first quadrant,
                              bounded by the coordinate axes and the line <m>3x+3y=6</m>.
                            </p>

                            <p>
                              The vertices of the triangle are at <m>(0,0)</m>, <m>(2,0)</m>, and <m>(0,3)</m>.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_15X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={1,2},
                          ytick={1,2,3},
                          ymin=-.5,ymax=3.5,
                          xmin=-.5,xmax=2.5
                          ]

                          \addplot [firstcurvestyle,domain=-.25:2.25] ({x},{0});
                          \addplot [firstcurvestyle,domain=-.25:2.25] ({x},{3-3/2*x}) node [pos=.4,sloped,above,black] { $3x+2y=6$};
                          \addplot [firstcurvestyle,domain=-.25:3.25] ({0},{x});

                          \draw (axis cs: .75,1) node {$R$};

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_15.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_{0}^2\int_{0}^{3-3/2x}\big(6-3x-2y\big)\, dy\, dx = \int_{0}^3\int_{0}^{2-2/3y}\big(6-3x-2y\big)\, dx\, dy</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        6
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-6">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-6">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R e^y\, dA</m>, where <m>R</m> is bounded by <m>y=\ln(x)</m> and
                </p>

                <p>
                  <m>\ds y=\frac{1}{e-1}(x-1)</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_16.tex -->
                        <image>
                          <shortdescription>A region in the plane bounded by the graph of the natural logarithm and a straight line.</shortdescription>
                          <description>
                            <p>
                              The graph <m>y=\ln(x)</m> meets the <m>x</m> axis at <m>(1,0)</m>.
                              It tends toward <m>-\infty</m> as it approaches the <m>y</m> axis,
                              and grows slowly upward as <m>x</m> increases past <m>x=1</m>.
                            </p>

                            <p>
                              The line <m>y=\frac{1}{e-1}(x-1)</m> also meets the <m>x</m> axis at <m>(1,0)</m>,
                              and it intercepts the graph <m>y=\ln(x)</m> a second time when <m>x=e</m>.
                            </p>

                            <p>
                              The region for this integral therefore lies below <m>y=\ln(x)</m>
                              and above <m>y=\frac{1}{e-1}(x-1)</m>, for <m>1\leq x\leq e</m>.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_16X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={1,2,3},
                          ytick={1,2,3},
                          ymin=-.5,ymax=1.25,
                          xmin=-.5,xmax=3.25
                          ]

                          \addplot [firstcurvestyle,domain=.5:3.25] ({x},{ln(x)}) node [pos=.7,sloped,above,black] { $y=\ln(x)$};
                          \addplot [firstcurvestyle,domain=-.25:3.25] ({x},{1/e*(x-1)}) node [pos=.6,below right,black] { $y=\frac{1}{1-e}(x-1)$};

                          \draw (axis cs: 1,.5) node (A) {$R$};

                          \draw[-&gt;,&gt;=stealth] (A) -- (axis cs:1.8,.5);

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_16.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_{1}^e\int_{\frac{x-1}{e-1}}^{\ln(x) }e^y\, dy\, dx = \int_{0}^1\int_{e^y}^{y(e-1)+1}e^y\, dx\, dy</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        <m>-\frac12e^2+2e-\frac32</m>
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-7">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-7">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R \big(x^3y-x\big)\, dA</m>,
                  where <m>R</m> is the half of the circle
                  <m>x^2+y^2=9</m> in the first and second quadrants.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_17.tex -->
                        <image>
                          <shortdescription>A region bounded by the x axis and the upper half of a semicircle of radius 3.</shortdescription>
                          <description>
                            <p>
                              The region for this integral is bounded above by the semicircle <m>y=\sqrt{9-x^2}</m>,
                              which has center <m>(0,0)</m> and radius <m>3</m>.
                              The region is bounded below by the <m>x</m> axis, for <m>-3\leq x\leq 3</m>.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_17X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={-3,3},
                          ytick={-3,3},
                          ymin=-3.1,ymax=3.1,
                          xmin=-3.7,xmax=3.7
                          ]

                          \addplot+ [domain=0:180,samples=40] ({3*cos(x)},{3*sin(x)}) --cycle;

                          \draw (axis cs: 1,1) node (A) {$R$};

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_17.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_{-3}^3\int_{0}^{\sqrt{9-x^2}}\big(x^3y-x\big)\, dy\, dx = \int_{0}^3\int_{-\sqrt{9-y^2}}^{\sqrt{9-y^2}}\big(x^3y-x\big)\, dx\, dy</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        0
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-sketch-eval-8">
          <!--<webwork xml:id="webwork-ex-double-int-volume-sketch-eval-8">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \iint_R \big(4-3y\big)\, dA</m>,
                  where <m>R</m> is bounded by <m>y=0</m>,
                  <m>y=x/e</m> and <m>y=\ln(x)</m>.
                </p>
              </statement>
              <solution>
                <p>
                  <ol>
                    <li>

                        <!-- START figures/fig_13_02_ex_18.tex -->
                        <image>
                          <shortdescription>The region above the graph of the natural logarithm, but below its tangent line at x=e.</shortdescription>
                          <description>
                            <p>
                              For <m>0\leq x\leq 1</m>, the region is bounded below by the <m>x</m> axis.
                              For <m> 1\leq x\leq e</m>, the lower bound of the region is <m>y=\ln(x)</m>.
                            </p>

                            <p>
                              The upper bound of the region is the line <m>y=x/e</m>.
                              This line is tangent to <m>y=ln(x)</m> at the point <m>(e,1)</m>,
                              and lies above <m>y=\ln(x)</m>.
                              The region is bounded by the portion of this line from the point of tangency to the origin.
                            </p>
                          </description>
                          <latex-image label="img_13_02_ex_18X">

                          \begin{tikzpicture}

                          \begin{axis}[
                          axis on top,
                          xtick={1,2},
                          extra x ticks={2.718},
                          extra x tick labels={$e$},
                          ytick={1},
                          %%extra y ticks={-5,-3,...,7},%
                          ymin=-.5,ymax=1.2,%
                          xmin=-.5,xmax=3.5%
                          ]

                          \addplot [firstcurvestyle,domain=.5:3.25] ({x},{ln(x)});
                          \addplot [firstcurvestyle,domain=-.5:3.25] ({x},{0});
                          \addplot [firstcurvestyle,domain=-.5:3.25] ({x},{x/e});

                          \draw (axis cs: .8,.1) node (A) {$R$};

                          \filldraw (axis cs:2.718,1) circle (2.4pt);

                          \draw (axis cs:2.718,1) node [below right] { $(e,1)$};

                          \end{axis}

                          \end{tikzpicture}

                          </latex-image>
                        </image>
                        <!-- figures/fig_13_02_ex_18.tex END -->

                    </li>

                    <li>
                      <p>
                        <m>\ds \int_{0}^1\int_{ey}^{e^y}\big(4-3y\big)\, dx\, dy = \int_{0}^1\int_{0}^{x/e}\big(4-3y\big)\, dy\, dx+\int_{1}^e\int_{\ln(x) }^{x/e}\big(4-3y\big)\, dy\, dx</m>.
                      </p>
                    </li>

                    <li>
                      <p>
                        <m>3e-7</m>
                      </p>
                    </li>
                  </ol>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-double-int-volume-change-order">

        <introduction>
          <p>
            In the following exercises,
            state why it is difficult/impossible to integrate the iterated integral in the given order of integration.
            Change the order of integration and evaluate the new iterated integral.
          </p>
        </introduction>

        <exercise label="ex-double-int-volume-change-order-1">
          <!--<webwork xml:id="webwork-ex-double-int-volume-change-order-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_0^4\int_{y/2}^2 e^{x^2}\, dx\, dy</m>
                </p>
              </statement>
              <solution>
                <p>
                  Integrating <m>e^{x^2}</m> with respect to <m>x</m> is not possible in terms of elementary functions.
                  <m>\ds \int_0^2\int_0^{2x}e^{x^2}\, dy\, dx = e^4-1</m>.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-change-order-2">
          <!--<webwork xml:id="webwork-ex-double-int-volume-change-order-2">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_0^{\sqrt{\pi/2}}\int_{x}^{\sqrt{\pi/2}} \cos\big(y^2\big)\, dy\, dx</m>
                </p>
              </statement>
              <solution>
                <p>
                  Integrating <m>\cos(y^2)</m> with respect to <m>y</m> is not possible in terms of elementary functions.
                  <m>\ds \int_0^{\sqrt{\pi/2}}\int_0^{y}\cos(y^2)\, dx\, dy = \frac12</m>.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-change-order-3">
          <!--<webwork xml:id="webwork-ex-double-int-volume-change-order-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_0^{1}\int_y^{1} \frac{2y}{x^2+y^2}\, dx\, dy</m>
                </p>
              </statement>
              <solution>
                <p>
                  Integrating <m>\ds\int_y^{1}\frac{2y}{x^2+y^2}\, dx</m> gives <m>\tan^{-1}(1/y)-\pi/4</m>;
                  integrating <m>\tan^{-1}(1/y)</m> is hard.
                </p>

                <p>
                  <m>\ds\int_0^1\int_0^x\frac{2y}{x^2+y^2}\, dy \, dx = \ln(2)</m>.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-change-order-4">
          <!--<webwork xml:id="webwork-ex-double-int-volume-change-order-4">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds \int_{-1}^{1}\int_1^{2} \frac{x\tan^2(y) }{1+\ln(y) }\, dy\, dx</m>
                </p>
              </statement>
              <solution>
                <p>
                  Integrating in the order shown is hard/impossible.
                  By changing the order of integration,
                  we have <m>\ds \int_{1}^{2}\int_{-1}^{1} \frac{x\tan^2(y) }{1+\ln(y) }\, dx\, dy = 0</m>,
                  since the integrand is an odd function with respect to <m>x</m>.
                  Thus the iterated integral evaluates to 0.
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

      </exercisegroup>
      <exercisegroup cols="2" xml:id="exset-double-int-volume-average">

        <introduction>
          <p>
            In the following exercises,
            find the average value of <m>f</m> over the region <m>R</m>.
            Notice how these functions and regions are related to the iterated integrals given in
            <xref first="x13_02_ex_05" last="x13_02_ex_08" text="local">Exercises</xref>.
          </p>
        </introduction>

        <exercise label="ex-double-int-volume-average-1">
          <!--<webwork xml:id="webwork-ex-double-int-volume-average-1">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds f(x,y) =\frac xy+3</m>;<m>R</m> is the rectangle with opposite corners <m>(-1,1)</m> and <m>(1,2)</m>.
                </p>
              </statement>
              <solution>
                <p>
                  average value of <m>f = 6/2 = 3</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-average-2">
          <!--<webwork xml:id="webwork-ex-double-int-volume-average-2">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds f(x,y) = \sin(x) \cos(y)</m>;
                  <m>R</m> is bounded by <m>x=0</m>, <m>x=\pi</m>,
                  <m>y=-\pi/2</m> and <m>y=\pi/2</m>.
                </p>
              </statement>
              <solution>
                <p>
                  average value of <m>f= 4/\pi^2</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-average-3">
          <!--<webwork xml:id="webwork-ex-double-int-volume-average-3">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds f(x,y) = 3x^2-y+2</m>;<m>R</m> is bounded by the lines <m>y=0</m>,
                  <m>y=2-x/2</m> and <m>x=0</m>.
                </p>
              </statement>
              <solution>
                <p>
                  average value of <m>f= \frac{112/3}{4} =28/3</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

        <exercise label="ex-double-int-volume-average-4">
          <!--<webwork xml:id="webwork-ex-double-int-volume-average-4">
              <pg-code>
              </pg-code> -->
              <statement>
                <p>
                  <m>\ds f(x,y) =x^2y-xy^2</m>;
                  <m>R</m> is bounded by <m>y=x</m>,
                  <m>y=1</m> and <m>x=3</m>.
                </p>
              </statement>
              <solution>
                <p>
                  average value of <m>f= \frac{76/15}{2} = \frac{38}{15} \approx 2.53</m>
                </p>
              </solution>
          <!--</webwork>-->
        </exercise>

      </exercisegroup>
    </subexercises>
  </exercises>
</section>
