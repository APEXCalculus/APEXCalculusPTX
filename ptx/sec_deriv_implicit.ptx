<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_imp_deriv">
  <title>Implicit Differentiation</title>
  <introduction>
    <p>
      In the previous sections we learned to find the derivative,
      <m>\lz{y}{x}</m>, or <m>y'</m>,
      when <m>y</m> is given <em>explicitly</em>
      as a function of <m>x</m>.
      That is, if we know <m>y=f(x)</m> for some function <m>f</m>,
      we can find <m>y'</m>.
      For example, given <m>y=3x^2-7</m>,
      we can easily find <m>y'=6x</m>.
      (Here we explicitly state how <m>y</m> depends on <m>x</m>.
      Knowing <m>x</m>, we can directly find <m>y</m>.)
    </p>

    <figure xml:id="vid_deriv_impl_intro" component="video">
      <caption>Video introduction to <xref ref="sec_imp_deriv"/></caption>
      <video youtube="E0mQbLG3Pjo" label="vid_deriv_impl_intro"/>
    </figure>

    <p>
      Sometimes the relationship between <m>y</m> and <m>x</m> is not explicit;
      rather, it is <em>implicit</em>.
      For instance, we might know that <m>x^2-y=4</m>.
      This equality defines a relationship between <m>x</m> and <m>y</m>;
      if we know <m>x</m>, we could figure out <m>y</m>.
      Can we still find <m>y'</m>?
      In this case, sure; we solve for <m>y</m> to get <m>y=x^2-4</m>
      (hence we now know <m>y</m> explicitly)
      and then differentiate to get <m>y'=2x</m>.
    </p>

    <p>
      Sometimes the <em>implicit</em>
      relationship between <m>x</m> and <m>y</m> is complicated.
      Suppose we are given <m>\sin(y)+y^3=6-x^3</m>.
      A graph of this implicit relationship is given in <xref ref="fig_implicit1"/>.
      In this case there is absolutely no way to solve for <m>y</m> in terms of elementary functions.
      The surprising thing is, however,
      that we can still find <m>y'</m> via a process known as
      <term>implicit differentiation</term>.

          <idx><h>implicit differentiation</h></idx>
          <idx><h>derivative</h><h>implicit</h></idx>

    </p>

    <figure xml:id="fig_implicit1">
      <caption>A graph of the implicit relationship <m>\sin(y)+y^3=6-x^3</m></caption>
      <!-- START figures/fig_implicit1.tex -->
      <image xml:id="img_implicit1" width="47%">
        <shortdescription>
          A curve beginning in the second quadrant, forming a gentle corner in the first quadrant, and decreasing into the fourth quadrant.
        </shortdescription>
        <description>
          <p>
            The curve begins in the second quadrant.
            From the left, the curve decreases as <m>x</m> increases.
            The curve slowly flattens out, almost becoming horizontal as the curve crosses the <m>y</m>-axis near the point <m>(0,1.8)</m>.
            When <m>x</m> comes close to 0.75, the curve begins decreasing in the shape of a gentle corner.
            The curve continues decreasing, becoming steepest around the point <m>(0,1.8)</m>, at which it also crosses into the fourth quadrant.
            When <m>x</m> is close to 2, the curve begins to decrease more gently, at around the same rate as the beginning of the curve.
          </p>
        </description>
        <latex-image>

        \begin{tikzpicture}[declare function = {cbrt(\x) = (\x &lt; 0) * -(-\x)^(1/3) + (\x &gt;= 0) * (\x)^(1/3);}]
        \begin{axis}[,xmin=-3.2,xmax=3.2,
        ymin=-3.2,ymax=3.2]
        \addplot[firstcurvestyle,variable=\t,domain=-2.7:1.5,leftarrow] ({cbrt(6-sin(deg(t))-t^3)},{t});
        \addplot[firstcurvestyle,variable=\t,domain=1.5:1.8,-] ({cbrt(6-sin(deg(t))-t^3)},{t});
        \addplot[firstcurvestyle,variable=\t,domain=1.8:3,rightarrow] ({cbrt(6-sin(deg(t))-t^3)},{t});
        \end{axis}
        \end{tikzpicture}

        </latex-image>
      </image>
      <!-- figures/fig_implicit1.tex END -->
    </figure>
  </introduction>

  <subsection>
    <title>The method of implicit differentiation</title>
    <p>
      Implicit differentiation is a technique based on the <xref ref="thm_chain_rule" text="title"/> that is used to find a derivative when the relationship between the variables is given implicitly rather than explicitly
      (solved for one variable in terms of the other).
    </p>

    <p>
      We begin by reviewing the Chain Rule.
      Let <m>f</m> and <m>g</m> be functions of <m>x</m>.
      Then
      <me>
        \lzoo{x}{f(g(x))} = \fp(g(x))\cdot g'(x)
      </me>.
    </p>

    <p>
      Suppose now that <m>y=g(x)</m>.
      We can rewrite the above as
      <mdn>
        <mrow xml:id="eq_implicit1">\lzoo{x}{f(y)}\amp=\fp(y)\cdot y',\amp\amp\text{ or }\amp\lzoo{x}{f(y)}\amp=\fp(y)\cdot\lz{y}{x}</mrow>
      </mdn>.
    </p>

    <p>
      These equations look strange;
      the key concept to learn here is that we can find <m>y'</m> even if we don't exactly know how <m>y</m> and <m>x</m> relate.
    </p>

    <p>
      We demonstrate this process in the following example.
    </p>

    <example xml:id="ex_implicit1">
      <title>Using Implicit Differentiation</title>
      <statement>
        <p>
          Find <m>y'</m> given that <m>\sin(y) + y^3=6-x^3</m>.
        </p>
      </statement>
      <solution component="video">
        <title>Video solution</title>
        <video width="98%" youtube="0baXlbhup0o" xml:id="vid_deriv_impl_ex_1" label="vid_deriv_impl_ex_1" component="video"/>
      </solution>
      <solution>

        <p>
          We start by taking the derivative of both sides
          (thus maintaining the equality.)
          We have:
          <me>
            \lzoo{x}{\sin(y) + y^3}=\lzoo{x}{6-x^3}
          </me>.
        </p>

        <p>
          The right hand side is easy;
          it returns <m>-3x^2</m>.
        </p>

        <p>
          The left hand side requires more consideration.
          We take the derivative term-by-term.
          Using the technique derived from <xref ref="eq_implicit1">Equation</xref> above,
          we can see that
          <me>
            \lzoo{x}{\sin(y)} = \cos(y) \cdot y'
          </me>.
        </p>

        <p>
          We apply the same process to the <m>y^3</m> term.
          <me>
            \lzoo{x}{y^3} = \lzoo{(y)^3} = 3(y)^2\cdot y'
          </me>.
        </p>

        <p>
          Putting this together with the right hand side, we have
          <me>
            \cos(y)y'+3y^2y' = -3x^2
          </me>.
        </p>

        <p>
          Now solve for <m>y'</m>.
          It's important to treat <m>y'</m> as an algebraically independent variable from <m>y</m> and <m>x</m>.
          <md>
            <mrow>\cos(y)y'+3y^2y'\amp = -3x^2</mrow>
            <mrow>\left(\cos(y) +3y^2\right)y' \amp =-3x^2</mrow>
            <mrow>y'\amp =\frac{-3x^2}{\cos(y) +3y^2}</mrow>
          </md>
        </p>

        <p>
          This equation for <m>y'</m> probably seems unusual for it contains both <m>x</m> and <m>y</m> terms.
          How is it to be used?
          We'll address that next.
        </p>
      </solution>
    </example>

    <p>
      Implicit functions are generally harder to deal with than explicit functions.
      With an explicit function, given an <m>x</m> value,
      we have an explicit formula for computing the corresponding <m>y</m> value.
      With an implicit function,
      one often has to find <m>x</m> and <m>y</m> values
      <em>at the same time</em>
      that satisfy the equation.
      It is much easier to demonstrate that a given point satisfies the equation than to actually find such a point.
    </p>

    <p>
      For instance, we can affirm easily that the point
      <m>\left(\sqrt[3]{6},0\right)</m> lies on the graph of the implicit function <m>\sin(y) + y^3=6-x^3</m>.
      Plugging in <m>0</m> for <m>y</m>,
      we see the left hand side is <m>0</m>.
      Setting <m>x=\sqrt[3]6</m>, we see the right hand side is also <m>0</m>;
      the equation is satisfied.
      The following example finds the equation of the tangent line to this function at this point.
    </p>

    <example xml:id="ex_implicit2">
      <title>Using implicit differentiation to find a tangent line</title>
      <statement>
        <p>
          Find the equation of the line tangent to the curve of the implicitly defined function
          <m>\sin(y) + y^3=6-x^3</m> at the point <m>\left(\sqrt[3]6,0\right)</m>.
        </p>
      </statement>
      <solution component="video">
        <title>Video solution</title>
        <video width="98%" youtube="qYrcm4ObwOM" xml:id="vid_deriv_impl_tan_line_prev_ex" label="vid_deriv_impl_tan_line_prev_ex" component="video"/>
      </solution>
      <solution>

        <p>
          In <xref ref="ex_implicit1"/> we found that
          <me>
            y' = \frac{-3x^2}{\cos(y) +3y^2}
          </me>.
        </p>

        <p>
          We find the slope of the tangent line at the point <m>\left(\sqrt[3]6,0\right)</m> by substituting
          <m>\sqrt[3]6</m> for <m>x</m> and <m>0</m> for <m>y</m>.
          Thus at the point <m>\left(\sqrt[3]6,0\right)</m>, we have the slope as
          <me>
            y' = \frac{-3\left(\sqrt[3]{6}\right)^2}{\cos(0) + 3\cdot0^2} = \frac{-3\sqrt[3]{36}}{1} \approx -9.91
          </me>.
        </p>

        <p>
          Therefore the equation of the tangent line to the implicitly defined function
          <m>\sin(y) + y^3=6-x^3</m> at the point <m>\left(\sqrt[3]{6},0\right)</m> is
          <me>
            y = -3\sqrt[3]{36}\left(x-\sqrt[3]{6}\right)+0 \approx -9.91x+18
          </me>.
        </p>

        <p>
          The curve and this tangent line are shown in <xref ref="fig_implicit2"/>.
        </p>

        <figure xml:id="fig_implicit2">
          <caption>The function <m>\sin(y) +y^3 = 6-x^3</m> and its tangent line at the point <m>(\sqrt[3]{6},0)</m></caption>
          <!-- START figures/fig_implicit2.tex -->
          <image xml:id="img_implicit2" width="47%">
            <shortdescription>
              A decreasing curve with a negative tangent line through the negative x-axis
            </shortdescription>
            <description>
              <p>
                The same curve as <xref ref="fig_implicit1"/>, but with a tangent line drawn at
                <m>x=\sqrt[3]{6}</m>. The tangent line is pointing sharply downward.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}[declare function = {cbrt(\x) = (\x &lt; 0) * -(-\x)^(1/3) + (\x &gt;= 0) * (\x)^(1/3);}]
            \begin{axis}[,xmin=-3.2,xmax=3.2,
            ymin=-3.2,ymax=3.2]
            \addplot[firstcurvestyle,variable=\t,domain=-2.7:1.5,leftarrow] ({cbrt(6-sin(deg(t))-t^3)},{t});
            \addplot[firstcurvestyle,variable=\t,domain=1.5:1.8,-] ({cbrt(6-sin(deg(t))-t^3)},{t});
            \addplot[firstcurvestyle,variable=\t,domain=1.8:3,rightarrow] ({cbrt(6-sin(deg(t))-t^3)},{t});
            \addplot [tangentline,domain=1.617:2.017] {-9.9057*x+18};
            \end{axis}
            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit2.tex END -->
        </figure>
      </solution>
    </example>

    <p>
      This suggests a general method for implicit differentiation.
      For the steps below assume <m>y</m> is a function of <m>x</m>.
    </p>

    <p>
      <ol>
        <li>
          <p>
            Take the derivative of each term in the equation.
            Treat the <m>x</m> terms like normal.
            When taking the derivatives of <m>y</m> terms,
            the usual rules apply except that,
            because of the <xref ref="thm_chain_rule"/>,
            we need to multiply each term by <m>y'</m>.
          </p>
        </li>

        <li>
          <p>
            Get all the <m>y'</m> terms on one side of the equal sign and put the remaining terms on the other side.
          </p>
        </li>

        <li>
          <p>
            Factor out <m>y'</m>; solve for <m>y'</m> by dividing.
          </p>
        </li>
      </ol>
    </p>

    <p>
      (Practical Note: when working by hand,
      it may be beneficial to use the symbol
      <m>\frac{dy}{dx}</m> instead of <m>y'</m>,
      as the latter can be easily confused for <m>y</m> or <m>y^1</m>.)
    </p>

    <example xml:id="ex_implicit3">
      <title>Using Implicit Differentiation</title>
      <statement>
        <p>
          Given the implicitly defined function <m>y^3+x^2y^4=1+2x</m>,
          find <m>y'</m>.
        </p>
      </statement>
      <solution component="video">
        <title>Video solution</title>
        <video width="98%" youtube="O5OqJ7a_Ovo" xml:id="vid_deriv_impl_ex_2" label="vid_deriv_impl_ex_2" component="video"/>
      </solution>
      <solution>

        <p>
          We will take the implicit derivatives term by term.
          The derivative of <m>y^3</m> is <m>3y^2y'</m>.
        </p>

        <p>
          The second term, <m>x^2y^4</m>, is a little tricky.
          It requires the <xref ref="thm_ProductRule" text="title"/> as it is the product of two functions of <m>x</m>:
          <m>x^2</m> and <m>y^4</m>.
          Its derivative is <m>x^2(4y^3y') + 2xy^4</m>.
          The first part of this expression requires a <m>y'</m> because we are taking the derivative of a <m>y</m> term.
          The second part does not require it because we are taking the derivative of <m>x^2</m>.
        </p>

        <p>
          The derivative of the right hand side is easily found to be <m>2</m>.
          In all, we get:
          <me>
            3y^2y' + 4x^2y^3y' + 2xy^4 = 2
          </me>.
        </p>

        <p>
          Move terms around so that the left side consists only of the <m>y'</m> terms and the right side consists of all the other terms:
          <me>
            3y^2y' + 4x^2y^3y' = 2-2xy^4
          </me>.
        </p>

        <p>
          Factor out <m>y'</m> from the left side and solve to get
          <me>
            y' = \frac{2-2xy^4}{3y^2+4x^2y^3}
          </me>.
        </p>

        <p>
          To confirm the validity of our work,
          let's find the equation of a tangent line to this function at a point.
          It is easy to confirm that the point <m>(0,1)</m> lies on the graph of this function.
          At this point, <m>y' = 2/3</m>.
          So the equation of the tangent line is <m>y = 2/3(x-0)+1</m>.
          The function and its tangent line are graphed in <xref ref="fig_implicit4"/>.
        </p>

        <figure xml:id="fig_implicit4">
          <caption>A graph of the implicitly defined function <m>y^3+x^2y^4=1+2x</m> along with its tangent line at the point <m>(0,1)</m></caption>
          <!-- START figures/fig_implicit4.tex -->
          <image xml:id="img_implicit4" width="47%">
            <shortdescription>
              A curve with two distinct segments and a tangent line with a positive slope
            </shortdescription>
            <description>
              Two curves are drawn in the <m>xy</m>-plane.
              The left curve stretches upwards from the left side of the <m>y</m> axis, curving slightly to the left.
              As <m>y</m> approaches -2, the curve begins to widen to the left, creating a bump in the curve.
              As the curve crosses the <m>x</m> axis, the curve moves towards the right, no longer increasing and becoming more horizontal as <m>x</m> increases.
              At the point <m>(0,1)</m>, a tangent line is drawn, with a moderate positive slope.
              This point corresponds to the corner at which the curve begins to become horizontal.
              At this point, the curve passes the vertical line test, but does not at most other points on the graph.
              The second curve begins to the right of the <m>y</m>-axis, as a line stretching upwards from the bottom of the <m>y</m>-axis.
              As <m>x</m> approaches 1, the curve also begins to become horizontal as <m>x</m> increases.
              The entire second curve lies in the fourth quadrant.
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-1.5,xmax=10.5,
            ymin=-10.5,ymax=2.49,]

            \addplot[firstcurvestyle,smooth] coordinates {(-0.324,-9.34) (-0.336,-8.66) (-0.351,-7.95) (-0.371,-7.13) (-0.396,-6.3) (-0.414,-5.68) (-0.451,-4.91) (-0.472,-4.48)(-0.497,-4.02) (-0.525,-3.57) (-0.56,-3.15) (-0.61,-2.63)(-0.664,-2.18) (-0.727,-1.71) (-0.762,-1.29) (-0.668,-0.805)(-0.513,-0.29) (-0.453,0.439) (-0.308,0.71) (0.0816,1.05)(0.452,1.15) (0.893,1.13) (1.33,1.08) (1.79,1.02) (2.24,0.975)(2.82,0.925) (3.4,0.881) (4.11,0.844) (4.91,0.781) (5.77,0.766)(6.76,0.74) (7.59,0.722) (8.26,0.706) (8.93,0.689) (9.69,0.671)};

            \addplot[firstcurvestyle,smooth] coordinates {(9.6,-0.677) (9.13,-0.696) (8.66,-0.697) (8.21,-0.707) (7.72,-0.722)(7.3,-0.738) (6.79,-0.754) (5.98,-0.778) (5.1,-0.81) (4.34,-0.858)(3.84,-0.893) (3.4,-0.927) (2.77,-0.99) (2.27,-1.07) (1.82,-1.17)(1.38,-1.34) (0.97,-1.7) (0.779,-2.1) (0.678,-2.5) (0.593,-3.)(0.534,-3.66) (0.483,-4.38) (0.444,-5.04) (0.415,-5.71) (0.393,-6.38)(0.375,-7.05) (0.362,-7.59) (0.343,-8.38) (0.334,-8.9) (0.322,-9.33)(0.317,-9.83) };

            \addplot [tangentline,domain=-1:2] {2/3*(x)+1};
            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit4.tex END -->
        </figure>

        <p>
          Notice how our curve looks much different than for functions we have seen.
          For one, it fails the vertical line test,
          and so the complete curve is not truly representing <m>y</m> as a function of <m>x</m>.
          But when we indicate we are interested in the derivative at <m>(0,1)</m>,
          we are indicating that we want the function defined by the small portion of the curve that passes through <m>(0,1)</m>,
          and that small portion does pass the vertical line test.
          Such functions are important in many areas of mathematics,
          so developing tools to deal with them is also important.
        </p>
      </solution>
    </example>

    <example xml:id="ex_implicit5">
      <title>Using Implicit Differentiation</title>
      <statement>
        <p>
          Given the implicitly defined function <m>\sin\mathopen{}\left(x^2y^2\right)\mathclose{}+y^3=x+y</m>,
          find <m>y'</m>.
        </p>
      </statement>
      <solution component="video">
        <title>Video solution</title>
        <video width="98%" youtube="BMn-BU6VTQU" xml:id="vid_deriv_impl_ex_3" label="vid_deriv_impl_ex_3" component="video"/>
      </solution>
      <solution>

        <p>
          Differentiating term by term,
          we find the most difficulty in the first term.
          It requires both the <xref ref="thm_chain_rule" text="title"/> and <xref ref="thm_ProductRule" text="title"/>.
          <md>
            <mrow>\lzoo{x}{\sin\mathopen{}\left(x^2y^2\right)\mathclose{}} \amp = \cos\mathopen{}\left(x^2y^2\right)\mathclose{}\cdot\lzoo{x}{x^2y^2}</mrow>
            <mrow>\amp = \cos\mathopen{}\left(x^2y^2\right)\mathclose{}\cdot\left(x^2(2yy')+2xy^2\right)</mrow>
            <mrow>\amp = 2\left(x^2yy'+xy^2\right)\cos\mathopen{}\left(x^2y^2\right)\mathclose{}</mrow>
          </md>.
        </p>

        <p>
          We leave the derivatives of the other terms to the reader.
          After taking the derivatives of both sides, we have
          <me>
            2\left(x^2yy'+xy^2\right)\cos\mathopen{}\left(x^2y^2\right)\mathclose{} + 3y^2y' = 1 + y'
          </me>.
        </p>

        <p>
          We now have to be careful to properly solve for <m>y'</m>,
          particularly because of the product on the left.
          It is best to multiply out the product.
          Doing this, we get
          <me>
            2x^2y\cos\mathopen{}\left(x^2y^2\right)\mathclose{}y' + 2xy^2\cos\mathopen{}\left(x^2y^2\right)\mathclose{} + 3y^2y' = 1 + y'
          </me>.
        </p>

        <p>
          From here we can safely move around terms to get the following:
          <me>
            2x^2y\cos\mathopen{}\left(x^2y^2\right)\mathclose{}y' + 3y^2y' - y' = 1 - 2xy^2\cos\mathopen{}\left(x^2y^2\right)\mathclose{}
          </me>.
        </p>

        <p>
          Then we can solve for <m>y'</m> to get
          <me>
            y' = \frac{1 - 2xy^2\cos\mathopen{}\left(x^2y^2\right)\mathclose{}}{2x^2y\cos\mathopen{}\left(x^2y^2\right)\mathclose{}+3y^2-1}
          </me>.
        </p>

        <p>
          A graph of this implicit function is given in <xref ref="fig_implicit5"/>.
        </p>

        <figure xml:id="fig_implicit5">
          <caption>A graph of the implicitly defined curve <m>\sin\mathopen{}\left(x^2y^2\right)\mathclose{}+y^3=x+y</m></caption>
          <!-- START figures/fig_implicit5.tex -->
          <image xml:id="img_implicit5" width="47%">
            <shortdescription>
              A curve beginning in the third quadrant passing through the points (0,-1), (0,0), (0,1).
            </shortdescription>
            <description>
              <p>
                The curve begins in the third quadrant.
                From there, the curve bends slightly back and increases, crossing above itself.
                The curve extends to the right, increasing almost linearly as it crosses the <m>y</m>-axis at <m>y = -1</m> into the fourth quadrant.
                The curve continues to increase as such until it reaches a point close to <m>(\frac{1}{2},-\frac{3}{4}</m>.
                The curve then bends back, increasing towards the top left linearly.
                It then crosses the origin and passes into the second quadrant.
                The curve quickly bends towards the right, crossing the <m>y</m>-axis at <m>y = 1</m> into the first quadrant.
                From there, the curve continues towards the right while slightly increasing.
                The curves rises sharply at <m>x = 1.5</m>, before decreasing again.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-1.95,xmax=1.99,
            ymin=-1.95,ymax=1.95,]
            \addplot+[smooth] coordinates {(-1.91,-1.57) (-1.82,-1.61) (-1.68,-1.61) (-1.7,-1.49) (-1.74,-1.38)(-1.76,-1.28) (-1.64,-1.26) (-1.54,-1.29) (-1.36,-1.35) (-1.2,-1.42)(-1.09,-1.46) (-0.989,-1.49) (-0.86,-1.5) (-0.714,-1.45)(-0.566,-1.35) (-0.327,-1.18) (-0.15,-1.08)(0.107,-0.947) (0.216,-0.895) (0.332,-0.832) (0.429,-0.755) (0.464,-0.623) (0.429,-0.52) (0.308,-0.335)(0.142,-0.144) (-0.071,0.0714) (-0.239,0.261) (-0.336,0.45) (-0.336,0.622) (-0.278,0.757) (-0.17,0.884) (-0.046,0.975)(0.0714,1.03) (0.216,1.07) (0.48,1.09) (0.714,1.07) (0.929,1.05)(1.15,1.07) (1.24,1.13) (1.27,1.25) (1.28,1.37) (1.29,1.49)(1.36,1.58) (1.47,1.57) (1.59,1.52) (1.68,1.48) (1.79,1.43)(1.89,1.39) (1.98,1.36) (1.98,1.6)};
            \end{axis}

            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit5.tex END -->
        </figure>

        <p>
          It is easy to verify that the points <m>(0,0)</m>,
          <m>(0,1)</m> and <m>(0,-1)</m> all lie on the graph.
          We can find the slopes of the tangent lines at each of these points using our formula for <m>y'</m>.

          <ul>
            <li>At <m>(0,0)</m>, the slope is <m>-1</m>.</li>

            <li>At <m>(0,1)</m>, the slope is <m>1/2</m>.</li>

            <li>At <m>(0,-1)</m>, the slope is also <m>1/2</m>.</li>
          </ul>

          The tangent lines have been added to the graph of the function in <xref ref="fig_implicit6"/>.
        </p>

        <figure xml:id="fig_implicit6">
          <caption>A graph of the implicitly defined curve <m>\sin\mathopen{}\left(x^2y^2\right)\mathclose{}+y^3=x+y</m> and certain tangent lines</caption>
          <!-- START figures/fig_implicit6.tex -->
          <image xml:id="img_implicit6" width="47%">
            <shortdescription>
              A curve beginning in the third quadrant passing through the points (0,-1), (0,0), (0,1), with tangent lines at those points.
            </shortdescription>
            <description>
              <p>
                The graph in <xref ref="fig_implicit5"/>, with tagent lines drawn at <m>(0,-1)</m>, <m>(0,0)</m>, and <m>(0,1)</m>.
                The tangent line at <m>(0,-1)</m> has a positive slope less than 1.
                The tangent line at <m>(0,0)</m> has a negative slope, close to -1.
                The tangent line at <m>(0,1)</m> has a positive slope, less than 1.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-1.95,xmax=1.99,
            ymin=-1.95,ymax=1.95,]
            \addplot+[smooth] coordinates {(-1.91,-1.57) (-1.82,-1.61) (-1.68,-1.61) (-1.7,-1.49) (-1.74,-1.38)(-1.76,-1.28) (-1.64,-1.26) (-1.54,-1.29) (-1.36,-1.35) (-1.2,-1.42)(-1.09,-1.46) (-0.989,-1.49) (-0.86,-1.5) (-0.714,-1.45)(-0.566,-1.35) (-0.327,-1.18) (-0.15,-1.08)(0.107,-0.947) (0.216,-0.895) (0.332,-0.832) (0.429,-0.755) (0.464,-0.623) (0.429,-0.52) (0.308,-0.335)(0.142,-0.144) (-0.071,0.0714) (-0.239,0.261) (-0.336,0.45) (-0.336,0.622) (-0.278,0.757) (-0.17,0.884) (-0.046,0.975)(0.0714,1.03) (0.216,1.07) (0.48,1.09) (0.714,1.07) (0.929,1.05)(1.15,1.07) (1.24,1.13) (1.27,1.25) (1.28,1.37) (1.29,1.49)(1.36,1.58) (1.47,1.57) (1.59,1.52) (1.68,1.48) (1.79,1.43)(1.89,1.39) (1.98,1.36) (1.98,1.6)};

            \addplot [tangentline,domain=-.5:.5] {-x};
            \addplot [tangentline,domain=-.5:.5] {0.5*x+1};
            \addplot [tangentline,domain=-.5:.5] {0.5*(x-0)-1};
            \end{axis}
            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit6.tex END -->
        </figure>
      </solution>
    </example>

    <p>
      Quite a few <q>famous</q> curves have equations that are given implicitly.
      We can use implicit differentiation to find the slope at various points on those curves.
      We investigate two such curves in the next examples.
    </p>

    <example xml:id="ex_implicit7">
      <title>Finding slopes of tangent lines to a circle</title>
      <statement>
        <p>
          Find the slope of the tangent line to the circle
          <m>x^2+y^2=1</m> at the point <m>\left(1/2, \sqrt{3}/2\right)</m>.
        </p>
      </statement>
      <solution>
        <p>
          Taking derivatives, we get <m>2x+2yy'=0</m>.
          Solving for <m>y'</m> gives:
          <me>
            y' = \frac{-x}{y}
          </me>.
        </p>

        <p>
          This is a clever formula.
          Recall that the slope of the line through the origin and the point <m>(x,y)</m> on the circle will be <m>y/x</m>.
          We have found that the slope of the tangent line to the circle at that point is the opposite reciprocal of <m>y/x</m>, namely,
          <m>-x/y</m>.
          Hence these two lines are always perpendicular.
        </p>

        <p>
          At the point <m>\left(1/2, \sqrt{3}/2\right)</m>,
          we have the tangent line's slope as
          <me>
            y' = \frac{-1/2}{\sqrt{3}/2} = \frac{-1}{\sqrt{3}} \approx -0.577
          </me>.
        </p>

        <p>
          A graph of the circle and its tangent line at
          <m>\left(1/2,\sqrt{3}/2\right)</m> is given in <xref ref="fig_implicit7"/>,
          along with a thin dashed line from the origin that is perpendicular to the tangent line.
          (It turns out that all normal lines to a circle pass through the center of the circle.)
        </p>

        <figure xml:id="fig_implicit7">
          <caption>The unit circle with its tangent line at <m>(1/2,\sqrt{3}/2)</m></caption>
          <!-- START figures/fig_implicit7.tex -->
          <image xml:id="img_implicit7" width="47%">
            <shortdescription>
              A circle of radius 1 centered at the origin with a tangent line drawn at a point in the first quadrant.
            </shortdescription>
            <description>
              <p>
                A circle of radius 1 centered at the origin.
                A dashed line extends from the origin to a tangent line at the point <m>(\frac{1}{2},\frac{\sqrt{3}}{2})</m>.
                At that point a tangent line is drawn with a slight negative slope.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-1.2,xmax=1.2,
            ymin=-1.2,ymax=1.2,
            axis equal]
            \addplot+[domain=0:pi,samples=200,-] ({cos(deg(2*x))},{sin(deg(2*x))});
            \addplot [tangentline,domain=.1:.9] {-.577*(x-.5)+.866};
            \addplot [soliddot] coordinates {(0.5,.866)} node[above right] {$\left(1/2,\sqrt{3}/2\right)$};
            \addplot [normallineseg,domain=0:0.5]{1/0.577*x};
            \end{axis}
            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit7.tex END -->
        </figure>
      </solution>
    </example>

    <p>
      This section has shown how to find the derivatives of implicitly defined functions,
      whose graphs include a wide variety of interesting and unusual shapes.
      Implicit differentiation can also be used to further our understanding of
      <q>regular</q> differentiation.
    </p>

    <p>
      One hole in our current understanding of derivatives is this:
      what is the derivative of the square root function?
      That is,
      <me>
        \lzoo{x}{\sqrt{x}} = \lzoo{x}{x^{1/2}} = \text{?}
      </me>
    </p>

    <p>
      We allude to a possible solution,
      as we can write the square root function as a power function with a rational (or,
      fractional) power.
      We are then tempted to apply the <xref ref="thm_PowerRule" text="title"/> and obtain
      <me>
        \lzoo{x}{x^{1/2}} = \frac{1}{2}x^{-1/2} = \frac{1}{2\sqrt{x}}
      </me>.
    </p>

    <p>
      The trouble with this is that the <xref ref="thm_PowerRule" text="title"/> was initially defined only for positive integer powers,
      <m>n \gt 0</m>.
      While we did not justify this at the time,
      generally the <xref ref="thm_PowerRule" text="title"/> is proved using something called the Binomial Theorem,
      which deals only with positive integers.
      The <xref ref="thm_QuotientRule" text="title"/> allowed us to extend the <xref ref="thm_PowerRule" text="title"/> to negative integer powers.
      Implicit Differentiation allows us to extend the <xref ref="thm_PowerRule" text="title"/> to rational powers,
      as shown below.
    </p>

    <p>
      Let <m>y = x^{m/n}</m>,
      where <m>m</m> and <m>n</m> are integers with no common factors
      (so <m>m=2</m> and <m>n=5</m> is fine,
      but <m>m=2</m> and <m>n=4</m> is not).
      We can rewrite this explicit function implicitly as <m>y^n = x^m</m>.
      Now apply implicit differentiation.
      <md>
        <mrow>y \amp = x^{m/n}</mrow>
        <mrow>y^n \amp = x^m</mrow>
        <mrow>\lzoo{x}{y^n} \amp = \lzoo{x}{x^m}</mrow>
        <mrow>n\cdot y^{n-1}\cdot y' \amp = m\cdot x^{m-1}</mrow>
        <mrow>y'\amp = \frac{m}{n} \frac{x^{m-1}}{y^{n-1}}\amp\amp\text{(now substitute }x^{m/n}\text{ for }y\text{)}</mrow>
        <mrow>\amp = \frac{m}{n} \frac{x^{m-1}}{(x^{m/n})^{n-1}}\amp\amp\text{(apply lots of algebra)}</mrow>
        <mrow>\amp = \frac{m}n x^{(m-n)/n}</mrow>
        <mrow>\amp = \frac{m}n x^{m/n -1}</mrow>
      </md>.
    </p>

    <p>
      The above derivation is the key to the proof extending the <xref ref="thm_PowerRule" text="title"/> to rational powers.
      Using limits,
      we can extend this once more to include <em>all</em>
      powers, including irrational
      (even transcendental!)
      powers, giving the following theorem.
    </p>

    <theorem xml:id="thm_finalpower">
      <title>Power Rule for Differentiation</title>
      <statement>
        <p>
          Let <m>f(x) = x^n</m>, where <m>n\neq 0</m> is a real number.
          Then <m>f</m> is differentiable on its domain,
          except possibly at <m>x=0</m>,
          and <m>\fp(x) = n\cdot x^{n-1}</m>.
              <idx><h>derivative</h><h>Power Rule</h></idx>
              <idx><h>Power Rule</h><h>differentiation</h></idx>
        </p>
      </statement>
    </theorem>

    <p>
      This theorem allows us to say the derivative of <m>x^\pi</m> is <m>\pi x^{\pi -1}</m>.
    </p>

    <p>
      We now apply this final version of the <xref ref="thm_finalpower" text="title"/> in the next example,
      the second investigation of a <q>famous</q> curve.
    </p>

    <!-- TODO: I have a geogebra applet I already made for this next example: https://ggbm.at/AP9r592M. It may need to be refined to hide some of the underlying mechanics.  -->

    <example xml:id="ex_implicit8">
      <title>Using the Power Rule</title>
      <statement>
        <p>
          Find the slope of <m>x^{2/3}+y^{2/3}=8</m> at the point <m>(8,8)</m>.
        </p>
      </statement>
      <solution>
        <p>
          This is a particularly interesting curve called an <term>astroid</term>.
          It is the shape traced out by a point on the edge of a circle that is rolling around inside of a larger circle,
          as shown in <xref ref="fig_implicit9"/>.
        </p>

        <figure xml:id="fig_implicit9">
          <caption>An astroid, traced out by a point on the smaller circle as it rolls inside the larger circle</caption>
          <!-- START figures/fig_implicit9.tex -->
          <image xml:id="img_implicit9" width="47%">
            <shortdescription>
              A four pointed star with rounded edges, surrounded by a dashed circle.
            </shortdescription>
            <description>
              <p>
                A dashed circle of radius 20 entirely contains the curve.
                In each quadrant curves connect the points on the x and y axis which also lie on the circle.
                This gives the overall curve the appearence of a diamond with sides curved towards the inside.
                In the third quadrant a smaller circle is drawn which touches both the outer circle and the curve.
                The point on the circle touching the curve is highlighted blue.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-24,xmax=24,
            ymin=-24,ymax=24,
            axis equal]
            \addplot+[domain=0:pi,samples=200,-] ({22.63*cos(deg(2*x))^3},{22.63*sin(deg(2*x))^3});
            \addplot+[domain=0:pi,samples=200,-] ({22.63*cos(deg(2*x))},{22.63*sin(deg(2*x))});
            \addplot+[domain=0:pi,samples=100,-] ({5.66*cos(deg(2*x))-12},{5.66*sin(deg(2*x))-12});
            \addplot [soliddot] coordinates {(-8,-8)};
            \end{axis}
            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit9.tex END -->
        </figure>

        <p>
          To find the slope of the astroid at the point <m>(8,8)</m>,
          we take the derivative implicitly.
          <md>
            <mrow>\frac{2}{3}x^{-1/3}+\frac{2}{3}y^{-1/3}y'\amp =0</mrow>
            <mrow>\frac{2}{3}y^{-1/3}y' \amp = -\frac{2}{3}x^{-1/3}</mrow>
            <mrow>y'\amp =-\frac{x^{-1/3}}{y^{-1/3}}</mrow>
            <mrow>y'\amp =-\frac{y^{1/3}}{x^{1/3}} = -\sqrt[3]{\frac{y}{x}}</mrow>
          </md>.
        </p>

        <p>
          Plugging in <m>x=8</m> and <m>y=8</m>,
          we get a slope of <m>-1</m>.
          The astroid, with its tangent line at <m>(8,8)</m>,
          is shown in <xref ref="fig_implicit8"/>.
        </p>

        <figure xml:id="fig_implicit8">
          <caption>An astroid with a tangent line</caption>
          <!-- START figures/fig_implicit8.tex -->
          <image xml:id="img_implicit8" width="47%">
            <shortdescription>
              A previously described astroid with a tangent line in the first quadrant.
            </shortdescription>
            <description>
              <p>
                The curve sketched in <xref ref="fig_implicit9"/> with a tangent line at <m>(8,8)</m>.
                It has a slope of -1.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-24,xmax=24,
            ymin=-24,ymax=24,
            axis equal]
            \addplot+[domain=0:pi,samples=200,-] ({22.63*cos(deg(2*x))^3},{22.63*sin(deg(2*x))^3});
            \addplot [tangentline,domain=1:15] {-1*(x-8)+8};
            \addplot [soliddot] coordinates {(8,8)} node[above right] {$(8,8)$};
            \end{axis}
            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit8.tex END -->
        </figure>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>Implicit Differentiation and the Second Derivative</title>
    <p>
      We can use implicit differentiation to find higher order derivatives.
      In theory, this is simple:
      first find <m>\lz{y}{x}</m>, then take its derivative with respect to <m>x</m>.
      In practice,
      it is not hard, but it often requires a bit of algebra.
      We demonstrate this in an example.
    </p>

    <example xml:id="ex_implicit9">
      <title>Finding the second derivative</title>
      <statement>
        <p>
          Given <m>x^2+y^2=1</m>, find <m>\lzn{2}{y}{x} = y''</m>.
        </p>
      </statement>
      <solution component="video">
        <title>Video solution</title>
        <video width="98%" youtube="V6piqsjn2mk" xml:id="vid_deriv_impl_second_deriv" label="vid_deriv_impl_second_deriv" component="video"/>
      </solution>
      <solution>

        <p>
          We found that <m>y' = \lz{y}{x} = -x/y</m> in <xref ref="ex_implicit7"/>.
          To find <m>y''</m>, we apply implicit differentiation to <m>y'</m>.
          <md>
            <mrow>y'' \amp = \lzoo{x}{y'}</mrow>
            <mrow>\amp = \lzoo{x}{-\frac{x}{y}}\amp\amp\text{(Now use the Quotient Rule.)}</mrow>
            <mrow>\amp = -\frac{y\cdot1 - x(y')}{y^2}\amp\amp\text{replace }y'\text{ with }-x/y\text{:}</mrow>
            <mrow>\amp = -\frac{y-x(-x/y)}{y^2}</mrow>
            <mrow>\amp = -\frac{y+x^2/y}{y^2}</mrow>
          </md>.
        </p>

        <p>
          While this is not a particularly simple expression, it is usable.
          We can see that <m>y'' \gt 0</m> when <m>y\lt 0</m> and <m>y''\lt 0</m> when <m>y \gt 0</m>.
          In <xref ref="sec_concavity"/>,
          we will see how this relates to the shape of the graph.
        </p>

        <p>
          Also, if we remember that we are only considering points on the curve <m>x^2+y^2=1</m>,
          then we know that <m>x^2=1-y^2</m>.
          So we can replace the <m>x^2</m> in the expression for <m>y''</m> to get
          <me>
            y''=-\frac{y+\left(1-y^2\right)/y}{y^2}=-\frac{1}{y^3}
          </me>
          which is a simpler expression.
          Recognizing when simplifications like this are possible is not always easy.
        </p>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>Logarithmic Differentiation</title>
    <p>
      Consider the function <m>y=x^x</m>;
      it is graphed in <xref ref="fig_logdiffa"/>.
      It is well-defined for <m>x \gt 0</m> and we might be interested in finding equations of lines tangent and normal to its graph.
      How do we take its derivative?

                <idx><h>logarithmic differentiation</h></idx>
                <idx><h>derivative</h>
                     <h>logarithmic</h>
                </idx>
    </p>
    <aside xml:id="aside-derivative-implicit-00">
      <p>
        In calculus the expression <m>0^0</m> is also considered well-defined and equal to <m>1</m>.
        This is easily confused with a limit of the <em>form</em>
        <m>0^0</m>, which is indeterminate.
        We skirt the issue here.
      </p>
    </aside>


    <figure xml:id="fig_logdiffa">
      <caption>A plot of <m>y=x^x</m></caption>
      <!-- START figures/fig_logdiffa.tex -->
      <image xml:id="img_logdiffa" width="47%">
        <shortdescription>
          An exponential curve with a discontinuity at (0,1). It decreases slightly before increasing.
        </shortdescription>
        <description>
          <p>
            The curve is entirely contained within the first quadrant.
            At the point <m>(0,1)</m> there is a discontinuity.
            The curve begins decreasing, reaching a minimum at around <m>(0.3,0.7)</m>. 
            After that point, the curve increases exponentially.
          </p>
        </description>
        <latex-image>

        \begin{tikzpicture}
        \begin{axis}[xmin=-0.1,xmax=2.2,
        ymin=-.1,ymax=4.2]
        \addplot+[domain=0.001:2,rightarrow,samples=50] {x^x};
        \addplot[hollowdot] coordinates{(0,1)};
        \end{axis}
        \end{tikzpicture}

        </latex-image>
      </image>
      <!-- figures/fig_logdiffa.tex END -->
    </figure>

    <p>
      The function is not a power function:
      it has a <q>power</q> of <m>x</m>, not a constant.
      It is not an exponential function either:
      it has a <q>base</q> of <m>x</m>, not a constant.
    </p>

    <p>
      A differentiation technique known as
      <term>logarithmic differentiation</term> becomes useful here.
      The basic principle is this:
      take the natural log of both sides of an equation <m>y=f(x)</m>,
      then use implicit differentiation to find <m>y'</m>.
      We demonstrate this in the following example.
    </p>
    
    <example xml:id="ex_implicit10">
      <title>Using Logarithmic Differentiation</title>
      <statement>
        <p>
          Given <m>y=x^x</m>, use logarithmic differentiation to find <m>y'</m>.
        </p>
      </statement>
      <solution component="video">
        <title>Video solution</title>
        <figure xml:id="vid_deriv_implicit_logarithmic1" component="video">
          <caption>
            Two approaches to solving <xref ref="ex_implicit10"/>.
            First, taking the log of both sides.
            Second, using the inverse relationship <m>e^{\ln(x)}=x</m>.  
          </caption>
          <video youtube="6eL6WBlmItk" label="vid_deriv_implicit_logarithmic1"/>
        </figure>
      </solution>

      <solution>
        <p>
          As suggested above,
          we start by taking the natural log of both sides then applying implicit differentiation.
          <md>
            <mrow>y \amp = x^x\amp</mrow>
            <mrow>\ln(y) \amp = \ln(x^x)\amp\amp\text{(apply logarithm rule)}</mrow>
            <mrow>\ln(y) \amp = x\ln(x) \amp\amp\text{(now use implicit differentiation)}</mrow>
            <mrow>\lzoo{x}{\ln(y)} \amp = \lzoo{x}{x\ln(x)}</mrow>
            <mrow>\frac{y'}{y} \amp = \ln(x) + x\cdot\frac{1}{x}\amp</mrow>
            <mrow>\frac{y'}{y} \amp = \ln(x) + 1\amp</mrow>
            <mrow>y' \amp = y\left(\ln(x) +1\right) \amp\amp\text{(substitute }y=x^x\text{)}</mrow>
            <mrow>y' \amp = x^x\left(\ln(x) +1\right)\amp</mrow>
          </md>.
        </p>

        <p>
          To <q>test</q> our answer,
          let's use it to find the equation of the tangent line at <m>x=1.5</m>.
          The point on the graph our tangent line must pass through is <m>\left(1.5, 1.5^{1.5}\right) \approx (1.5, 1.837)</m>.
          Using the equation for <m>y'</m>, we find the slope as
          <me>
            y' = 1.5^{1.5}\left(\ln(1.5) +1\right) \approx 1.837(1.405) \approx 2.582
          </me>.
        </p>

        <p>
          Thus the equation of the tangent line is (approximately) <m>y \approx 2.582(x-1.5)+1.837</m>.
          <xref ref="fig_implicit10"/>
          graphs <m>y=x^x</m> along with this tangent line.
        </p>

        <figure xml:id="fig_implicit10">
          <caption>A graph of <m>y=x^x</m> and its tangent line at <m>x=1.5</m></caption>
          <!-- START figures/fig_implicit10.tex -->
          <image xml:id="img_implicit10" width="47%">
            <shortdescription>
              The previously described exponential curve with a tangent line in the increasing part of the curve.
            </shortdescription>
            <description>
              <p>
                The graph shown in <xref ref="fig_logdiffa"/>, with a tangent line at
                <m>(1.5,1.5^{1.5})</m>. It has a slope of around 2.6.
              </p>
            </description>
            <latex-image>

            \begin{tikzpicture}
            \begin{axis}[xmin=-0.1,xmax=2.2,
            ymin=-.1,ymax=4.2]
            \addplot+[domain=0.001:2,rightarrow,samples=50] {x^x};
            \addplot[hollowdot] coordinates{(0,1)};
            \addplot[tangentline,domain=1:2] {2.582 * (x - 1.5) + 1.837};
            \addplot[soliddot] coordinates{(1.5,1.837)} node[below right] {$\left(1.5,1.5^{1.5}\right)$};
            \end{axis}
            \end{tikzpicture}

            </latex-image>
          </image>
          <!-- figures/fig_implicit10.tex END -->
        </figure>
      </solution>
    </example>
    <p xml:id="vidint_deriv_impl_ex5" component="video">
      We would not have been able to compute the derivative of the function in <xref ref="ex_implicit10"/>
      without logarithmic differentiation.
      But the method is also useful in cases where the product and quotient rules could be used,
      but logarithmic differentiation is simpler.
      The video in <xref ref="vid_deriv_impl_ex_5"/> provides such an example.
    </p>

    <figure xml:id="vid_deriv_impl_ex_5" component="video">
      <caption>Using logarithmic differentiation</caption>
      <video youtube="3Cv2EgjH9ZE" label="vid_deriv_impl_ex_5"/>
    </figure>

    <p>
      Implicit differentiation proves to be useful as it allows us to find the instantaneous rates of change of a variety of functions.
      In particular,
      it extended the <xref ref="thm_finalpower" text="title"/> to rational exponents,
      which we then extended to all real numbers.
      In <xref ref="sec_deriv_inverse_function"/>,
      implicit differentiation will be used to find the derivatives of
      <term>inverse</term> functions,
      such as <m>y=\sin^{-1}(x)</m>.
    </p>
  </subsection>

  <exercises>
    <subexercises xml:id="TaC-deriv-implicit">
      <title>Terms and Concepts</title>
      <exercise label="TaC-deriv-implicit-1">
        <webwork xml:id="webwork-TaC-deriv-implicit-1">
          <statement>
            <p>
              In your own words,
              explain the difference between implicit functions and explicit functions.
            </p>
            <p>
              <var form="essay"/>
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise label="TaC-deriv-implicit-2">
        <webwork xml:id="webwork-TaC-deriv-implicit-2">
          <pg-code>
            Context()->strings->add('the chain rule'=>{});
            Context()->strings->add(
              'chain rule' => {alias => 'chain rule'},
              'chain' => {alias => 'chain rule'}
            );
            $ans=Compute("the chain rule");
          </pg-code>
          <statement>
            <p>
              Implicit differentiation is based on what other differentiation rule?
            </p>
            <p>
              <var name="$ans" width="30"/>
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise label="TaC-deriv-implicit-3">
        <webwork xml:id="webwork-TaC-deriv-implicit-3">
          <pg-code>
            $tf=PopUp(['?','True','False'],1);
          </pg-code>
          <statement>
            <p>
              <var name="$tf" form="popup"/>
              Implicit differentiation can be used to find the derivative of <m>y=\sqrt{x}</m>.
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise label="TaC-deriv-implicit-4">
        <webwork xml:id="webwork-TaC-deriv-implicit-4">
          <pg-code>
            $tf=PopUp(['?','True','False'],1);
          </pg-code>
          <statement>
            <p>
              <var name="$tf" form="popup"/>
              Implicit differentiation can be used to find the derivative of <m>y=x^{3/4}</m>.
            </p>
          </statement>
        </webwork>
      </exercise>
    </subexercises>

    <subexercises>
      <title>Problems</title>
      <exercisegroup cols="2" xml:id="exset-deriv-implicit-power">
        <introduction>
          <p>
            Compute the derivative of the given function.
          </p>
        </introduction>

        <exercise label="ex-deriv-implicit-power-1">
          <webwork xml:id="webwork-ex-deriv-implicit-power-1">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $pm = list_random('+','-');
              if($envir{problemSeed}==1){$fname='f';$x='x';$pm='+'};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,4]});
              $f = Formula("sqrt($x) $pm 1/sqrt($x)")->reduce;
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-2">
          <webwork xml:id="webwork-ex-deriv-implicit-power-2">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $pm = list_random('+','-');
              $n = random(3,6,1);
              if($envir{problemSeed}==1){$fname='f';$x='x';$pm='+';$n=3;};
              Context("Fraction");
              parser::Root->Enable;
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,4]});
              $f = Formula("root($n,$x) $pm $x^(($n-1)/$n)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
                To enter <m>\sqrt[n]{x}</m>, type <c>root(n,x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-3">
          <webwork xml:id="webwork-ex-deriv-implicit-power-3">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $pm = list_random('+','-');
              $a = random(1,4,1)**2;
              $n = random(2,4,1);
              if($envir{problemSeed}==1){$fname='f';$x='t';$pm='-';$a=1;$n=2;};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[-$a**(1/$n),$a**(1/$n)]});
              $f = Formula("sqrt($a $pm $x^$n)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-4">
          <webwork xml:id="webwork-ex-deriv-implicit-power-4">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $trig = list_random('sin','cos','tan');
              if($envir{problemSeed}==1){$fname='g';$x='t';$trig='sin';};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,pi/2]});
              $f = Formula("sqrt($x)$trig($x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-5">
          <webwork xml:id="webwork-ex-deriv-implicit-power-5">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $n = random(1,3,1) + random(0.1,0.9,0.1);
              $trig = list_random('sin','cos','tan');
              if($envir{problemSeed}==1){$fname='h';$x='x';$n=1.5;};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,4]});
              $f = Formula("$x^$n");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-6">
          <webwork xml:id="webwork-ex-deriv-implicit-power-6">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $n = random(1,3,1) + random(0.1,0.9,0.1);
              $b = list_random(Formula("pi"),Formula("e"));
              if($envir{problemSeed}==1){$fname='f';$x='x';$n=1.9;$b=Formula("pi")};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,4]});
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $f = Formula("$x^$b + $x^$n + $b^$n");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-7">
          <webwork xml:id="webwork-ex-deriv-implicit-power-7">
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $a = non_zero_random(-9,9,1);
              if($envir{problemSeed}==1){$fname='g';$x='x';$a=7;};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,4]});
              $f = Formula("($x+$a)/sqrt($x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-power-8">
          <webwork xml:id="webwork-ex-deriv-implicit-power-8">
            <pg-code>
              Context("Fraction");
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $n = random(3,9,1);
              $trig = list_random('sin','cos','tan','sec','cot','csc');
              if($envir{problemSeed}==1){$fname='f';$x='t';$n=5;$trig='sec';};
              Context()->variables->are($x=>'Real');
              Context()->variables->set($x=>{limits=>[0,4]});
              parser::Root->Enable;
              $f = Formula("root($n,$x)($trig($x)+e^$x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>)=<var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
                To enter <m>\sqrt[n]{x}</m>, type <c>root(n,x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-deriv-implicit-compute">
        <introduction>
          <p>
            Find <m>\lz{y}{x}</m> using implicit differentiation.
          </p>
        </introduction>
        <exercise xml:id="exer_02_06_ex_09" label="ex-deriv-implicit-compute-1">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-1">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("-4x^3/(2y+1)");
              @y=(random(-2,2,0.2),random(-2,2,0.2),random(-2,2,0.2),random(-2,2,0.2),random(-2,2,0.2));
              @x=map{(7-($_)-($_)**2)**(1/4)*(-1)**(random(-1,1,2))}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>x^4+y^2+y=7</m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-2">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-2">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("-y^(3/5)/x^(3/5)");
              @y=(random(0.01,0.99,0.01),random(0.01,0.99,0.01),random(0.01,0.99,0.01),random(0.01,0.99,0.01),random(0.01,0.99,0.01));
              @x=map{(1-($_)**(2/5))**(5/2)}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>x^{2/5}+y^{2/5}=1</m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-3">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-3">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("sin(x)sec(y)");
              @y=(random(0,3.14,0.01),random(0,3.14,0.01),random(0,3.14,0.01),random(0,3.14,0.01),random(0,3.14,0.01));
              @x=map{acos(1-sin($_))}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>\cos(x)+\sin(y)=1</m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise xml:id="exer_02_06_ex_12" label="ex-deriv-implicit-compute-4">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-4">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("y/x");
              @x=(random(-4.05,4.05,0.1),random(-4.05,4.05,0.1),random(-4.05,4.05,0.1),random(-4.05,4.05,0.1),random(-4.05,4.05,0.1));
              @y=map{$_/10}(@x);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>\dfrac{x}{y}=10</m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-5">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-5">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("y/x");
              #$a = random(5,15,1);
              #if($envir{problemSeed}==1){$a=10;};
              $a=10;
              @y=(random(-4.05,4.05,0.1),random(-4.05,4.05,0.1),random(-4.05,4.05,0.1),random(-4.05,4.05,0.1),random(-4.05,4.05,0.1));
              @x=map{$_/$a}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>\dfrac{y}{x}=<var name="$a"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-6">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-6">
            <pg-code>
              Context()->variables->add(y=>'Real');
              Context()->flags->set(reduceConstantFunctions=>0);
              #$m=list_random(2,3,5);
              #$b=random(2,9,1);
              #$c=random(4,9,1);
              #if($envir{problemSeed}==1){$m=2;$b=2;$c=5;};
              $m=2;$b=2;$c=5;
              $dydx=Formula("-(e^x x(x+$m) $b^(-y))/(ln($b))");
              @x=(random(-4,1,0.1),random(-4,1,0.1),random(-4,1,0.1),random(-4,1,0.1),random(-4,1,0.1));
              @y=map{ln($c-($_)**$m*exp($_))/ln($b)}(@x);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>x^<var name="$m"/>e^x+<var name="$b"/>^y=<var name="$c"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-7">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-7">
            <pg-code>
              Context()->variables->add(y=>'Real');
              #$m = random(2,9,1);
              #$trig = list_random('sin','cos','tan','cot','sec','csc');
              #$c = random(10,90,10);
              #if($envir{problemSeed}==1){$m=2;$trig='tan';$c=50;};
              $m=2;$trig='tan';$c=50;
              if ($trig eq 'sin') {$dydx=Formula("-$m tan(y)/x");};
              if ($trig eq 'cos') {$dydx=Formula("$m cot(y)/x");};
              if ($trig eq 'tan') {$dydx=Formula("-$m sin(y) cos(y)/x");};
              if ($trig eq 'cot') {$dydx=Formula("$m sin(y) cos(y)/x");};
              if ($trig eq 'sec') {$dydx=Formula("-$m cot(y)/x");};
              if ($trig eq 'csc') {$dydx=Formula("$m tan(y)/x");};
              # need to avoid x==0
              @x=(random(-3.9,3.9,0.2),random(-3.9,3.9,0.2),random(-3.9,3.9,0.2),random(-3.9,3.9,0.2),random(-3.9,3.9,0.2));
              if ($trig eq 'sin') {@y=map{asin($c/($_)**$m)}(@x);};
              if ($trig eq 'cos') {@y=map{acos($c/($_)**$m)}(@x);};
              if ($trig eq 'tan') {@y=map{atan($c/($_)**$m)}(@x);};
              if ($trig eq 'cot') {@y=map{pi/2 - atan($c/($_)**$m)}(@x);};
              if ($trig eq 'sec') {@y=map{acos(($_)**$m/$c)}(@x);};
              if ($trig eq 'csc') {@y=map{asin(($_)**$m)/$c}(@x);};
              $left = Formula("x^$m $trig(y)");
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m><var name="$left"/>=<var name="$c"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-8">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-8">
            <pg-code>
              Context("Fraction");
              parser::Root->Enable;
              Context()->variables->add(y=>'Real');
              #($a,$b) = (2..5)[NchooseK(4,2)];
              #$c = random(1,9,1);
              #($m,$n,$p) = (2..5)[NchooseK(4,3)];
              #if($envir{problemSeed}==1){$a=3;$b=2;$c=2;$m=2;$n=3;$p=4;};
              $a=3;$b=2;$c=2;$m=2;$n=3;$p=4;
              $w = ($c**(1/$p)/$a)**(1/$m);
              $left = Formula("($a x^$m + $b y^$n)^$p");
              $right = Formula("$c");
              $frac = Fraction(-$a*$m,$b*$n);
              $dydx=Formula("$frac x^($m-1) / y^($n-1)")->reduce;
              @x=(random(-$w,$w,0.01),random(-$w,$w,0.01),random(-$w,$w,0.01),random(-$w,$w,0.01),random(-$w,$w,0.01));
              if ($n % 2 == 1) {
                @y=map{root($n,(root($p,$c) - $a*($_)**$m)/$b)}(@x);
              } else {
                @y=map{root($n,random(-1,1,2)*(root($p,$c) - $a*($_)**$m)/$b)}(@x);
              }
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m><var name="$left"/>=<var name="$right"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-9">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-9">
            <pg-code>
              Context("Fraction");
              parser::Root->Enable;
              Context()->variables->add(y=>'Real');
              #$a = non_zero_random(-9,9,1);
              #$b = random(100,200,5);
              #$pm = list_random('+','-');
              #$m = random(2,4,1);
              #$n = random(2,4,1);
              #if($envir{problemSeed}==1){$a=2;$b=200;$pm='-';$m=2;$n=2;};
              $a=2;$b=200;$pm='-';$m=2;$n=2;
              $left = Formula("(y^$m+$a y $pm x)^$n");
              $right = Formula("$b");
              $dydx=Formula("-($pm 1/($m y^($m-1)+$a))")->reduce->reduce;
              @y=(random(-3.9,1.9,0.2),random(-3.9,1.9,0.2),random(-3.9,1.9,0.2),random(-3.9,1.9,0.2),random(-3.9,1.9,0.2));
              @x=map{(root($n,$b) - $_**$m - $_) * (($pm eq '+') ? 1 : -1);}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m><var name="$left"/>=<var name="$right"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-10">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-10">
            <pg-code>
              Context("Fraction");
              Context()->variables->add(y=>'Real');
              #($m,$n) = (1..2)[NchooseK(2,2)];
              #$c = random(10,20,1);
              #if($envir{problemSeed}==1){$m=2;$n=1;$c=17};
              $m=2;$n=1;$c=17;
              $left = Formula("(x^$m + y^$n)/(x^$n + y^$m)")->reduce;
              $right = Formula("$c");
              $dydx = Formula("(($n-$m) x^2 + $n x^($n-1) y^$n - $m x^($m-1) y^$m)/($n x^$n y^($n-1) + ($n-$m) y^2 - $m x^$m y^($m-1))")->reduce;
              @y=(random(-3.9,1.9,0.2),random(-3.9,1.9,0.2),random(-3.9,1.9,0.2),random(-3.9,1.9,0.2),random(-3.9,1.9,0.2));
              if ($m == 2) {
                @x=map{($c+(-1)**(random(-1,1,2))*sqrt($c**2 - 4*($_)*(1 - $c*($_))))/2}(@y);
              } else {
                @x=map{(1+(-1)**(random(-1,1,2))*sqrt(1 - 4*$c*($_)*($c - ($_))))/(2*$c)}(@y);
              }
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m><var name="$left"/>=<var name="$right"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
            <solution>
              <p>
                If one takes the derivative of the equation,
                as shown, using the Quotient Rule,
                one finds <m>\frac{dy}{dx}=\frac{x^2+2 x y^2-y}{2 x^2 y-x+y^2}</m>.
              </p>
              <p>
                If one first clears the denominator and writes
                <m>x^2+y=17(x+y^2)</m> then takes the derivative of both sides,
                one finds <m>\frac{dy}{dx}= \frac{2x-17}{34y-1}</m>.
              </p>
              <p>
                These expressions, by themselves, are not equal.
                However, for values of <m>x</m> and <m>y</m> that satisfy the original equation
                (i.e, for <m>x</m> and <m>y</m> such that <m>\frac{x^2+y}{x+y^2}=17</m>),
                these expressions are equal.
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-11">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-11">
            <pg-code>
              Context()->variables->add(y=>'Real');
              #($triga,$trigb) = ('sin','cos')[NchooseK(2,2)];
              #if($envir{problemSeed}==1){$triga='sin';$trigb='cos';};
              $triga='sin';$trigb='cos';
              $left = Formula("($triga(x)+y)/($trigb(y)+x)");
              $right = Formula("1");
              if ($triga eq 'sin') {
                $dydx = Formula("(1-cos(x))/(sin(y)+1)")->reduce;
                $dydx->{test_points}=[[-3.1,-3.83041],[-0.41,0.732269],[0.59,0.759097],[2.6,1.82908],[5.3,6.93017]];
              } else {
                $dydx = Formula("(sin(x)+1)/(1-cos(y))")->reduce;
                $dydx->{test_points}=[[0.831958,1],[1.329583,2],[-0.0952339,-2],[-3.70455,-3],[0.7390851,0]];
              }
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m><var name="$left"/>=<var name="$right"/></m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
            <solution>
              <p>
                If one takes the derivative of the equation,
                as shown, using the Quotient Rule,
                one finds <m>\frac{dy}{dx} = \frac{-\cos (x) (x+\cos (y))+\sin (x)+y}{\sin (y) (\sin (x)+y)+x+\cos (y)}</m>.
              </p>
              <p>
                If one first clears the denominator and writes
                <m>\sin(x)+y = \cos(y)+x</m> then takes the derivative of both sides,
                one finds <m>\frac{dy}{dx} = \frac{1-\cos(x)}{1+\sin(y)}</m>.
              </p>
              <p>
                These expressions, by themselves, are not equal.
                However, for values of <m>x</m> and <m>y</m> that satisfy the original equation
                (i.e, for <m>x</m> and <m>y</m> such that <m>\frac{\sin(x)+y)}{\cos(y)+x)}=1</m>),
                these expressions are equal.
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-12">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-12">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("-x/y");
              @t=(random(0,6.28,0.01),random(0,6.28,0.01),random(0,6.28,0.01),random(0,6.28,0.01),random(0,6.28,0.01));
              @x=map{exp(exp(1)/2)*cos($_)}(@t);
              @y=map{exp(exp(1)/2)*sin($_)}(@t);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>\ln\mathopen{}\left(x^2+y^2\right)\mathclose{}=e</m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-compute-13">
          <webwork xml:id="webwork-ex-deriv-implicit-compute-13">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $dydx=Formula("-(2x+y)/(2y+x)");
              @t=(random(0,6.28,0.01),random(0,6.28,0.01),random(0,6.28,0.01),random(0,6.28,0.01),random(0,6.28,0.01));
              @u=map{sqrt(2/3*exp(1))*cos($_)}(@t);
              @v=map{sqrt(2*exp(1))*sin($_)}(@t);
              @x=map{($u[$_]-$v[$_])/sqrt(2)}(0..4);
              @y=map{($u[$_]+$v[$_])/sqrt(2)}(0..4);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $dydx->{test_points}=~~@xy;
              $showwork = '[@ explanation_box(message => "Show your work using implicit differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>\ln\mathopen{}\left(x^2+xy+y^2\right)\mathclose{} = 1</m>
              </p>
              <p>
                <var name="$dydx" width="80"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercise label="ex-deriv-implicit-compute-14">
        <webwork xml:id="webwork-ex-deriv-implicit-compute-14">
          <introduction>
            <p>
              Show that <m>\lz{y}{x}</m> is the same for each of the following implicitly defined functions.
            </p>
            </introduction>
            <task label="ex-deriv-implicit-compare-a">
              <statement>
                <p>
                  <m>xy=1</m>
                </p>
                <p>
                  <var form="essay"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-compare-b">
              <statement>
                <p>
                  <m>x^2y^2=1</m>
                </p>
                <p>
                  <var form="essay"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-compare-c">
              <statement>
                <p>
                  <m>\sin(xy) = 1</m>
                </p>
                <p>
                  <var form="essay"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-compare-d">
              <statement>
                <p>
                  <m>\ln(xy) =1</m>
                </p>
                <p>
                  <var form="essay"/>
                </p>
              </statement>
            </task>
        </webwork>
      </exercise>

      <!-- TODO: solutions for this exercise group. Answers are in APEX -->
      <exercisegroup cols="2" xml:id="exset-deriv-implicit-tangent">
        <introduction>
          <p>
            Find the equation of the tangent line to the graph of the implicitly defined function at the indicated points.
            As a visual aid, the function is graphed.
          </p>
        </introduction>

        <exercise label="ex-deriv-implicit-tangent-1">
          <webwork xml:id="webwork-ex-deriv-implicit-tangent-1">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              @eq=(Formula("y=0"),Formula("y=-1.859(x-0.1)+0.2811"));
            </pg-code>
            <introduction>
              <p>
                On the curve <m>x^{2/5}+y^{2/5} = 1</m>.
              </p>
              <image xml:id="img_06_02_ex_27">
                <shortdescription>
                  An astroid of radius 1 with a point drawn at (0.1,0.281).
                </shortdescription>
                <description>
                  <p>
                    An astroid of radius 1.
                    A point is drawn on the curve, at <m>(0.1,0.281)</m>.
                  </p>
                </description>
                <latex-image>
                  \begin{tikzpicture}
                    \begin{axis}[
                      ymin=-1.1,ymax=1.1,%
                      xmin=-1.1,xmax=1.1,%
                    ]

                    \addplot [firstcurvestyle,-,domain=0:360,samples=100] ({(cos(x))^5},{(sin(x))^5});
                    \filldraw [] (axis cs:.1,.28) node [above right] {\((0.1,0.281)\)} circle (1pt);
                    \end{axis}
                  \end{tikzpicture}
                </latex-image>
              </image>
            </introduction>
            <task label="ex-deriv-implicit-tangent-1a">
              <statement>
                <p>
                  At <m>(1,0)</m>.
                </p>
                <p>
                  <var name="$eq[0]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-1b">
              <statement>
                <p>
                  At <m>(0.1,0.2811)</m> (which does not <em>exactly</em>
                  lie on the curve, but is very close).
                </p>
                <p>
                  <var name="$eq[1]" width="30"/>
                </p>
              </statement>
            </task>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-tangent-2">
          <webwork xml:id="webwork-ex-deriv-implicit-tangent-2">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              @eq=(Formula("x=1"),Formula("y=-3sqrt(3)/8(x-sqrt(0.6))+sqrt(0.8)"),Formula("y=1"));
            </pg-code>
            <introduction>
              <p>
                On the curve <m>x^{4}+y^{4} = 1</m>.
              </p>
              <image xml:id="img_02_06_ex_28">
                <shortdescription>
                  A square with rounded corners and edges with a point in the first quadrant.
                </shortdescription>
                <description>
                  A curve that lies in all 4 quadrants.
                  It has the appearance of a square with rounded sides and corners.
                  A point is drawn at <m>(\sqrt{0.6},\sqrt{0.8})</m>.
                </description>
                <latex-image>
                  \begin{tikzpicture}
                  \begin{axis}[
                    ymin=-1.1,ymax=1.1,%
                    xmin=-1.1,xmax=1.1,%
                  ]
                  
                  \addplot [firstcurvestyle,-] coordinates {(1.,0) (0.98901,0.45597) (0.9558,0.63776) (0.89945,0.76667) (0.818,0.86206) (0.70711,0.9306) (0.55589,0.97522) (0.32331,0.99726) (-0.32331,0.99726) (-0.55589,0.97522) (-0.70711,0.9306) (-0.818,0.86206) (-0.89945,0.76667) (-0.9558,0.63776) (-0.98901,0.45597) (-1.,0) (-1.,0) (-0.98901,-0.45597) (-0.9558,-0.63776) (-0.89945,-0.76667) (-0.818,-0.86206)(-0.70711,-0.9306) (-0.55589,-0.97522) (-0.32331,-0.99726)(0.32331,-0.99726) (0.55589,-0.97522) (0.70711,-0.9306)(0.818,-0.86206) (0.89945,-0.76667) (0.9558,-0.63776)(0.98901,-0.45597) (1.,0) };
                  \filldraw [] (axis cs:.775,.894) node [below left] {\((\sqrt{0.6},\sqrt{0.8})\)} circle (1pt);
                  
                  \end{axis}
                  \end{tikzpicture}
                </latex-image>
              </image>
            </introduction>
            <task label="ex-deriv-implicit-tangent-2a">
              <statement>
                <p>
                  At <m>(1,0)</m>.
                </p>
                <p>
                  <var name="$eq[0]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-2b">
              <statement>
                <p>
                  At <m>\left(\sqrt{0.6},\sqrt{0.8}\right)</m>.
                </p>
                <p>
                  <var name="$eq[1]" width="30"/>
                </p>
              </statement>
            </task>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-tangent-3">
          <webwork xml:id="webwork-ex-deriv-implicit-tangent-3">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              @eq=(Formula("y=4"),Formula("y=3/108^(1/4)(x-2)-108^(1/4)"));
            </pg-code>
            <introduction>
              <p>
                On the curve <m>(x^2+y^2-4)^3 = 108y^2</m>.
              </p>
              <image xml:id="img_02_06_ex_29">
                <shortdescription>
                  A combination of 2 circles, with cusps at (-2,0) and (2,0) with a tangent line in the fourth quadrant.
                </shortdescription>
                <description>
                  <p>
                    A curve which seems like two circles combined.
                    Beginning at the top of the curve, at the point <m>(0,4)</m>, the curve decreases towards the right.
                    It continues to decreases, bending towards the <m>y</m>-axis as the curve nears the <m>x</m>-axis. 
                    The curve passes through the <m>x</m>-axis at a point close to <m>(2.1,0)</m>, forming a cusp at that point.
                    In the fourth quadrant, the curve bends outwards slightly, before curving wide towards the <m>y</m>-axis.
                    The curve passes through the <m>y</m>-axis at the point <m>(0,-4)</m>.
                    The left side of the curve is symmetrical to the right, again curving inwards and forming a cusp at <m>(-2,0)</m>.
                    From there the curve bends out, before curving in and passing through the point <m>(0,4)</m>.
                    A point is drawn in the lower left of the curve at <m>(2,-\sqrt[4]{108})</m>.
                  </p>
                </description>
                <latex-image>
                  \begin{tikzpicture}
                  \begin{axis}[
                    ymin=-4.5,ymax=4.5,%
                    xmin=-4.5,xmax=4.5,%
                  ]
                  
                  \addplot [firstcurvestyle,-] coordinates {(-0.22282,-3.9915) (-0.57143,-3.9441) (-1.,-3.8244) (-1.2959,-3.7041)(-1.5714,-3.551) (-1.8453,-3.3571) (-2.0412,-3.1841) (-2.2149,-3.)(-2.3706,-2.7991) (-2.4727,-2.6429) (-2.5832,-2.4403)(-2.7019,-2.1552) (-2.783,-1.8571) (-2.8275,-1.4582)(-2.8002,-1.0859) (-2.7143,-0.74808) (-2.5958,-0.5)(-2.4708,-0.31491) (-2.3571,-0.19279) (-2.2143,-0.081938)(-2.0659,-0.005515) (-2.2078,0.077938) (-2.4036,0.23922)
                  (-2.5608,0.4392) (-2.6877,0.68771) (-2.786,1.) (-2.8262,1.3571)(-2.8065,1.7143) (-2.7075,2.136) (-2.5114,2.5714) (-2.2471,2.9614)(-2.0396,3.1825) (-1.6513,3.5) (-1.2857,3.7088) (-1.0714,3.8007)(-0.78571,3.8938) (-0.52476,3.9533) (-0.28571,3.9855)
                  (-0.070563,3.9991) (0.27289,3.9872) (0.64411,3.9298) (1.082,3.7963)(1.4286,3.6354) (1.7143,3.4554) (1.9675,3.2532) (2.1511,3.0714)(2.3284,2.8571) (2.4288,2.7143) (2.5351,2.5351) (2.6283,2.3426)(2.7079,2.1365) (2.7939,1.7939) (2.8255,1.3969) (2.8017,1.0874)(2.7481,0.85714) (2.6429,0.58296) (2.552,0.42857) (2.438,0.27631)
                  (2.3214,0.16103) (2.1786,0.06028) (2.1143,-0.028574)(2.2857,-0.13046) (2.4439,-0.28571) (2.5958,-0.5) (2.7143,-0.74808)(2.8002,-1.0859) (2.827,-1.4286) (2.7984,-1.773) (2.7079,-2.1365)(2.6052,-2.3948) (2.4292,-2.7137) (2.2453,-2.9596) (2.,-3.2231)(1.7143,-3.4554) (1.4682,-3.611) (1.1839,-3.7553) (0.86968,-3.8697)
                  (0.57143,-3.9441) (0.33765,-3.9805) (0.072336,-3.9991) (-0.22282,-3.9915)};
                  
                  \filldraw [] (axis cs:2,-3.22) node [shift={(15pt,-10pt)}] {\((2,-\sqrt[4]{108})\)} circle (1pt);
                  
                  \end{axis}
                  \end{tikzpicture}
                </latex-image>
              </image>
            </introduction>
            <task label="ex-deriv-implicit-tangent-3a">
              <statement>
                <p>
                  At <m>(0,4)</m>.
                </p>
                <p>
                  <var name="$eq[0]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-3b">
              <statement>
                <p>
                  At <m>\left(2,-\sqrt[4]{108}\right)</m>.
                </p>
                <p>
                  <var name="$eq[1]" width="30"/>
                </p>
              </statement>
            </task>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-tangent-4">
          <webwork xml:id="webwork-ex-deriv-implicit-tangent-4">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              @eq=(Formula("y=-x+1"),Formula("y=3sqrt(3)/4"));
            </pg-code>
            <introduction>
              <p>
                On the curve <m>(x^2+y^2+x)^2 = x^2+y^2</m>.
              </p>
              <image xml:id="img_02_06_ex_30">
                <shortdescription>
                  An oval with a cusp on the right side.
                </shortdescription>
                <description>
                  An oval with a cusp on the right side.
                  A majority of the curve lies to the left of the <m>y</m>-axis.
                  From the top of the curve, the curve decreases towards the right.
                  It enters the first quadrant through the point <m>(0,1)</m>.
                  As the curve nears the <m>x</m>-axis, it bends back toward the <m>y</m>-axis, forming a cusp at the origin.
                  The curve then bends outwards into the fourth quadrant.
                  The curve continues downwards and to the left, passing the <m>y</m>-axis through the point <m>(0,-1)</m>.
                  In the third quadrant the curve bends upwards, passing vertically into the second quadrant through the point <m>(-2,0)</m>.
                  The curve bends upwards and to the right, once again meeting the top of the curve.
                  The point at the top of the curve is drawn at <m>(-\frac{3}{4},\frac{3\sqrt{3}}{4})</m>.
                </description>
                <latex-image>
                  \begin{tikzpicture}
                  \begin{axis}[
                    ymin=-1.5,ymax=1.5,%
                    xmin=-2.5,xmax=0.5,%
                  ]
                  
                  \addplot [firstcurvestyle,-,samples=150] coordinates {(-2.,0) (-1.9547,-0.34466) (-1.8227,-0.66341) (-1.616,-0.93301)(-1.3529,-1.1352) (-1.056,-1.2584) (-0.75,-1.299) (-0.459,-1.2611)(-0.2038,-1.1558) (0,-1.) (0.14349,-0.8138) (0.22504,-0.6183)(0.25,-0.43301) (0.22961,-0.27364) (0.17922,-0.15038)(0.11603,-0.066987) (0.05667,-0.020626) (0.014961,-0.0026381) (0,0)
                  (0.014961,0.0026381) (0.05667,0.020626) (0.11603,0.066987)(0.17922,0.15038) (0.22961,0.27364) (0.25,0.43301) (0.22504,0.6183)(0.14349,0.8138) (0,1.) (-0.2038,1.1558) (-0.459,1.2611)(-0.75,1.299) (-1.056,1.2584) (-1.3529,1.1352) (-1.616,0.93301)(-1.8227,0.66341) (-1.9547,0.34466) (-2.,0)};
                  
                  \filldraw [] (axis cs:-.75,1.3) node [shift={(0pt,-12pt)}] {\(\left(-\frac{3}{4},\frac{3\sqrt{3}}{4}\right)\)} circle (1pt);
                  
                  \end{axis}
                  \end{tikzpicture}
                </latex-image>
              </image>
            </introduction>
            <task label="ex-deriv-implicit-tangent-4a">
              <statement>
                <p>
                  At <m>(0,1)</m>.
                </p>
                <p>
                  <var name="$eq[0]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-4b">
              <statement>
                <p>
                  At <m>\left(-\frac{3}{4}, \frac{3\sqrt{3}}{4}\right)</m>.
                </p>
                <p>
                  <var name="$eq[1]" width="30"/>
                </p>
              </statement>
            </task>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-tangent-5">
          <webwork xml:id="webwork-ex-deriv-implicit-tangent-5">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              @eq=(Formula("y=-1/sqrt(3)(x-7/2)+(6+3sqrt(3))/2"),Formula("y=sqrt(3)(x-(4+3sqrt(3)))/2+3/2"));
            </pg-code>
            <introduction>
              <p>
                On the curve <m>(x-2)^2+(y-3)^2=9</m>.
              </p>
              <image xml:id="img_02_06_ex_31">
                <shortdescription>
                  A circle of radius 3 centered at (2,3). Two points are drawn on the circle.
                </shortdescription>
                <description>
                  <p>
                    A circle of radius 3 centered at <m>(2,3)</m>.
                    Two points are drawn, one at <m>(3.5,\frac{6+3\sqrt{3}}{2})</m>,
                    and the other at <m>(\frac{4+3\sqrt{3}}{2},1.5)</m>.
                    The first point is in the upper right side of the circle.
                    The second point is in the lower right side of the circle.
                  </p>
                </description>
                <latex-image>
                  \begin{tikzpicture}
                  \begin{axis}[
                    ymin=-.5,ymax=6.5,%
                    xmin=-1.5,xmax=6.5,%
                  ]
                  
                  \addplot [firstcurvestyle,-,samples=100,domain=0:360] ({(2+3*cos(x))},{(3+3*sin(x))});
                  \filldraw [] (axis cs:4.6,1.5) node [left] {\(\left(\frac{4+3\sqrt{3}}{2},1.5\right)\)} circle (1pt);
                  \filldraw [] (axis cs:3.5,5.6) node [below left] {\(\left(3.5,\frac{6+3\sqrt{3}}{2}\right)\)} circle (1pt);
                  
                  \end{axis}
                  \end{tikzpicture}
                </latex-image>
              </image>
            </introduction>
            <task label="ex-deriv-implicit-tangent-5a">
              <statement>
                <p>
                  At <m>\left(\frac{7}{2},\frac{6+3\sqrt{3}}{2}\right)</m>.
                </p>
                <p>
                  <var name="$eq[0]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-5b">
              <statement>
                <p>
                  At <m>\left(\frac{4+3\sqrt{3}}{2},\frac{3}{2}\right)</m>.
                </p>
                <p>
                  <var name="$eq[1]" width="30"/>
                </p>
              </statement>
            </task>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-tangent-6">
          <webwork xml:id="webwork-ex-deriv-implicit-tangent-6">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              @eq=(Formula("y=1"),Formula("y=-2/sqrt(5)(x+1)+1/2(-1+sqrt(5))"),Formula("y=2/sqrt(5)(x+1)+1/2(-1-sqrt(5))"));
            </pg-code>
            <introduction>
              <p>
                On the curve <m>x^2+y^3+2xy=0</m>.
              </p>
              <image xml:id="img_02_06_ex_32">
                <shortdescription>
                  A curve that begins in the third quadrant, forms a loop in the third quadrant, and decreases in the fourth quadrant.
                </shortdescription>
                <description>
                  <p>
                    The curve begins in the third quadrant.
                    The curve increases to the right, passing through the origin almost vertically.
                    From there, the curve forms a loop in the third quadrant, then decreasing and passing through the origin again.
                    The curve passes through the origin into the fourth qudrant, where the curve gently decreases.
                    Three points are drawn on the curve.
                    The first point is in the third quadrant, at the point <m>(-1,\frac{-1-\sqrt{5}}{2})</m>.
                    The second point is in the second quadrant, at the point <m>(-1,1)</m>.
                    The third point also lies in the second quadrant, at the point <m>(-1,\frac{-1+\sqrt{5}}{2})</m>.
                    The second point lies on the top of the loop, while the third point lies on the bottom of the loop.
                  </p>
                </description>
                <latex-image>
                  \begin{tikzpicture}
                  \begin{axis}[
                  ymin=-2.5,ymax=2.5,%
                  xmin=-2.5,xmax=2.5,%
                  ]
                  \addplot [firstcurvestyle,-,samples=100,domain=45:157.5] ({((-sin(2*x)-(cos(x))^2)*cos(x)/((sin(x))^3))},{((-sin(2*x)-(cos(x))^2)/((sin(x))^2))});
                  \filldraw [] (axis cs:-1,1) node [above] {\((-1,1)\)} circle (1pt);
                  \filldraw [thin,->,>=latex] (axis cs:1.25,-1.5) node [fill=white] {\(\left(-1,\frac{-1-\sqrt{5}}2\right)\)} -- (axis cs: -.9,-1.62);
                  \filldraw [] (axis cs: -1,-1.62)  circle (1pt);
                  \filldraw [->,thin,>=latex] (axis cs:1.25,0.5) node [ fill=white] {\(\left(-1,\frac{-1+\sqrt{5}}2\right)\)} -- (axis cs: -.9,0.62);
                  \filldraw [] (axis cs:-1,0.62)  circle (1pt);
                  
                  \end{axis}
                  \end{tikzpicture}
                </latex-image>
              </image>
            </introduction>
            <task label="ex-deriv-implicit-tangent-6a">
              <statement>
                <p>
                  At <m>(-1,1)</m>.
                </p>
                <p>
                  <var name="$eq[0]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-6b">
              <statement>
                <p>
                  At <m>\left(-1,\frac12(-1+\sqrt{5})\right)</m>.
                </p>
                <p>
                  <var name="$eq[1]" width="30"/>
                </p>
              </statement>
            </task>
            <task label="ex-deriv-implicit-tangent-6c">
              <statement>
                <p>
                  At <m>\left(-1,\frac12(-1-\sqrt{5})\right)</m>.
                </p>
                <p>
                  <var name="$eq[2]" width="30"/>
                </p>
              </statement>
            </task>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-deriv-implicit-second">
        <introduction>
          <p>
            An implicitly defined function is given.
            Find <m>\lzn{2}{y}{x}</m>.
            Note: these are the same functions used in Exercises <xref ref="exer_02_06_ex_09" text="local"/> through <xref ref="exer_02_06_ex_12" text="local"/>.
          </p>
        </introduction>
        <exercise label="ex-deriv-implicit-second-1">
          <webwork xml:id="webwork-ex-deriv-implicit-second-1">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $ddyddx=Formula("-((2y+1)(12x^2)-4x^3(2*-(4x^3)/(2y+1)))/(2y+1)^2");
              @y=(random(-2,2,0.1),random(-2,2,0.1),random(-2,2,0.1),random(-2,2,0.1),random(-2,2,0.1));
              @x=map{(7-($_)-($_)**2)**(1/4)*(-1)**(random(-1,1,2))}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $ddyddx->{test_points}=~~@xy;
            </pg-code>
            <statement>
              <p>
                <m>x^4+y^2+y=7</m>
              </p>
              <p>
                <var name="$ddyddx" width="50"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-second-2">
          <webwork xml:id="webwork-ex-deriv-implicit-second-2">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $ddyddx=Formula("-(x^(3/5)*3/5y^(-2/5)(-y^(3/5)/x^(3/5))-y^(3/5)*3/5x^(-2/5))/x^(6/5)");
              @y=(random(0.01,0.99,0.01),random(0.01,0.99,0.01),random(0.01,0.99,0.01),random(0.01,0.99,0.01),random(0.01,0.99,0.01));
              @x=map{(1-($_)**(2/5))**(5/2)}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $ddyddx->{test_points}=~~@xy;
            </pg-code>
            <statement>
              <p>
                <m>x^{2/5}+y^{2/5}=1</m>
              </p>
              <p>
                <var name="$ddyddx" width="50"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-second-3">
          <webwork xml:id="webwork-ex-deriv-implicit-second-3">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $ddyddx=Formula("sin^2(x)sec^2(y)tan(y)+cos(x)sec(y)");
              @y=(random(0,3.14,0.01),random(0,3.14,0.01),random(0,3.14,0.01),random(0,3.14,0.01),random(0,3.14,0.01));
              @x=map{acos(1-sin($_))}(@y);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $ddyddx->{test_points}=~~@xy;
            </pg-code>
            <statement>
              <p>
                <m>\cos(x)+\sin(y)=1</m>
              </p>
              <p>
                <var name="$ddyddx" width="50"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-second-4">
          <webwork xml:id="webwork-ex-deriv-implicit-second-4">
            <pg-code>
              Context()->variables->add(y=>'Real');
              $ddyddx=Formula("0");
              @x=(random(-4,4,0.1),random(-4,4,0.1),random(-4,4,0.1),random(-4,4,0.1),random(-4,4,0.1));
              @y=map{$_/10}(@x);
              @xy=map{[$x[$_],$y[$_]]}(0..4);
              $ddyddx->{test_points}=~~@xy;
            </pg-code>
            <statement>
              <p>
                <m>\dfrac{x}{y}=10</m>
              </p>
              <p>
                <var name="$ddyddx" width="50"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2" xml:id="exset-deriv-implicit-log">
        <introduction>
          <p>
            Use logarithmic differentiation to find <m>\lz{y}{x}</m>,
            then find the equation of the tangent line at the indicated <m>x</m>-value.
          </p>
        </introduction>
        <exercise label="ex-deriv-implicit-log-1">
          <webwork xml:id="webwork-ex-deriv-implicit-log-1">
            <pg-code>
              Context()->variables->set(x=>{limits=>[-0.9,4]});
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $dydx=Formula("(1+x)^(1/x)(1/(x(x+1))-ln(1+x)/x^2)");
              Context("Numeric");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $t=Formula("y=(1-2ln(2))(x-1)+2");
              $showwork = '[@ explanation_box(message => "Show your work using logarithmic differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>y=(1+x)^{1/x}</m> at <m>x=1</m>
              </p>
              <instruction>
                Enter <m>\lz{y}{x}</m> here.
              </instruction>
              <p>
                <var name="$dydx" width="50"/>
              </p>
              <instruction>
                Enter the equation of the tangent line here.
              </instruction>
              <p>
                <var name="$t" width="50"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-log-2">
          <webwork xml:id="webwork-ex-deriv-implicit-log-2">
            <pg-code>
              Context()->variables->set(x=>{limits=>[0.01,4]});
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $dydx=Formula("(2x)^(x^2)(2x ln(2x)+x)");
              Context("Numeric");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $t=Formula("y=(2+4ln(2))(x-1)+2");
              $showwork = '[@ explanation_box(message => "Show your work using logarithmic differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>y=(2x)^{x^2}</m> at <m>x=1</m>
              </p>
              <instruction>
                Enter <m>\lz{y}{x}</m> here.
              </instruction>
              <p>
                <var name="$dydx" width="50"/>
              </p>
              <instruction>
                Enter the equation of the tangent line here.
              </instruction>
              <p>
                <var name="$t" width="50"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-log-3">
          <webwork xml:id="webwork-ex-deriv-implicit-log-3">
            <pg-code>
              Context()->variables->set(x=>{limits=>[0.01,4]});
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $dydx=Formula("x^x/(x+1)(ln(x)+1-1/(x+1))");
              Context("Numeric");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $t=Formula("y=1/4*(x-1)+1/2");
              $showwork = '[@ explanation_box(message => "Show your work using logarithmic differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>y=\dfrac{x^{x}}{x+1}</m> at <m>x=1</m>
              </p>
              <instruction>
                Enter <m>\lz{y}{x}</m> here.
              </instruction>
              <p>
                <var name="$dydx" width="50"/>
              </p>
              <instruction>
                Enter the equation of the tangent line here.
              </instruction>
              <p>
                <var name="$t" width="50"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-log-4">
          <webwork xml:id="webwork-ex-deriv-implicit-log-4">
            <pg-code>
              Context()->variables->set(x=>{limits=>[0.01,4]});
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $dydx=Formula("x^(sin(x)+2)(cos(x)*ln(x)+(sin(x)+2)/x)");
              Context("Numeric");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $t=Formula("y=(3pi^2)/4*(x-pi/2)+(pi/2)^3");
              $showwork = '[@ explanation_box(message => "Show your work using logarithmic differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>y=x^{\sin(x)+2}</m> at <m>x=\pi/2</m>
              </p>
              <instruction>
                Enter <m>\lz{y}{x}</m> here.
              </instruction>
              <p>
                <var name="$dydx" width="50"/>
              </p>
              <instruction>
                Enter the equation of the tangent line here.
              </instruction>
              <p>
                <var name="$t" width="50"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-log-5">
          <webwork xml:id="webwork-ex-deriv-implicit-log-5">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $dydx=Formula("(x+1)/(x+2)(1/(x+1)-1/(x+2))");
              Context("Numeric");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $t=Formula("y=1/9(x-1)+2/3");
              $showwork = '[@ explanation_box(message => "Show your work using logarithmic differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>y=\dfrac{x+1}{x+2}</m> at <m>x=1</m>
              </p>
              <instruction>
                Enter <m>\lz{y}{x}</m> here.
              </instruction>
              <p>
                <var name="$dydx" width="50"/>
              </p>
              <instruction>
                Enter the equation of the tangent line here.
              </instruction>
              <p>
                <var name="$t" width="50"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise label="ex-deriv-implicit-log-6">
          <webwork xml:id="webwork-ex-deriv-implicit-log-6">
            <pg-code>
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $dydx=Formula("((x+1)(x+2))/((x+3)(x+4))(1/(x+1)+1/(x+2)-1/(x+3)-1/(x+4))");
              Context("Numeric");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $t=Formula("y=11/72x+1/6");
              $showwork = '[@ explanation_box(message => "Show your work using logarithmic differentiation.") @]*';
            </pg-code>
            <statement>
              <p>
                <m>y=\dfrac{(x+1)(x+2)}{(x+3)(x+4)}</m> at <m>x=0</m>
              </p>
              <instruction>
                Enter <m>\lz{y}{x}</m> here.
              </instruction>
              <p>
                <var name="$dydx" width="50"/>
              </p>
              <instruction>
                Enter the equation of the tangent line here.
              </instruction>
              <p>
                <var name="$t" width="50"/>
              </p>
              <p>
                <var name="$showwork" data="pgml"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>
    </subexercises>
  </exercises>
</section>
