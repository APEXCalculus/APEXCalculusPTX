<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_deriv_inverse_function">
  <title>Derivatives of Inverse Functions</title>

  <figure xml:id="vid_deriv_inverse_intro" component="video">
    <caption>Video introduction to <xref ref="sec_deriv_inverse_function"/></caption>
    <video youtube="rBIBiDXbWf8"/>
  </figure>

  <p>
    Recall that a function <m>y=f(x)</m> is said to be <term>one-to-one</term>
    if it passes the horizontal line test;
    that is, for two different <m>x</m> values <m>x_1</m> and <m>x_2</m>,
    we do <em>not</em> have <m>f\mathopen{}\left(x_1\right)\mathclose{}=f\mathopen{}\left(x_2\right)\mathclose{}</m>.
    In some cases the domain of <m>f</m> must be restricted so that it is one-to-one.
    For instance, consider <m>f(x)=x^2</m>.
    Clearly, <m>f(-1)= f(1)</m>,
    so <m>f</m> is not one-to-one on its regular domain,
    but by restricting <m>f</m> to
    <m>(0,\infty)</m>, <m>f</m> is one-to-one.

        <idx><h>derivative</h><h>inverse function</h></idx>
  </p>

  <p>
    Now recall that one-to-one functions have <term>inverses</term>.
    That is, if <m>f</m> is one-to-one,
    it has an inverse function, denoted by <m>f^{-1}</m>,
    such that if <m>f(a)=b</m>, then <m>f^{-1}(b) = a</m>.
    The domain of <m>f^{-1}</m> is the range of <m>f</m>, and vice-versa.
    For ease of notation, we set
    <m>g=f^{-1}</m> and treat <m>g</m> as a function of <m>x</m>.
  </p>

  <p>
    Since <m>f(a)=b</m> implies <m>g(b)=a</m>,
    when we compose <m>f</m> and <m>g</m> we get a nice result:
    <me>
      f\big(g(b)\big) = f(a) = b
    </me>.
  </p>

  <p>
    In general, <m>f\big(g(x)\big) = x</m> and <m>g\big(f(x)\big) = x</m>.
    This gives us a convenient way to check if two functions are inverses of each other:
    compose them and if the result is <m>x</m>
    (on the appropriate domains),
    then they are inverses.
  </p>

  <figure xml:id="vid_deriv_inverse_prop" component="video">
    <caption>Properties of inverse functions</caption>
    <video youtube="1g9gAQC301Q"/>
  </figure>

  <p xml:id="vidint_derive_inverse_examples" component="video">
    For a refresher on how to determine the inverse of a given function,
    watch the following video.
  </p>

  <figure xml:id="vid_deriv_inverse_examples" component="video">
    <caption>Finding the inverse of a one-to-one function</caption>
    <video youtube="PsJKKckGcXE"/>
  </figure>

  <p>
    When the point <m>(a,b)</m> lies on the graph of <m>f</m>,
    the point <m>(b,a)</m> lies on the graph of <m>g</m>.
    This leads us to discover that the graph of <m>g</m> is the reflection of <m>f</m> across the line <m>y=x</m>.
    In <xref ref="fig_inverse1">Figure</xref>
    we see a function graphed along with its inverse.
    See how the point <m>(1,1.5)</m> lies on one graph,
    whereas <m>(1.5,1)</m> lies on the other.
    Because of this relationship,
    whatever we know about <m>f</m> can quickly be transferred into knowledge about <m>g</m>.
  </p>

  <figure xml:id="fig_inverse1">
    <caption>A function <m>f</m> along with its inverse <m>f^{-1}</m>. (Note how it does not matter which function we refer to as <m>f</m>; the other is <m>f^{-1}</m>.)</caption>
      <!-- START figures/fig_inverse1.tex -->
    <image xml:id="img_inverse1" width="47%">
      <description></description>
      <latex-image>

      \begin{tikzpicture}
      \begin{axis}[axis equal image,
      ymin=-1.3,ymax=2,
      xmin=-1.3,xmax=2,
      clip=false]
      \addplot+[domain=-1:1.14] ({x},{x^3+.5});
      \addplot+[domain=-1:1.14] ({x^3+.5},{x});
      \addplot [symmetryline] coordinates {(-1.3,-1.3) (1.7,1.7)};
      \addplot [soliddot] coordinates{(-.5,.375)} node[above left] {$(-0.5,0.375)$};
      \addplot [soliddot] coordinates{(.375,-.5)} node[below right] {$(0.375,-0.5)$};
      \addplot [soliddot] coordinates{(1,1.5)} node[above left] {$(1,1.5)$};
      \addplot [soliddot] coordinates{(1.5,1)} node[below right] {$(1.5,1)$};
      \end{axis}
      \end{tikzpicture}

      </latex-image>
    </image>
      <!-- figures/fig_inverse1.tex END -->
  </figure>

  <p>
    For example, consider <xref ref="fig_inverse2">Figure</xref>
    where the tangent line to <m>f</m> at the point <m>(1,1.5)</m> is drawn.
    That line has slope <m>3</m>.
    Through reflection across <m>y=x</m>,
    we can see that the tangent line to <m>g</m> at the point <m>(1.5,1)</m> has slope <m>1/3</m>.
    Their slopes are reciprocals.
    This should make sense since reflecting a line
    (such as a tangent line)
    across the line <m>y=x</m> switches the <m>x</m> and <m>y</m> values.
    Also consider the point <m>(0,0.5)</m> on the graph of <m>f</m>,
    where the tangent line is horizontal.
    At the point <m>(0.5,0)</m> on <m>g</m>,
    the tangent line is vertical.
  </p>

  <p>
    More generally,
    consider the tangent line to <m>f</m> at the point <m>(a,b)</m>.
    That line has slope <m>\fp(a)</m>.
    Through reflection across <m>y=x</m>,
    we can extend our above observation to say that the tangent line to <m>g</m> at the point <m>(b,a)</m> should have slope <m>1/\fp(a)</m>.
    This then tells us that <m>g'(b)=1/\fp(a)</m>.
  </p>

  <figure xml:id="fig_inverse2">
    <caption>Corresponding tangent lines drawn to <m>f</m> and <m>f^{-1}</m></caption>
      <!-- START figures/fig_inverse2.tex -->
    <image xml:id="img_inverse2" width="47%">
      <description></description>
      <latex-image>

      \begin{tikzpicture}
      \begin{axis}[axis equal image,
      ymin=-1.3,ymax=2,
      xmin=-1.3,xmax=2,
      clip=false,
      grid=both,
      xtick={-1,1},
      ytick={-1,1},
      minor xtick={-1.25,-1,...,2},
      minor ytick={-1.25,-1,...,2},]
      \addplot+[domain=-1:1.14] ({x},{x^3+.5});
      \addplot+[domain=-1:1.14] ({x^3+.5},{x});
      \addplot [symmetryline] coordinates {(-1.3,-1.3) (1.7,1.7)};
      \addplot [tangentlineseg,domain=0.75:1.25]{3*(x-1)+1.5};
      \addplot [tangentlineseg,domain=0.75:2]{1/3*(x-1.5)+1};
      \addplot [soliddot] coordinates{(-.5,.375)} node[above left] {$(-0.5,0.375)$};
      \addplot [soliddot] coordinates{(.375,-.5)} node[below right] {$(0.375,-0.5)$};
      \addplot [soliddot] coordinates{(1,1.5)} node[above left] {$(1,1.5)$};
      \addplot [soliddot] coordinates{(1.5,1)} node[below right] {$(1.5,1)$};
      \end{axis}
      \end{tikzpicture}

      </latex-image>
    </image>
      <!-- figures/fig_inverse2.tex END -->
  </figure>

  <p>
    The information from these two graphs is summarized in <xref ref="table_fandfinv"> Table </xref> below:
  </p>

  <table xml:id="table_fandfinv">
    <title/>
    <tabular>
      <col width="30%" halign="center"/>
      <col width="30%" halign="center"/>
      <row bottom="medium">
        <cell>Information about <m>f</m></cell>
        <cell>Information about <m>g=f^{-1}</m></cell>
      </row>
      <row>
        <cell><m>(1,1.5)</m> lies on <m>f</m></cell>
        <cell><m>(1.5,1)</m> lies on <m>g</m></cell>
      </row>
      <row>
        <cell>
          <p>
            Slope of tangent line to <m>f</m> at <m>x=1</m> is <m>3</m>
          </p>
        </cell>
        <cell>
          <p>
            Slope of tangent line to <m>g</m> at <m>x=1.5</m> is <m>1/3</m>
          </p>
        </cell>
      </row>
      <row>
        <cell><m>\fp(1) = 3</m></cell>
        <cell><m>g'(1.5) = 1/3</m></cell>
      </row>
    </tabular>

  </table>

  <p>
    We have discovered a relationship between <m>\fp</m> and <m>g'</m> in a mostly graphical way.
    We can realize this relationship analytically as well.
    Let <m>y = g(x)</m>, where again <m>g = f^{-1}</m>.
    We want to find <m>y'</m>.
    Since <m>y = g(x)</m>, we know that <m>f(y) = x</m>.
    Using the <xref ref="thm_chain_rule" text="title"/> and Implicit Differentiation,
    take the derivative of both sides of this last equality.
    <md>
      <mrow>\lzoo{x}{f(y)} \amp = \lzoo{x}{x}</mrow>
      <mrow>\fp(y)\cdot y' \amp = 1</mrow>
      <mrow>y' \amp = \frac{1}{\fp(y)}</mrow>
      <mrow>y' \amp = \frac{1}{\fp(g(x))}</mrow>
    </md>.
  </p>

  <p>
    This leads us to the following theorem.
  </p>

  <theorem xml:id="thm_deriv_inverse_functions">
    <title>Derivatives of Inverse Functions</title>
    <statement>
      <p>
        Let <m>f</m> be differentiable and one-to-one on an open interval <m>I</m>,
        where <m>\fp(x) \neq 0</m> for all <m>x</m> in <m>I</m>,
        let <m>J</m> be the range of <m>f</m> on <m>I</m>,
        let <m>g</m> be the inverse function of <m>f</m>,
        and let <m>f(a) = b</m> for some <m>a</m> in <m>I</m>.
        Then <m>g</m> is a differentiable function on <m>J</m>,
        and in particular,

        <ol cols="2">
          <li>
            <m>\left(f^{-1}\right)'(b)=g'(b) = \dfrac{1}{\fp(a)}</m>
          </li>

          <li>
            <m>\left(f^{-1}\right)'(x)=g'(x) = \dfrac{1}{\fp(g(x))}</m>
          </li>
        </ol>
      </p>
    </statement>
  </theorem>

  <figure xml:id="vid_deriv_inverse_inv_func_thm" component="video">
    <caption>Video presentation of <xref ref="thm_deriv_inverse_functions"/></caption>
    <video youtube="dOtVBJd75h8"/>
  </figure>

  <p>
    The results of <xref ref="thm_deriv_inverse_functions">Theorem</xref> are not trivial;
    the notation may seem confusing at first.
    Careful consideration, along with examples,
    should earn understanding.
  </p>

  <p>
    In the next example we apply <xref ref="thm_deriv_inverse_functions">Theorem</xref> to the arcsine function.
  </p>

  <p xml:id="vidint_deriv_inverse_restrict_domain" component="video">
    A word of caution is required here. The function <m>\sin(x)</m> is clearly not one-to-one.
    How can we say that <m>\arcsin(x)</m> is the inverse of <m>\sin(x)</m>?
    To make sense of this, we employ a technique known as <em>restriction of domain</em>:
    instead of considering the entire domain of the sine function,
    we consider a portion of it, on which the function is one-to-one,
    as explained in the following video.
  </p>

  <figure xml:id="vid_deriv_inverse_restrict_domain" component="video">
    <caption>Restricting the domain of <m>\sin(x)</m></caption>
    <video youtube="lCNZPbfiono"/>
  </figure>


  <example xml:id="ex_deriv_arcsin">
    <title>Finding the derivative of an inverse trigonometric function</title>
    <statement>
      <p>
        Let <m>y = \arcsin(x) = \sin^{-1}(x)</m>.
        Find <m>y'</m> using <xref ref="thm_deriv_inverse_functions">Theorem</xref>.
      </p>
    </statement>
    <solution>
      <title>Video solution</title>
      <video width="98%" youtube="xBZqkvQRSG4" xml:id="vid_deriv_inverse_deriv_arcsin" component="video"/>
    </solution>
    <solution>

      <p>
        Adopting our previously defined notation,
        let <m>g(x) = \arcsin(x) </m> and <m>f(x) = \sin(x)</m>.
        Thus <m>\fp(x) = \cos(x)</m>.
        Applying the theorem, we have
        <md>
          <mrow>g'(x) \amp = \frac{1}{\fp(g(x))}</mrow>
          <mrow>\amp = \frac{1}{\cos(\arcsin(x))}</mrow>
        </md>.
      </p>

      <p>
        This last expression is not immediately illuminating.
        Drawing a figure will help,
        as shown in <xref ref="fig_inverse3">Figure</xref>.
        Recall that the sine function can be viewed as taking in an angle and returning a ratio of sides of a right triangle,
        specifically,
        the ratio <q>opposite over hypotenuse.</q>
        This means that the arcsine function takes as input a ratio of sides and returns an angle.
        The equation <m>y=\arcsin(x)</m> can be rewritten as <m>y=\arcsin(x/1)</m>;
        that is, consider a right triangle where the hypotenuse has length <m>1</m> and the side opposite of the angle with measure <m>y</m> has length <m>x</m>.
        This means the final side has length <m>\sqrt{1-x^2}</m>,
        using the Pythagorean Theorem.
      </p>

      <figure xml:id="fig_inverse3">
        <caption>A right triangle defined by <m>y=\sin^{-1}(x/1)</m> with the length of the third leg found using the Pythagorean Theorem</caption>
          <!-- START figures/fig_inverse3.tex -->
        <image xml:id="img_inverse3" width="47%">
          <description></description>
          <latex-image>

          \begin{tikzpicture}
          \coordinate (O) at (0,0);
          \coordinate (A) at (5,0);
          \coordinate (B) at (5,3.75);
          \draw (O)--(A)--(B)--cycle;

          \tkzLabelSegment[below=0pt](O,A){$\sqrt{1-x^2}$}
          \tkzLabelSegment[above left=0pt](O,B){$1$}
          \tkzLabelSegment[right=0pt](A,B){$x$}

          \tkzMarkAngle[fill= orange,
          size=1,
          opacity=.4](A,O,B)
          \tkzLabelAngle[pos = 0.75](A,O,B){$y$}
          \end{tikzpicture}

          </latex-image>
        </image>
          <!-- figures/fig_inverse3.tex END -->
      </figure>

      <p>
        Therefore
        <md>
          <mrow>\cos\mathopen{}\left(\sin^{-1}(x)\right)\mathclose{} \amp= \cos(y)</mrow>
          <mrow>\amp = \frac{\sqrt{1-x^2}}{1}</mrow>
          <mrow>\amp = \sqrt{1-x^2}</mrow>
        </md>,
        resulting in
        <me>
          \lzoo{x}{\arcsin(x)} = \frac{1}{\sqrt{1-x^2}}
        </me>.
      </p>
    </solution>
  </example>

  <p>
    Remember that the input <m>x</m> of the arcsine function is a ratio of a side of a right triangle to its hypotenuse;
    the absolute value of this ratio will never be greater than <m>1</m>.
    Therefore the inside of the square root will never be negative.
  </p>

  <p>
    In order to make <m>y=\sin(x)</m> one-to-one,
    we restrict its domain to <m>[-\pi/2,\pi/2]</m>;
    on this domain, the range is <m>[-1,1]</m>.
    Therefore the domain of <m>y=\arcsin(x)</m> is <m>[-1,1]</m> and the range is <m>[-\pi/2,\pi/2]</m>.
    When <m>x=\pm 1</m>,
    note how the derivative of the arcsine function is undefined;
    this corresponds to the fact that as <m>x\to \pm1</m>,
    the tangent lines to arcsine approach vertical lines with undefined slopes.
  </p>

  <figure xml:id="fig_inversesine">
  <caption>Graphs of <m>\sin(x)</m> and <m>\sin^{-1}(x)</m> along with corresponding tangent lines</caption>
  <sidebyside widths="47% 47%" margins="0%">
      <!-- START figures/fig_inverse4.tex -->
      <image xml:id="img_inverse4">
        <description></description>
        <latex-image>

        \begin{tikzpicture}
        \begin{axis}[ymin=-1.7,ymax=1.7,
        xmin=-1.7,xmax=1.7,
        xtick={-1.57,-.79,.79,1.57},
        xticklabels={$-\frac{\pi}{2}$,$-\frac{\pi}{4}$,$\frac{\pi}{4}$,$\frac{\pi}{2}$},
        axis equal]

        \addplot+[domain=-1.57:1.57,-] (x,{sin(deg(x))}) node [pos=0.5,above,sloped]{$y=\sin(x)$};
        \addplot [tangentline,domain=.42:1.7] {.5*(x-pi/3)+sqrt(3)/2};
        \addplot [soliddot] coordinates {(1.06,.866)} node [above left] {$\left(\frac{\pi}{3},\frac{\sqrt{3}}{2}\right)$};
        \end{axis}
        \end{tikzpicture}

        </latex-image>
      </image>

      <image xml:id="img_inverse5">
        <description></description>
        <latex-image>

        \begin{tikzpicture}
        \begin{axis}[ymin=-1.7,ymax=1.7,
        xmin=-1.7,xmax=1.7,
        ytick={-1.57,-.79,.79,1.57},
        yticklabels={$-\frac{\pi}{2}$,$-\frac{\pi}{4}$,$\frac{\pi}{4}$,$\frac{\pi}{2}$},
        axis equal]
        \addplot+[domain=-1.57:1.57,-] ({sin(deg(x))},x) node [pos=0.5,above,sloped]{$y=\sin^{-1}(x)$};
        \addplot [tangentline,domain=.42:1.7] ({.5*(x-pi/3)+sqrt(3)/2},{x});
        \addplot [soliddot] coordinates {(0.866,1.06)} node [below right] {$\left(\frac{\sqrt{3}}{2},\frac{\pi}{3}\right)$};
        \end{axis}
        \end{tikzpicture}

        </latex-image>
      </image>
  </sidebyside>
  </figure>

  <p>
    In <xref ref="fig_inversesine">Figure</xref>
    we see <m>f(x) = \sin(x)</m> and
    <m>f^{-1}(x) = \sin^{-1}(x)</m> graphed on their respective domains.
    The line tangent to <m>\sin(x)</m> at the point
    <m>\left(\pi/3, \sqrt{3}/2\right)</m> has slope <m>\cos(\pi)/3 = 1/2</m>.
    The slope of the corresponding point on <m>\sin^{-1}(x)</m>,
    the point <m>\left(\sqrt{3}/2,\pi/3\right)</m>, is
    <md>
      <mrow>\frac{1}{\sqrt{1-\left(\sqrt{3}/2\right)^2}} \amp  = \frac{1}{\sqrt{1-3/4}}</mrow>
      <mrow>\amp = \frac{1}{\sqrt{1/4}}</mrow>
      <mrow>\amp = \frac{1}{1/2}=2</mrow>
    </md>,
    verifying yet again that at corresponding points,
    a function and its inverse have reciprocal slopes.
  </p>

  <p>
    Using similar techniques,
    we can find the derivatives of all the inverse trigonometric functions.
    In <xref ref="tab_domain_trig">Table</xref>
    we show the restrictions of the domains of the standard trigonometric functions that allow them to be invertible.
  </p>

  <table xml:id="tab_domain_trig">
    <title>Domains and ranges of the trigonometric and inverse trigonometric functions</title>
    <tabular>
      <row bottom="medium">
        <cell>Function</cell>
        <cell>Domain</cell>
        <cell>Range</cell>
      </row>
      <row>
        <cell><m>\sin(x)</m></cell>
        <cell><m>[-\pi/2, \pi/2]</m></cell>
        <cell><m>[-1,1]</m></cell>
      </row>
      <row>
        <cell><m>\sin^{-1}(x)</m></cell>
        <cell><m>[-1,1]</m></cell>
        <cell><m>[-\pi/2, \pi/2]</m></cell>
      </row>
      <row>
        <cell><m>\cos(x)</m></cell>
        <cell><m>[0,\pi]</m></cell>
        <cell><m>[-1,1]</m></cell>
      </row>
      <row>
        <cell><m>\cos^{-1}(x)</m></cell>
        <cell><m>[-1,1]</m></cell>
        <cell><m>[0,\pi]</m></cell>
      </row>
      <row>
        <cell><m>\tan(x)</m></cell>
        <cell><m>(-\pi/2,\pi/2)</m></cell>
        <cell><m>(-\infty,\infty)</m></cell>
      </row>
      <row>
        <cell><m>\tan^{-1}(x)</m></cell>
        <cell><m>(-\infty,\infty)</m></cell>
        <cell><m>(-\pi/2,\pi/2)</m></cell>
      </row>
      <row>
        <cell><m>\csc(x)</m></cell>
        <cell><m>[-\pi/2,0)\cup (0, \pi/2]</m></cell>
        <cell><m>(-\infty,-1]\cup [1,\infty)</m></cell>
      </row>
      <row>
        <cell><m>\csc^{-1}(x)</m></cell>
        <cell><m>(-\infty,-1]\cup [1,\infty)</m></cell>
        <cell><m>[-\pi/2,0)\cup (0, \pi/2]</m></cell>
      </row>
      <row>
        <cell><m>\sec(x)</m></cell>
        <cell><m>[0,\pi/2)\cup (\pi/2,\pi]</m></cell>
        <cell><m>(-\infty,-1]\cup [1,\infty)</m></cell>
      </row>
      <row>
        <cell><m>\sec^{-1}(x)</m></cell>
        <cell><m>(-\infty,-1]\cup [1,\infty)</m></cell>
        <cell><m>[0,\pi/2)\cup (\pi/2,\pi]</m></cell>
      </row>
      <row>
        <cell><m>\cot(x)</m></cell>
        <cell><m>(0,\pi)</m></cell>
        <cell><m>(-\infty,\infty)</m></cell>
      </row>
      <row>
        <cell><m>\cot^{-1}(x)</m></cell>
        <cell><m>(-\infty,\infty)</m></cell>
        <cell><m>(0,\pi)</m></cell>
      </row>
    </tabular>

  </table>

  <theorem xml:id="thm_deriv_inverse_trig">
    <title>Derivatives of Inverse Trigonometric Functions</title>
    <statement>
      <p>
        The inverse trigonometric functions are differentiable on all open sets contained in their domains
        (as listed in <xref ref="tab_domain_trig">Table</xref>)
        and their derivatives are as follows:

        <ol>
          <li><m>\lzoo{x}{\sin^{-1}(x)} = \frac{1}{\sqrt{1-x^2}}</m></li>

          <li><m>\lzoo{x}{\cos^{-1}(x)} = -\frac{1}{\sqrt{1-x^2}}</m></li>

          <li><m>\lzoo{x}{\tan^{-1}(x)} = \frac{1}{1+x^2}</m></li>

          <li><m>\lzoo{x}{\csc^{-1}(x)} = -\frac{1}{\abs{x}\sqrt{x^2-1}}</m></li>

          <li><m>\lzoo{x}{\sec^{-1}(x)} = \frac{1}{\abs{x}\sqrt{x^2-1}}</m></li>

          <li><m>\lzoo{x}{\cot^{-1}(x)} = -\frac{1}{1+x^2}</m></li>
        </ol>

        <idx><h>derivative</h><h>inverse trig.</h></idx>

      </p>
    </statement>
  </theorem>

  <p>
    Note how each derivative is the negative of the derivative of its <q>co</q> function.
    Because of this, derivatives of
    <m>\sin^{-1}(x)</m>, <m>\tan^{-1}(x)</m>,
    and <m>\sec^{-1}(x)</m> are used almost exclusively throughout this text.
  </p>

  <figure xml:id="vid_deriv_inverse_seriv_arctan" component="video">
    <caption>Computing the derivative of <m>\arctan(x)</m></caption>
    <video youtube="yO-BT5vEZ9A"/>
  </figure>


  <p>
    In <xref ref="sec_basic_diff_rules">Section</xref>,
    we stated without proof or explanation that <m>\lzoo{x}{\ln(x)}=\frac{1}{x}</m>.
    We can justify that now using <xref ref="thm_deriv_inverse_functions">Theorem</xref>,
    as shown in the example.
  </p>

  <example xml:id="ex_deriv_lnx">
    <title>Finding the derivative of <m>y=\ln(x)</m></title>
    <statement>
      <p>
        Use <xref ref="thm_deriv_inverse_functions">Theorem</xref>
        to compute <m>\lzoo{x}{\ln(x)}</m>.
      </p>
    </statement>
    <solution>
      <p>
        View <m>y= \ln(x)</m> as the inverse of <m>y = e^x</m>.
        Therefore, using our standard notation,
        let <m>f(x) = e^x</m> and <m>g(x) = \ln(x)</m>.
        We wish to find <m>g'(x)</m>.
        <xref ref="thm_deriv_inverse_functions">Theorem</xref> gives:
        <md>
          <mrow>g'(x) \amp = \frac{1}{\fp(g(x))}</mrow>
          <mrow>\amp = \frac{1}{e^{\ln(x) }}</mrow>
          <mrow>\amp = \frac{1}{x}</mrow>
        </md>.
      </p>
    </solution>
  </example>

  <p>
    In this chapter we have defined the derivative,
    given rules to facilitate its computation,
    and given the derivatives of a number of standard functions.
    We restate the most important of these in the following theorem,
    intended to be a reference for further work.
  </p>

  <theorem xml:id="thm_deriv_glossary">
    <title>Glossary of Derivatives of Elementary Functions</title>
    <statement>
      <p>
        Let <m>f</m> and <m>g</m> be differentiable functions,
        and let <m>a</m>,
        <m>c</m> and <m>n</m> be real numbers,
        <m>a \gt 0</m>, <m>n\neq 0</m>.
      </p>

      <p>
        <ol cols="2">
          <li><m>\lzoo{x}{c} = 0</m></li>

          <li><m>\lzoo{x}{x} = 1</m></li>

          <li><m>\lzoo{x}{x^n} = nx^{n-1}</m></li>

          <li><m>\lzoo{x}{f(x)\pm g(x)} = f'(x) \pm g'(x)</m></li>

          <li><m>\lzoo{x}{c\cdot f(x)} = c\cdot f'(x)</m></li>

          <li><m>\lzoo{x}{f(x)\cdot g(x)} = f'(x)\cdot g(x)+f(x)\cdot g'(x)</m></li>

          <li><m>\lzoo{x}{f(g(x))} = f'(g(x)) \cdot g'(x)</m></li>

          <li><m>\lzoo{x}{\frac{f(x)}{g(x)}} = \frac{f'(x)\cdot g(x)-f(x) \cdot g'(x)}{(g(x))^2}</m></li>

          <li><m>\lzoo{x}{e^x} = e^x</m></li>

          <li><m>\lzoo{x}{\ln(x)} = \frac{1}{x}</m></li>

          <li><m>\lzoo{x}{a^x} = \ln(a)\cdot a^x</m></li>

          <li><m>\lzoo{x}{\log_a x} = \frac{1}{\ln(a)}\cdot\frac{1}{x}</m></li>

          <li><m>\lzoo{x}{\sin(x)} = \cos(x)</m></li>

          <li><m>\lzoo{x}{\cos(x)} = -\sin(x)</m></li>

          <li><m>\lzoo{x}{\tan(x)} = \sec^2(x)</m></li>

          <li><m>\lzoo{x}{\csc(x)} = -\csc(x)\cot(x)</m></li>

          <li><m>\lzoo{x}{\sec(x)} = \sec(x)\tan(x)</m></li>

          <li><m>\lzoo{x}{\cot(x)} = -\csc^2(x)</m></li>

          <li><m>\lzoo{x}{\sin^{-1}(x)} = \frac{1}{\sqrt{1-x^2}}</m></li>

          <li><m>\lzoo{x}{\cos^{-1}(x)} = -\frac{1}{\sqrt{1-x^2}}</m></li>

          <li><m>\lzoo{x}{\tan^{-1}(x)} = \frac{1}{1+x^2}</m></li>

          <li><m>\lzoo{x}{\csc^{-1}(x)} = -\frac{1}{\abs{x}\sqrt{x^2-1}}</m></li>

          <li><m>\lzoo{x}{\sec^{-1}(x)} = \frac{1}{\abs{x}\sqrt{x^2-1}}</m></li>

          <li><m>\lzoo{x}{\cot^{-1}(x)} = -\frac{1}{1+x^2}</m></li>
        </ol>
      </p>
    </statement>
  </theorem>

  <exercises>
    <subexercises>
      <title>Terms and Concepts</title>
      <exercise>
        <webwork>
          <pg-code>
            $tf=PopUp(['?','True','False'],2);
          </pg-code>
          <statement>
            <p>
              <var name="$tf" form="popup"/>
              Every function has an inverse.
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise>
        <webwork>
          <statement>
            <p>
              In your own words explain what it means for a function to be <q>one-to-one.</q>
            </p>
            <p>
              <var form="essay"/>
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise>
        <webwork>
          <statement>
            <p>
              If <m>(1,10)</m> lies on the graph of <m>y=f(x)</m>,
              what can be said about the graph of <m>y=f^{-1}(x)</m>?
            </p>
            <p>
              <var form="essay"/>
            </p>
          </statement>
          <solution>
            <p>
              The point <m>(10,1)</m> lies on the graph of <m>y=f^{-1}(x)</m>
              (assuming <m>f</m> is invertible).
            </p>
          </solution>
        </webwork>
      </exercise>

      <exercise>
        <webwork>
          <statement>
            <p>
              If <m>(1,10)</m> lies on the graph of <m>y=f(x)</m> and <m>\fp(1) = 5</m>,
              what can be said about <m>y=f^{-1}(x)</m>?
            </p>
            <p>
              <var form="essay"/>
            </p>
          </statement>
          <solution>
            <p>
              The point <m>(10,1)</m> lies on the graph of <m>y=f^{-1}(x)</m>
              (assuming <m>f</m> is invertible)
              and <m>(f^{-1})'(10) = 1/5</m>.
            </p>
          </solution>
        </webwork>
      </exercise>
    </subexercises>

    <subexercises>
      <title>Problems</title>
      <exercisegroup>
        <introduction>
          <p>
            Verify that the given functions are inverses.
          </p>
        </introduction>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x) = 2x+6</m> and
                <m>g(x) = \frac{1}{2}x-3</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                Compose <m>f(g(x))</m> and <m>g(f(x))</m> to confirm that each equals <m>x</m>.
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x) = x^2+6x+11</m>, <m>x\geq 3</m> and
                <m>g(x) = \sqrt{x-2}-3</m>, <m>x\geq 2</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                Compose <m>f(g(x))</m> and <m>g(f(x))</m> to confirm that each equals <m>x</m>.
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x) = \frac{3}{x-5}</m>, <m>x\neq 5</m> and
                <m>g(x) = \frac{3+5x}{x}</m>, <m>x\neq 0</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                Compose <m>f(g(x))</m> and <m>g(f(x))</m> to confirm that each equals <m>x</m>.
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x) = \frac{x+1}{x-1}</m>, <m>x\neq 1</m> and
                <m>g(x) = f(x)</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                Compose <m>f(g(x))</m> and <m>g(f(x))</m> to confirm that each equals <m>x</m>.
              </p>
            </solution>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup>
        <introduction>
          <p>
            An invertible function <m>f(x)</m> is given along with a point that lies on its graph.
            Using <xref ref="thm_deriv_inverse_functions">Theorem</xref>,
            evaluate <m>\left(f^{-1}\right)'(x)</m> at the indicated value.
          </p>
        </introduction>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              ($m,$b,$x0) = (2..10)[NchooseK(9,3)];
              if($envir{problemSeed}==1){$m=5; $b=10; $x0=2;};
              $f = Formula("$m x + $b");
              $y0 = $f->eval(x=>$x0);
              $point = Point($x0,$y0);
              $fip = Fraction(1,$m);
            </pg-code>
            <statement>
              <p>
                The point <m><var name="$point"/></m> is on the graph of <m>f(x) = <var name="$f"/></m>.
                Find <m>\left(f^{-1}\right)'(<var name="$y0"/>)</m>.
              </p>
              <p>
                <var name="$fip" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              ($h,$c,$x0) = (-9..-1,1..9)[NchooseK(18,3)];
              if($envir{problemSeed}==1){$h=1; $c=4; $x0=3;};
              $f = Formula("x^2 - 2*$a x + $c")->reduce;
              $y0 = $f->eval(x=>$x0);
              $point = Point($x0,$y0);
              $fp = $f->D('x');
              $fpx0 = $fp->eval(x=>$x0);
              $fipy0 = Fraction(1/$fpx0);
            </pg-code>
            <statement>
              <p>
                The point <m><var name="$point"/></m> is on the graph of <m>f(x) = <var name="$f"/>, x\geq 1</m>.
                Find <m>\left(f^{-1}\right)'(<var name="$y0"/>)</m>.
              </p>
              <p>
                <var name="$fipy0" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction")->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $n = random(2,4,1);
              $d = list_random(6*$n,4*$n,3*$n);
              $trig = list_random('sin','cos');
              if($envir{problemSeed}==1){$n=2; $d=6; $trig='sin';};
              $x0 = Formula("pi/$d");
              $f = Formula("$trig($n x)");
              ($num2,$den2) = Fraction($f->eval(x=>$x0->eval(x=>0))**2)->value;
              if ($num2 == 3) {
                $y0 = Formula("sqrt(3)/2");
              } elsif ($den2 == 2) {
                $y0 = Formula("sqrt(2)/2");
              } else {
                $y0 = Formula("1/2");
              };
              $fp = $f->D('x');
              $fpx0 = $fp->eval(x=>$x0->eval(x=>0));
              $fipy0 = 1/$fpx0;
              if ($fipy0 == 1/sqrt(3)) {$fipy0 = Formula("sqrt(3)/3");}
              elsif ($fipy0 == 2/(3*sqrt(3))) {$fipy0 = Formula("2 sqrt(3)/3");}
              elsif ($fipy0 == 1/(2*sqrt(3))) {$fipy0 = Formula("sqrt(3)/6");}
              elsif ($fipy0 == 1/sqrt(2)) {$fipy0 = Formula("sqrt(2)/2");}
              elsif ($fipy0 == sqrt(2)/3) {$fipy0 = Formula("sqrt(2)/3");}
              elsif ($fipy0 == 1/(2*sqrt(2))) {$fipy0 = Formula("sqrt(2)/4");}
              elsif ($fipy0 == 1) {$fipy0 = Formula("1");}
              elsif ($fipy0 == 2/3) {$fipy0 = Formula("2/3");}
              elsif ($fipy0 == 1/2) {$fipy0 = Formula("1/2");};
              $d2 = 2*$n;
              if ($trig eq 'sin') {
                $low = Formula("-pi/$d2");
                $high = Formula("pi/$d2");
              } else {
                $low = Formula("0");
                $high = Formula("pi/$n");
              }
            </pg-code>
            <statement>
              <p>
                The point <m>\left(<var name="$x0"/>,<var name="$y0"/>\right)</m> is on the graph of <m>f(x) = <var name="$f"/>,
                <var name="$low"/>\leq x\leq <var name="$high"/></m>.
                Find <m>\left(f^{-1}\right)'\left(<var name="$y0"/>\right)</m>.
              </p>
              <p>
                <var name="$fipy0" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              ($h,$k,$c) = (-9..-1,1..9)[NchooseK(18,3)];
              $x0 = non_zero_random(-9,9,1);
              if($envir{problemSeed}==1){$h=2; $k=1; $c=-2; $x0=1;};
              $f = Formula("x^3 - (3*$h) x^2 + 3*(($h)^2+$k) x + $c")->reduce;
              $y0 = $f->eval(x=>$x0);
              $point = Point($x0,$y0);
              $fp = $f->D('x');
              $fpx0 = $fp->eval(x=>$x0);
              $fipy0 = Fraction(1/$fpx0);
            </pg-code>
            <statement>
              <p>
                The point <m><var name="$point"/></m> is on the graph of <m>f(x) = <var name="$f"/></m>.
                Find <m>\left(f^{-1}\right)'(<var name="$y0"/>)</m>.
              </p>
              <p>
                <var name="$fipy0" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              $n = random(2,5,1);
              $x0 = random(1,2,1);
              if($envir{problemSeed}==1){$n=2; $x0=1;};
              $f = Formula("1/(1+x^$n)")->reduce;
              $y0 = Fraction($f->eval(x=>$x0));
              $point = Point($x0,$y0);
              $fp = $f->D('x');
              $fpx0 = $fp->eval(x=>$x0);
              $fipy0 = Fraction(1/$fpx0);
            </pg-code>
            <statement>
              <p>
                The point <m><var name="$point"/></m> is on the graph of <m>f(x) = <var name="$f"/>, x\geq 0</m>.
                Find <m>\left(f^{-1}\right)'\left(<var name="$y0"/>\right)</m>.
              </p>
              <p>
                <var name="$fipy0" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              ($a,$k) = (2..9)[NchooseK(8,2)];
              if($envir{problemSeed}==1){$a=6; $k=3;};
              $x0 = 0;
              $f = Formula("$a e^($k x)");
              $y0 = $f->eval(x=>$x0);
              $point = Point($x0,$y0);
              $fp = $f->D('x');
              $fpx0 = $fp->eval(x=>$x0);
              $fipy0 = Fraction(1/$fpx0);
            </pg-code>
            <statement>
              <p>
                The point <m><var name="$point"/></m> is on the graph of <m>f(x) = <var name="$f"/></m>.
                Find <m>\left(f^{-1}\right)'(<var name="$y0"/>)</m>.
              </p>
              <p>
                <var name="$fipy0" width="20"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2">
        <introduction>
          <p>
            Compute the derivative of the given function.
          </p>
        </introduction>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $k = random(2,9,1);
              $trig = list_random('sin','cos');
              if($envir{problemSeed}==1){$fname='h'; $x='t'; $k = 2; $trig = 'sin'};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[-1/$k,1/$k]});
              $f = Formula("$trig^-1($k $x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $k = random(2,9,1);
              $trig = list_random('sec','csc');
              if($envir{problemSeed}==1){$fname='f'; $x='t'; $k = 2; $trig = 'sec'};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[1/$k,10/$k]});
              $f = Formula("$trig^-1($k $x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $k = random(2,9,1);
              $trig = list_random('tan','cot');
              if($envir{problemSeed}==1){$fname='g'; $x='x'; $k = 2; $trig = 'tan'};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $f = Formula("$trig^-1($k $x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $trig = list_random('sin','cos');
              if($envir{problemSeed}==1){$fname='f'; $x='x'; $trig = 'sin'};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[-1,1]});
              $f = Formula("$x $trig^-1($x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              ($triga,$trigb) = ('sin','cos','tan')[NchooseK(3,2)];
              if($envir{problemSeed}==1){$fname='g'; $x='t'; $triga = 'sin'; $trigb ='cos';};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[-1,1]});
              $f = Formula("$triga($x) $trigb^-1($x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context()->variables->are(t=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set(t=>{limits=>[1,5]});
              $fp=Formula("e^t/t+ln(t)e^t");
            </pg-code>
            <statement>
              <p>
                <m>f(t) = \ln(t) e^t</m>
              </p>
              <p>
                <var name="$fp" width="40"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              ($triga,$trigb) = ('sin','cos','tan')[NchooseK(3,2)];
              if($envir{problemSeed}==1){$fname='h'; $x='x'; $triga = 'sin'; $trigb ='cos';};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[-1,1]});
              $f = Formula("$triga^-1($x)/$trigb^-1($x)");
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $trig = list_random('tan','cot');
              $n = random(2,4,1);
              if($envir{problemSeed}==1){$fname='g'; $x='x'; $trig = 'tan'; $n = 2};
              Context("Fraction");
              parser::Root->Enable;
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[0,pi/2]});
              $f = Formula("$trig(root($n,$x))");
              $f = Formula("$trig(sqrt($x))") if ($n == 2);
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <instruction>
                To enter <m>\sqrt{x}</m>, type <c>sqrt(x)</c>.
                To enter <m>\sqrt[n]{x}</m>, type <c>root(n,x)</c>.
              </instruction>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $trig = list_random('sec','csc');
              $n = random(1,4,1);
              if($envir{problemSeed}==1){$fname='f'; $x='x'; $trig = 'sec'; $n = 1};
              Context("Fraction");
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[0,pi/2]});
              $f = Formula("$trig(1/$x^$n)")->reduce;
              $fp = $f->D($x);
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              $fname = list_random('f','g','h','j','k','p','m');
              $x = list_random('q','r','t','x','y','z','w');
              $trig = list_random('sin','cos','tan','cot','sec','csc');
              if($envir{problemSeed}==1){$fname='f'; $x='x'; $trig = 'sin'};
              Context()->variables->are($x=>'Real');
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              Context()->variables->set($x=>{limits=>[-1,1]});
              $f = Formula("$trig($trig^-1($x))");
              $fp = Formula("1");
            </pg-code>
            <statement>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = <var name="$f"/></m>
              </p>
              <p>
                <var name="$fp" width="80"/>
              </p>
            </statement>
            <solution>
              <p>
                <m><var name="$fname"/>(<var name="$x"/>) = x</m>, so <m>\fp(x) = 1</m>.
              </p>
            </solution>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="3">
        <introduction>
          <p>
            Compute the derivative of the given function in two ways:
            <ol>
              <li>
                <p>
                  By simplifying first, then taking the derivative, and
                </p>
              </li>
              <li>
                <p>
                  by using the Chain Rule first then simplifying.
                </p>
              </li>
            </ol>
            Verify that the two answers are the same.
          </p>
        </introduction>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x)=\sin(\sin^{-1}(x))</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                <ol>
                  <li>
                    <p>
                      <m>f(x) = x</m>, so <m>\fp(x) = 1</m>.
                    </p>
                  </li>
                  <li>
                    <p>
                      <m>\fp(x) = \cos(\sin^{-1}(x) )\frac{1}{\sqrt{1-x^2}} = 1</m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x)=\tan^{-1}(\tan(x))</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                <ol>
                  <li>
                    <p>
                      <m>f(x) = x</m>, so <m>\fp(x) = 1</m>.
                    </p>
                  </li>
                  <li>
                    <p>
                      <m>\fp(x) = \frac{1}{1+\tan^2(x) }\sec^2(x) = 1</m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <statement>
              <p>
                <m>f(x)=\sin(\cos^{-1}(x))</m>
              </p>
              <p>
                <var form="essay"/>
              </p>
            </statement>
            <solution>
              <p>
                <ol>
                  <li>
                    <p>
                      <m>f(x) = \sqrt{1-x^2}</m>, so <m>\fp(x) = \frac{-x}{\sqrt{1-x^2}}</m>.
                    </p>
                  </li>
                  <li>
                    <p>
                      <m>\fp(x) = \cos(\cos^{-1}(x) ) \frac{1}{\sqrt{1-x^2}} =\frac{-x}{\sqrt{1-x^2}}</m>.
                    </p>
                  </li>
                </ol>
              </p>
            </solution>
          </webwork>
        </exercise>
      </exercisegroup>

      <exercisegroup cols="2">
        <introduction>
          <p>
            Find the equation of the line tangent to the graph of <m>f</m> at the indicated <m>x</m> value.
          </p>
        </introduction>
        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $x0 = list_random('1/2','sqrt(2)/2','sqrt(3)/2');
              $sign = list_random('-','');
              if($envir{problemSeed}==1){$x0='sqrt(2)/2';$sign=''};
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $f = Formula("sin^-1(x)");
              if ($x0 eq '1/2') {
                $m = Formula("2sqrt(3)/3");
                $y0 = Formula("pi/6");
              }
              elsif ($x0 eq 'sqrt(2)/2') {
                $m = Formula("sqrt(2)");
                $y0 = Formula("pi/4");
              }
              elsif ($x0 eq 'sqrt(3)/2') {
                $m = Formula("2");
                $y0 = Formula("pi/3");
              };
              $x0 = Formula("$sign $x0");
              $y0 = Formula("$sign $y0");
              $t=Formula("y=$m(x-$x0)+$y0");
            </pg-code>
            <statement>
              <p>
                <m>f(x)=\sin^{-1}(x)</m> at <m>x=<var name="$x0"/></m>
              </p>
              <p>
                <var name="$t" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>

        <exercise>
          <webwork>
            <pg-code>
              Context("Fraction");
              Context()->flags->set(reduceConstants=>0,reduceConstantFunctions=>0);
              $x0 = list_random('1/4','sqrt(2)/4','sqrt(3)/4');
              $sign = list_random('-','');
              if($envir{problemSeed}==1){$x0='sqrt(3)/4';$sign=''};
              Context()->variables->add(y=>'Real');
              parser::Assignment->Allow;
              $f = Formula("cos^-1(2x)");
              if ($x0 eq '1/4') {
                $m = Formula("-4sqrt(3)/3");
                if ($sign eq '') {$y0 = Formula("pi/3")}
                else {$y0 = Formula("2pi/3")};
              }
              elsif ($x0 eq 'sqrt(2)/4') {
                $m = Formula("-2sqrt(2)");
                if ($sign eq '') {$y0 = Formula("pi/4")}
                else {$y0 = Formula("3pi/4")};
              }
              elsif ($x0 eq 'sqrt(3)/4') {
                $m = Formula("-4");
                if ($sign eq '') {$y0 = Formula("pi/6")}
                else {$y0 = Formula("5pi/6")};
              };
              $x0 = Formula("$sign $x0");
              $t=Formula("y=$m(x-$x0)+$y0");
            </pg-code>
            <statement>
              <p>
                <m>f(x)=\cos^{-1}(2x)</m> at <m>x=<var name="$x0"/></m>
              </p>
              <p>
                <var name="$t" width="80"/>
              </p>
            </statement>
          </webwork>
        </exercise>
      </exercisegroup>
    </subexercises>

    <subexercises>
      <title>Review</title>
      <exercise>
        <webwork>
          <pg-code>
            Context()->variables->add(y=>'Real');
            ($m,$n) = (1..4)[NchooseK(4,2)];
            if($envir{problemSeed}==1){$m=1;$n=2};
            $left = Formula("x^2y^$m-y^$n x")->reduce;
            @y=(random(0.1,5,0.1),random(0.1,5,0.1),random(0.1,5,0.1),random(0.1,5,0.1),random(0.1,5,0.1));
            @x=map{($_**$n + list_random(-1,1)*sqrt($_**(2*$n) + 4*$_**$m))/(2*$_**$m)}(@y);
            @xy=map{[$x[$_],$y[$_]]}(0..4);
            $dydx = Formula("(y^$n-2xy^$m)/($m x^2 y^($m-1) - $n x y^($n-1))")->reduce;
            $dydx->{test_points}=~~@xy;
          </pg-code>
          <statement>
            <p>
              Find <m>\lz{y}{x}</m>, where <m><var name="$left"/>=1</m>.
            </p>
            <p>
              <var name="$dydx" width="80"/>
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise>
        <webwork>
          <pg-code>
            Context("Fraction");
            Context()->variables->add(y=>'Real');
            parser::Assignment->Allow;
            do {
              $n = random(2,4,1);
              ($x0,$y0) = (-3..-1,1..3)[NchooseK(6,2)];
              $pm=list_random('+','-');
            } until ($x0 != $n*$y0**($n-1) and $x0 != -$n*$y0**($n-1));
            if($envir{problemSeed}==1){$n=2;$x0=1;$y0=2;$pm='+'};
            $left = Formula("x^$n+y^$n $pm xy");
            $c = $left->eval(x=>$x0,y=>$y0);
            if ($pm eq '+') {$m = Fraction(-$n*$x0**($n-1)-$y0,$n*$y0**($n-1)+$x0)}
            else {$m = Fraction(-$n*$x0**($n-1)+$y0,$n*$y0**($n-1)-$x0)};
            $t=Formula("y=$m(x-$x0)+$y0")->reduce;
          </pg-code>
          <statement>
            <p>
              Find the equation of the line tangent to the graph of
              <m><var name="$left"/>=<var name="$c"/></m> at the point <m>(<var name="$x0"/>,<var name="$y0"/>)</m>.
            </p>
            <p>
              <var name="$t" width="80"/>
            </p>
          </statement>
        </webwork>
      </exercise>

      <exercise>
        <webwork>
          <pg-code>
            $n = random(3,4,1);
            $b = non_zero_random(-2,2,1);
            if($envir{problemSeed}==1){$n=3;$b=1;};
            $f = Formula("x^$n+$b x")->reduce;
            $l = $f->D('x');
          </pg-code>
          <statement>
            <p>
              Let <m>f(x) = <var name="$f"/></m>. Find <m>\lim\limits_{s\to 0} \frac{f(x+s)-f(x)}{s}</m>.
            </p>
            <p>
              <var name="$l" width="80"/>
            </p>
          </statement>
        </webwork>
      </exercise>
    </subexercises>
  </exercises>
</section>
