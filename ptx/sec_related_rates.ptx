<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="sec_related_rates" label="sec_related_rates">
  <title>Related Rates</title>

  <figure xml:id="vid_deriv_apps_rel_rates_intro" component="video" vshift="0">
    <caption>Video introduction to <xref ref="sec_related_rates"/></caption>
    <video youtube="TKqYEDaAidQ" label="vid_deriv_apps_rel_rates_intro"/>
  </figure>

  <p>
    When two quantities are related by an equation,
    knowing the value of one quantity can determine the value of the other.
    For instance,
    the circumference and radius of a circle are related by <m>C=2\pi r</m>;
    knowing that <m>C</m> is
    <quantity>
      <mag>6\pi</mag><unit base="inch"/>
    </quantity>
    determines the radius must be
    <quantity>
      <mag>3</mag><unit base="inch"/>
    </quantity>.
  </p>

  <p>
    But what if both variables are changing with time?
    If we know how two variables are related and we know how one of them changes with time,
    can we find how the other variable changes with time?
  </p>

  <p>
    The topic of <term>related rates</term>
    allows us to answer this question:
    knowing the <em>rate</em> at which one quantity is changing can determine the
    <em>rate</em> at which another changes.

    <idx><h>related rates</h></idx>

  </p>

  <remark>
    <p>
      This section relies heavily on implicit differentiation,
      so referring back to <xref ref="sec_imp_deriv"/> may help.
    </p>
  </remark>

  <p>
    We demonstrate the concepts of related rates through examples.
  </p>

  <example xml:id="ex_rr1">
    <title>Understanding related rates</title>
    <statement>
      <p>
        The radius of a circle is growing at a rate of
        <quantity>
          <mag>5</mag><unit base="inch"/><per base="hour"/>
        </quantity>.
        At what rate is the circumference growing?
      </p>
    </statement>
    <solution>
      <p>
        The circumference and radius of a circle are related by <m>C = 2\pi r</m>.
        We are given information about how the length of <m>r</m> changes with respect to time;
        that is, we are told <m>\lz{r}{t}</m> is
        <quantity>
          <mag>5</mag><unit base="inch"/><per base="hour"/>
        </quantity>.
        We want to know how the length of <m>C</m> changes with respect to time,
        <ie/>, we want to know <m>\lz{C}{t}</m>.
      </p>

      <p>
        Implicitly differentiate both sides of
        <m>C = 2\pi r</m> with respect to <m>t</m>:
        <md>
          <mrow>C \amp = 2\pi r</mrow>
          <mrow>\lzoo{t}{C} \amp = \lzoo{t}{2\pi r}</mrow>
          <mrow>\lz{C}{t} \amp =2\pi \lz{r}{t}</mrow>
        </md>.
      </p>

      <p>
        As we know <m>\lz{r}{t}</m> is
        <quantity>
          <mag>5</mag><unit base="inch"/><per base="hour"/>
        </quantity>, we know
        <me>
          \lz{C}{t} = 2\pi 5 = 10\pi \approx 31.4\text{ in/hr }
        </me>.
      </p>

      <p xml:id="vidint_deriv_apps_rel_rates_circ_area" component="video">
        This problem was relatively straightforward,
        owing to the linear relationship between radius and circumference.
        The video in <xref ref="vid_deriv_apps_rel_rates_circ_area"/> explores what would happen if we had instead been asked for the rate at which the area is changing.
      </p>

      <figure xml:id="vid_deriv_apps_rel_rates_circ_area" component="video" vshift="0">
        <caption>Trying to find the rate at which area is changing for the circle in <xref ref="ex_rr1"/></caption>
        <video width="98%" youtube="RDPxSmxqUBs" label="vid_deriv_apps_rel_rates_circ_area"/>
      </figure>

    </solution>
    <solution component="video" vshift="6">
      <title>Video solution</title>
      <video width="98%" youtube="Qg3GStrQ8pY" label="vid_deriv_apps_rel_rates_circumference" component="video"/>
    </solution>
  </example>

  <p>
    In related rates problems,
    we will be presented with an application problem that involves two or more variables and one or more rate.
    It is the job of the reader to construct the appropriate model that can be used to answer the posed question.
    <xref ref="idea_relatedrates"/>
    outlines the basic steps for solving a related rates problem.
  </p>

  <insight xml:id="idea_relatedrates">
    <title>Related Rates</title>
    <idx><h>Related Rates</h></idx>

    <p>
      <ol>
        <li>
          <p>
            Read the problem carefully and identify the quantities that are
            changing with time.
            (There may be many quantities that change with time,
            try to identify which variables are important to your goal and only
            focus on these quantities.)
          </p>
        </li>

        <li>
          <p>
            Draw a diagram
            (if applicable)
            and assign mathematical variables to each quantity that is changing
            with time.
            (If you are given a particular value of a quantity that is also
            changing with time, do not include these values on your diagram.
            We will call these <q>instantaneous values</q> of the variable.)
          </p>
        </li>

        <li xml:id="li_rrmodel">

          <p>
            Relate the important variables using a mathematical model.
            (Typical models are known formulas for area,
            perimeter, the Pythagorean Theorem or Trigonometric Ratios.)
            It may be necessary to use more than one technique
            (such as similar triangles)
            to reduce your model down to one that only involves the variables
            of interest.
          </p>
        </li>

        <li>
          <p>
            Implicitly differentiate both sides of the equation found in
            <xref ref="li_rrmodel" text="local">Step</xref> with respect to <m>t</m>.
          </p>
        </li>

        <li>
          <p>
            Substitute in the known values of rates and known instantaneous
            values of the variables.
          </p>
        </li>

        <li>
          <p>
            Solve for the unknown rate.
          </p>
        </li>

        <li>
          <p>
            Write a full sentence conclusion.
          </p>
        </li>
      </ol>
    </p>
  </insight>

  <p>
    Consider another, similar example.
  </p>

  <example xml:id="ex_rr2">
    <title>Finding related rates</title>
    <statement>
      <p>
        Water streams out of a faucet at a rate of
        <quantity>
          <mag>2</mag><unit base="inch" exp="3"/><per base="second"/>
        </quantity>
        onto a flat surface at a constant rate,
        forming a circular puddle that is
        <quantity>
          <mag>1/8</mag><unit base="inch"/>
        </quantity>
        deep.
      </p>

      <p>
        <ol>
          <li xml:id="ex_rr2a">

            <p>
              At what rate is the area of the puddle growing?
            </p>
          </li>

          <li xml:id="ex_rr2b">

            <p>
              At what rate is the radius of the circle growing?
            </p>
          </li>
        </ol>
      </p>
    </statement>
    <solution>
      <p>
        <ol>
          <li>
            <p>
              We can answer this question two ways:
              using <q>common sense</q> or related rates.
              The common sense method states that the volume of the puddle is
              growing by
              <quantity>
                <mag>2</mag><unit base="inch" exp="3"/><per base="second"/>
              </quantity>, where
              <me>
                \text{volume of puddle}=\text{area of circle}\times\text{depth}
              </me>.
              Since the depth is constant at
              <quantity>
                <mag>1/8</mag><unit base="inch"/>
              </quantity>, the area must be growing by
              <quantity>
                <mag>16</mag><unit base="inch" exp="2"/><per base="second"/>
              </quantity>
              since <m>16\cdot \frac{1}{8}=2</m>.
              This approach reveals the underlying related rates principle.
            </p>

            <p>
              Now let's solve the problem using
              <xref ref="idea_relatedrates"/>.
              Based on the problem description,
              the quantities that change with time are the volume of water
              (the volume of the puddle),
              the area of the circular puddle and the radius of the circle.
              We don't need a diagram for this problem.
              The important variables for this part of the problem are the
              volume and area.
            </p>

            <p>
              Let <m>V</m> and <m>A</m> represent the Volume and Area of the puddle.
              We know <m>V= A\times \frac{1}{8}</m>.
              Take the derivative of both sides with respect to <m>t</m>,
              employing implicit differentiation.
              <md>
                <mrow>V \amp = \frac{1}{8}A</mrow>
                <mrow>\lzoo{t}{V}\amp = \lzoo{t}{\frac{1}{8}A}</mrow>
                <mrow>\lz{V}{t} \amp = \frac{1}{8}\lz{A}{t}</mrow>
              </md>
              We know the change in volume, <m>\lz{V}{t} = 2</m>,
              so we substitute this value into our related rates equation:
              <m>2 = \frac{1}{8}\lz{A}{t}</m>,
              and hence <m>\lz{A}{t} = 16</m>.
              Thus the area is growing by
              <quantity>
                <mag>16</mag><unit base="inch" exp="2"/><per base="second"/>
              </quantity>.
            </p>
          </li>

          <li>
            <p>
              We already identified the quantities that are changing in
              <xref ref="ex_rr2a" text="local">Part</xref>.
              The variables of interest in this problem are the radius and the volume.
              We need an equation that relates the volume of the circle to the radius.
              Since the puddle is a right circular cylinder,
              we will use a known volume formula,
              <m>V=\pi r^2 h</m> where <m>V</m> is the volume of the puddle (in
              <quantity>
                <unit base="inch" exp="3"/>
              </quantity>, <m>r</m> is the radius
              (in inches)
              and <m>h</m> is the height (<ie/> depth) of the puddle in inches.
              (Notice that this formula is equivalent to
              <m>V=\text{area} \times \text{depth}</m>.)
              We know that the height (depth) is a constant <m>1/8</m> inch.
              Since this quantity does not change in the problem,
              we can safely substitute this value now.
            </p>

            <p>
              Implicitly derive both sides of
              <m>V=\pi r^2 \frac{1}{8}</m> with respect to <m>t</m>:
              <md>
                <mrow>V \amp = \frac{1}{8} \pi r^2</mrow>
                <mrow>\frac{d}{dt}\big(V\big) \amp = \frac{d}{dt}\left(\frac{1}{8}\pi r^2\right)</mrow>
                <mrow>\lz{V}{t} \amp = \frac{1}{8} 2\pi r\lz{r}{t}</mrow>
                <mrow>\lz{V}{t} \amp = \frac{1}{4} \pi r\lz{r}{t}</mrow>
              </md>
              We know that  <m>\lz{V}{t}</m> is
              <quantity>
                <mag>2</mag><unit base="inch" exp="3"/><per base="second"/>
              </quantity>.
              So we have:
              <me>
                2 = \frac14 \pi r\lz{r}{t}
              </me>
              Solving for <m>\lz{r}{t}</m>, we have
              <me>
                \lz{r}{t} = \frac{8}{\pi r}
              </me>.
              Note how our answer is not a number,
              but rather a function of <m>r</m>.
              In other words,
              <em>the rate at which the radius is growing depends on how big
                the circle already is.</em>
              If the circle is very large, adding
              <quantity>
                <mag>2</mag><unit base="inch" exp="3"/><per base="second"/>
              </quantity>
              of water will not make the circle much bigger at all.
              If the circle is dime-sized,
              adding the same amount of water will make a radical change in the
              radius of the circle.
            </p>

            <p>
              In some ways, our problem was (intentionally) ill-posed.
              We need to specify a current (instantaneous) value of the radius
              in order to know a rate of change.
              When the puddle has a radius of
              <quantity>
                <mag>10</mag><unit base="inch"/>
              </quantity>, the radius is growing at a rate of
              <me>
                \lz{r}{t} = \frac{8}{10\pi} = \frac{4}{5\pi} \approx 0.25\text{ in/s }
              </me>.
            </p>
          </li>
        </ol>
      </p>
    </solution>
    <solution component="video" vshift="3">
      <title>Video solution</title>
      <video width="98%" youtube="8ctKxMoFWkU" label="vid_deriv_apps_rel_rates_water_flow" component="video"/>
    </solution>
  </example>

  <example xml:id="ex_rr3">
    <title>Studying related rates</title>
    <statement>
      <p>
        Radar guns measure the rate of distance change between the gun and the
        object it is measuring.
        For instance, a reading of <q><quantity>
          <mag>55</mag><unit base="mileperhour"/>
        </quantity></q> means the object is moving away from the gun at a rate
        of <m>55</m> miles per hour,
        whereas a measurement of <q><quantity>
          <mag>-25</mag><unit base="mileperhour"/>
        </quantity></q> would mean that the object is approaching the gun at a
        rate of <m>25</m> miles per hour.
      </p>

      <p>
        If the radar gun is moving (say,
        attached to a police car) then radar readouts are only immediately
        understandable if the gun and the object are moving along the same line.
        If a police officer is traveling
        <quantity>
          <mag>60</mag><unit base="mileperhour"/>
        </quantity>
        and gets a readout of
        <quantity>
          <mag>15</mag><unit base="mileperhour"/>
        </quantity>, he knows that the car ahead of him is moving away at a rate
        of <m>15</m> miles an hour,
        meaning the car is traveling
        <quantity>
          <mag>75</mag><unit base="mileperhour"/>
        </quantity>. (This straight-line principle is one reason officers park
        on the side of the highway and try to shoot straight back down the road.
        It gives the most accurate reading.)
      </p>

      <p>
        Suppose an officer is driving due north at
        <quantity>
          <mag>30</mag><unit base="mileperhour"/>
        </quantity>
        and sees a car moving due east,
        as shown in <xref ref="fig_rr3"/>.
        Using his radar gun, he measures a reading of
        <quantity>
          <mag>20</mag><unit base="mileperhour"/>
        </quantity>.
        By using landmarks,
        he believes both he and the other car are about <m>1/2</m> mile from the
        intersection of their two roads.
      </p>

      <figure xml:id="fig_rr3" vshift="2">
        <caption>A sketch of a police car (at bottom) attempting to measure the
          speed of a car (at right) in <xref ref="ex_rr3"/></caption>
        <image width="47%">
          <shortdescription>
            A passenger car is shown moving east, while a police car is moving north. Their roads are set to intersect.
          </shortdescription>
          <description>
            <p>
              The passenger car is on an eastward road, while the police car is on a northward road, and these roads are perpendicular to each other. The police car is <m>1/2</m> units south of the intersection point, and the passenger car is <m>1/2</m> units east of the same intersection.
            </p>
            <p>
              A straight line, labeled as <m>C</m>, connects the current positions of both the police car and the passenger car.
            </p>
          </description>

          <latex-image label="img_rr3">

          \begin{tikzpicture}[&gt;=latex]
          \draw(0,0) -- (3,0) node [pos=.5,above] { $B=1/2$} -- (0,-3) node [pos=.4,below] { $C$}-- (0,0) node [pos=.5,rotate=90,shift={(.1,.2)}] { $A=1/2$};

          \draw [thick] (0,-3.5) -- (0,.5) node [above] { $N$};
          \draw [thick] (-.5,0) -- (3.5,0) node [right] { $E$};

          \filldraw [fill=firstcolor,draw=secondcolor] (0,-3) circle (2pt) node [right] { Officer};
          \filldraw [fill=black,draw=black] (3,0) circle (2pt) node [below ] { \quad Car};

          \draw[-&gt;,thick] (-.2,-3.3) -- (-.2,-2.7);
          \draw[-&gt;,thick] (2.7,.2) -- (3.3,.2);

          \end{tikzpicture}

          </latex-image>
        </image>
      </figure>

      <p>
        If the speed limit on the other road is
        <quantity>
          <mag>55</mag><unit base="mileperhour"/>
        </quantity>, is the other driver speeding?
      </p>
    </statement>
    <solution>
      <p>
        The important quantities that are changing are:
        the distance of the officer to the intersection,
        the distance of the car to the intersection,
        and the distance of the officer to the car.
        (There are other quantities that are changing as well such as the
        angles and area of the triangle,
        but these are not important to this problem.)
      </p>

      <p>
        Using the diagram in <xref ref="fig_rr3"/>,
        let's label what we know about the situation.
        As both the police officer and other driver are <m>1/2</m> mile from
        the intersection,
        we have <m>A = 1/2</m>, <m>B = 1/2</m>,
        and through the Pythagorean Theorem,
        <m>C = 1/\sqrt{2}\approx 0.707</m>.
        These values are <q>instantaneous</q>
        values for our variables,
        so we won't use them until the <em>end</em> of the problem.
        Instead, we will use the variables <m>A</m>, <m>B</m>,
        and <m>C</m>.
      </p>

      <p>
        We need an equation that relates <m>A</m>, <m>B</m>, and <m>C</m>.
        The Pythagorean Theorem is a good choice:
        <m>A^2+B^2 = C^2</m>.
        Differentiate both sides with respect to <m>t</m>:
        <md>
          <mrow>A^2 + B^2 \amp = C^2</mrow>
          <mrow>\lzoo{t}{A^2+B^2} \amp = \lzoo{t}{C^2}</mrow>
          <mrow>2A\lz{A}{t} + 2B\lz{B}{t} \amp = 2C\lz{C}{t}</mrow>
        </md>
      </p>

      <p>
        We know the police officer is traveling at
        <quantity>
          <mag>30</mag><unit base="mileperhour"/>
        </quantity>; that is, <m>\lz{A}{t} = -30</m>.
        The reason this rate of change is negative is that <m>A</m> is getting
        smaller;
        the distance between the officer and the intersection is shrinking.
        The radar measurement is <m>\lz{C}{t} = 20</m>.
        We want to find <m>\lz{B}{t}</m>.
      </p>

      <p>
        We have values for everything except <m>\lz{B}{t}</m>.
        Solving for this we have:
        <me>
          \lz{B}{t} = \frac{C\lz{C}{t}- A\lz{A}{t}}{B}
        </me>.
        Now we substitue in our known rates and instantaneous values of our
        variables:
        <md>
          <mrow>\lz{B}{t} \amp \approx \frac{0.707(20)- 0.5(-30)}{(0.5)}</mrow>
          <mrow>\amp= 58.28 \text{ mph }</mrow>
        </md>.
      </p>

      <p>
        The other driver appears to be speeding slightly.
      </p>
    </solution>
    <solution component="video" vshift="-1">
      <title>Video solution</title>
      <video width="98%" youtube="8fFao8XCQC0" label="vid_deriv_apps_rel_rates_speed_radar" component="video"/>
    </solution>
  </example>

  <aside vshift="0">
    <title>Practicality</title>
    <p>
      <xref ref="ex_rr3"/>
      is both interesting and impractical.
      It highlights the difficulty in using radar in a nonlinear fashion,
      and explains why <q>in real life</q>
      the police officer would follow the other driver to determine their speed,
      and not pull out pencil and paper.
    </p>

    <p>
      The principles here are important, though.
      Many automated vehicles make judgments about other moving objects based on
      perceived distances,
      radar-like measurements and the concepts of related rates.
    </p>
  </aside>

  <example xml:id="ex_rr4">
    <title>Studying related rates</title>
    <statement>
      <p>
        A camera is placed on a tripod
        <quantity>
          <mag>10</mag><unit base="foot"/>
        </quantity>
        from the side of a road.
        The camera is to turn to track a car that is to drive by at
        <quantity>
          <mag>100</mag><unit base="mileperhour"/>
        </quantity>
        for a promotional video.
        The video's planners want to know what kind of motor the tripod should
        be equipped with in order to properly track the car as it passes by.
        <xref ref="fig_rr4"/> shows the proposed setup.
      </p>

      <figure xml:id="fig_rr4" vshift="-4">
        <caption>Tracking a speeding car (at left) with a rotating camera</caption>
        <image width="47%">
          <shortdescription>
            A tripod with a rotating camera is shown 10ft from the side of the road, tracking a speeding car.
          </shortdescription>
          <description>
              <p>
                A car is shown to the left of the image, driving at a 100 mph east,
                with a tripod placed <quantity><mag>10</mag><unit base="foot"/></quantity> from the side of the road, set to track the car.
              </p>
              <p>
                A right triangle is drawn, with the hypotenuse connecting the car to the tripod, and the other two sides parallel to the road and perpendicular to the road.
                The side parallel to the road has length <m>x</m>, and the angle between the hypotenuse and the side perpendicular to the road is labeled as <m>\theta</m>. The side perpendicular to the road has a length of <quantity><mag>10</mag><unit base="foot"/></quantity>.
              </p>
          </description>
          <latex-image label="img_rr4">

          \begin{tikzpicture}[&gt;=latex]

          \draw (-3,0) -- (0,0) -- (0,-2) node [shift={(-5pt,10pt)}] {\small $\theta$} node [right,pos=.5] { 10ft} -- cycle;
          \draw [&lt;-&gt;, thick] (-3.5,0) -- node [below,pos=.5] { $x$} (.5,0);
          \draw [fill=firstcolor,draw=secondcolor] (-3,0) circle (2pt);
          \draw [fill=black] (0,-2) circle (2pt);
          \draw [-&gt;] (-3,.2) -- (-2,.2) node [above,pos=.5] { 100mph};

          \end{tikzpicture}

          </latex-image>
        </image>
      </figure>

      <p>
        How fast must the camera be able to turn to track the car?
      </p>
    </statement>
    <solution>
      <p>
        The quantities that changing are <m>x</m> and <m>\theta</m> as drawn on
        <xref ref="fig_rr4"/>. (The hypotenuse of the triangle is
        also changing, but this isn't important to the problem).
        We seek information about how fast the camera is to <em>turn</em>;
        therefore, we need an equation that will relate an angle <m>\theta</m>
        to the position of the camera and the speed and position of the car.
      </p>

      <p>
        <xref ref="fig_rr4"/>
        suggests we use a trigonometric equation.
        Letting <m>x</m> represent the distance the car is from the point on the
        road directly in front of the camera, we have
        <men xml:id="eq_rr4">
          \tan(\theta) = \frac{x}{10}
        </men>.
      </p>

      <p>
        Now take the derivative of both sides of <xref ref="eq_rr4">Equation</xref>
        using implicit differentiation:
        <md>
          <mrow>\tan(\theta) \amp = \frac{x}{10}</mrow>
          <mrow>\lzoo{t}{\tan(\theta)} \amp = \lzoo{t}{\frac{x}{10}}</mrow>
          <mrow>\sec^2(\theta)\lz{\theta}{t} \amp = \frac{1}{10}\lz{x}{t}</mrow>
        </md>
        Now we solve for <m>\lz{\theta}{t}</m>:
        <men xml:id="eq_rr4b">
          \lz{\theta}{t} = \frac{\cos^2(\theta)}{10}\lz{x}{t}
        </men>
      </p>

      <p>
        As the car is moving at
        <quantity>
          <mag>100</mag><unit base="mileperhour"/>
        </quantity>, we have that <m>\lz{x}{t}</m> is
        <quantity>
          <mag>-100</mag><unit base="mileperhour"/>
        </quantity>
        (as in the last example,
        since <m>x</m> is getting smaller as the car travels,
        <m>\lz{x}{t}</m> is negative).
        We need to convert the measurements so they use the same units
        (we chose
        <quantity>
          <unit base="foot"/>
        </quantity>);
        rewrite
        <quantity>
          <mag>-100</mag><unit base="mileperhour"/>
        </quantity>
        in terms of
        <quantity>
          <unit base="foot"/><per base="second"/>
        </quantity>:
        <md>
          <mrow>\lz{x}{t} \amp = -100\frac{\text{mi} }{\text{ hr } }</mrow>
          <mrow>\amp = -100\frac{\text{mi} }{\text{ hr } }\cdot5280\frac{\text{ ft } }{\text{mi} }\cdot\frac{1}{3600}\frac{\text{ hr } }{\text{s} }</mrow>
          <mrow>\amp =-146.\overline{6}\text{ ft/s }</mrow>
        </md>.
      </p>

      <p>
        We want to know the fastest the camera has to turn.
        Common sense tells us this is when the car is directly in front of the
        camera (<ie/>, when <m>\theta = 0</m>).
        Our mathematics bears this out.
        In <xref ref="eq_rr4b" text="global">Equation</xref>
        we see this is when <m>\cos^2(\theta)</m> is largest;
        this is when <m>\cos(\theta) = 1</m>,
        or when <m>\theta = 0</m>.
        We also know that we should get an answer that is in
        <quantity>
          <unit base="radian"/><per base="second"/>
        </quantity>.
        Since <m>\cos(\theta)</m> is a <q>dimensionless</q> measure,
        it won't contribute to the units.
        However, radians are also dimensionless.
        This means we can write
        (or erase)
        the word <q>radian</q> without any unit consequences. (The same is not
        true of degrees <mdash/> always convert degress to radians).
      </p>

      <p>
        With <m>\lz{x}{t}</m> approximately
        <quantity>
          <mag>-146.7</mag><unit base="foot"/><per base="second"/>
        </quantity>, we have
        <md>
          <mrow>\lz{\theta}{t} \amp \approx -\frac{1}{10\text{ ft } }146.67\text{ ft/s }</mrow>
          <mrow>\amp = -14.667\text{ radians/s }</mrow>
        </md>
      </p>

      <p>
        We find that <m>\lz{\theta}{t}</m> is negative;
        this matches our diagram in <xref ref="fig_rr4"/>
        for <m>\theta</m> is getting smaller as the car approaches the camera.
      </p>

      <p>
        What is the practical meaning of
        <quantity>
          <mag>-14.667</mag><unit base="radian"/><per base="second"/>
        </quantity>?
        Recall that <m>1</m> circular revolution goes through <m>2\pi</m>
        radians, thus
        <quantity>
          <mag>14.667</mag><unit base="radian"/><per base="second"/>
        </quantity>
        means <m>14.667/(2\pi)\approx 2.33</m> revolutions per second.
        The negative sign indicates the camera is rotating in a clockwise fashion.
      </p>
    </solution>
    <solution component="video" vshift="0">
      <title>Video solution</title>
      <video width="98%" youtube="B85LlGHgVQo" label="vid_deriv_apps_rel_rates_turning_camera" component="video"/>
    </solution>
  </example>

  <p>
    We introduced the derivative as a function that gives the slopes of tangent
    lines of functions.
    This chapter emphasizes using the derivative in other ways.
    Newton's Method uses the derivative to approximate roots of functions;
    this section stresses the <q>rate of change</q>
    aspect of the derivative to find a relationship between the rates of change
    of two related quantities.
  </p>

  <p>
    In the next section we use Extreme Value concepts to
    <em>optimize</em> quantities.
  </p>
<!--ToDo: Units in exercises need to be done better. Can we use quantity? If not, fix spacing.-->
  <exercises>
    <subexercises xml:id="TaC-related-rates">
      <title>Terms and Concepts</title>
      <!--Exercise 1: T/F-->
      <exercise label="TaC-related-rates-1">
        <webwork xml:id="webwork-TaC-related-rates-1">
          <pg-code>
            $true=PopUp(['?','True','False'],1);
            $false=PopUp(['?','True','False'],2);
          </pg-code>
          <statement>
            <p>
              <var name="$true" form="popup"/>
              Implicit differentiation is often used when solving
              <q>related rates</q> type problems.
            </p>
          </statement>
        </webwork>
      </exercise>
      <!--Exercise 2: Bizarre T/F-->
      <exercise label="TaC-related-rates-2">
        <webwork xml:id="webwork-TaC-related-rates-2">
          <pg-code>
            $true=PopUp(['?','True','False'],1);
            $false=PopUp(['?','True','False'],2);
          </pg-code>
          <statement>
            <p>
              <var name="$false" form="popup"/>
              A study of related rates is part of the standard police officer training.
            </p>
          </statement>
        </webwork>
      </exercise>
    </subexercises>

    <subexercises>
      <title>Problems</title>
      <!--Exercise 3: Puddle of depth 10 cm growing-->
      <exercise label="ex-related-rates-puddle">
        <webwork xml:id="webwork-ex-related-rates-puddle">
          <pg-code>
            ($rate,$depth) = (4..10)[NchooseK(7,2)];
            $a = random(1,4,1);
            if($envir{problemSeed}==1){$rate=5; $depth=10; $a=1;};
            Context()-&gt;flags-&gt;set(reduceConstants=&gt;0);
            $rateU = NumberWithUnits("$rate cm^3/s");
            $depthU = NumberWithUnits("$depth mm");
            @r=($a,$a*10,$a*100);
            @rU = map{NumberWithUnits("$_ cm")}(@r);
            Context("Fraction");
            @f = map{Fraction(5*$rate,2*$_*$depth)}(@r);
            @num = map{($_-&gt;value)[0]}(@f);
            @den = map{($_-&gt;value)[1]}(@f);
            @sU = map{NumberWithUnits("$num[$_]/($den[$_] pi) cm/s")}(0,1,2);
          </pg-code>
          <introduction>
            <p>
              Water flows onto a flat surface at a rate of
              <m><var name="$rateU"/></m>
              forming a circular puddle <m><var name="$depthU"/></m> deep.
              How fast is the radius growing when the radius is:
            </p>
          </introduction>

          <task label="ex-related-rates-puddle-a">
            <statement>
              <p>
                <m><var name="$rU[0]"/></m>
              </p>
              <p>
                <var name="$sU[0]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-puddle-b">
            <statement>
              <p>
                <m><var name="$rU[1]"/></m>
              </p>
              <p>
                <var name="$sU[1]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-puddle-c">
            <statement>
              <p>
                <m><var name="$rU[2]"/></m>
              </p>
              <p>
                <var name="$sU[2]" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 4: Spherical balloon radius increasing-->
      <exercise label="ex-related-rates-balloon">
        <webwork xml:id="webwork-ex-related-rates-balloon">
          <pg-code>
            $rate = random(4,12,1);
            $a = random(1,4,1);
            if($envir{problemSeed}==1){$rate=10; $a=1;};
            Context()-&gt;flags-&gt;set(reduceConstants=&gt;0);
            $rateU = NumberWithUnits("$rate cm^3/s");
            @r=($a,$a*10,$a*100);
            @rU = map{NumberWithUnits("$_ cm")}(@r);
            Context("Fraction");
            @f = map{Fraction($rate,4*$_**2)}(@r);
            @num = map{($_-&gt;value)[0]}(@f);
            @den = map{($_-&gt;value)[1]}(@f);
            @sU = map{NumberWithUnits("$num[$_]/($den[$_] pi) cm/s")}(0,1,2);
          </pg-code>
          <introduction>
            <p>
              A spherical balloon is inflated with air flowing at a rate of
              <m><var name="$rateU"/></m>.
              How fast is the radius of the balloon increasing when the radius is:
            </p>
          </introduction>

          <task label="ex-related-rates-balloon-a">
            <statement>
              <p>
                <m><var name="$rU[0]"/></m>
              </p>
              <p>
                <var name="$sU[0]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-balloon-b">
            <statement>
              <p>
                <m><var name="$rU[1]"/></m>
              </p>
              <p>
                <var name="$sU[1]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-balloon-c">
            <statement>
              <p>
                <m><var name="$rU[2]"/></m>
              </p>
              <p>
                <var name="$sU[2]" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 5: Refer to Example 100-->
      <exercise label="ex-related-rates-radar-1">
        <webwork xml:id="webwork-ex-related-rates-radar-1">
          <pg-code>
            Context("Fraction");
            $f = list_random(Fraction(1,2),Fraction(3,4),Fraction(2,3),Fraction(3,5),Fraction(4,5));
            $speed = random(45,55,5);
            $rate = random(70,90,5);
            if($envir{problemSeed}==1){$f=Fraction(1,2);$speed=50;$rate=80;};
            Context("Numeric");
            Context()-&gt;flags-&gt;set(reduceConstants=&gt;0);
            $a = Compute("$rate*sqrt(2)-$speed");
            $a = NumberWithUnits("$a mi/h");
          </pg-code>
          <statement>
            <p>
              Consider the traffic situation introduced in <xref ref="ex_rr3"/>.
              How fast is the <q>other car</q> traveling if the officer and the other car are each
              <m><var name="$f"/></m> mile from the intersection, the other car is traveling <em>due west</em>,
              the officer is traveling north at <m><var name="$speed"/>\,\text{mph}</m>,
              and the radar reading is <m>-<var name="$rate"/>\,\text{mph}</m>?
            </p>
            <p>
              <var name="$a" width="20"/>
            </p>
          </statement>
        </webwork>
      </exercise>
      <!--Exercise 6: Also refer to Example 100-->
      <exercise label="ex-related-rates-radar-2">
        <webwork xml:id="webwork-ex-related-rates-radar-2">
          <pg-code>
            Context("Fraction");
            $f = list_random(Fraction(1,2),Fraction(3,4),Fraction(2,3),Fraction(3,5),Fraction(4,5));
            $speed = random(45,55,5);
            $rate = random(70,90,5);
            if($envir{problemSeed}==1){$f=Fraction(1,2);$speed=50;$rate=80;};
            Context("Numeric");
            Context()-&gt;flags-&gt;set(reduceConstants=&gt;0);
            $f2 = 1+$f**2;
            $f3 = $speed*$f;
            $a = Compute("$rate*sqrt($f2)-$f3");
            $a = NumberWithUnits("$a mi/h");
            $f4 = $rate/$f;
            $f5 = $speed/$f;
            $b = Compute("$f4 sqrt($f2)-$f5");
            $b = NumberWithUnits("$b mi/h");
          </pg-code>
          <introduction>
            <p>
              Consider the traffic situation introduced in <xref ref="ex_rr3"/>.
              Calculate how fast the <q>other car</q> is traveling in each of the following situations.
            </p>
          </introduction>

          <task label="ex-related-rates-radar-2a">
            <statement>
              <p>
                The officer is traveling due north at <m><var name="$speed"/>\,\text{mph}</m>
                and is <m><var name="$f"/></m> mile from the intersection,
                while the other car is <m>1</m> mile from the intersection
                traveling west and the radar reading is <m>-<var name="$rate"/>\,\text{mph}</m>?
              </p>
              <p>
                <var name="$a" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-radar-2b">
            <statement>
              <p>
                The officer is traveling due north at <m><var name="$speed"/>\,\text{mph}</m>
                and is <m>1</m> mile from the intersection,
                while the other car is <m><var name="$f"/></m> mile from the
                intersection traveling west and the radar reading is <m>-<var name="$rate"/>\,\text{mph}</m>?
              </p>
              <p>
                <var name="$b" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 7: Anti-aircraft gun-->
      <exercise xml:id="exer_04_02_ex_07" label="ex-related-rates-aircraft-1">
        <webwork xml:id="webwork-ex-related-rates-aircraft-1">
          <pg-code>
            Context()-&gt;flags-&gt;set(reduceConstants=&gt;0);
            $spd = random(300,800,10);
            $elev = random(5000,15000,100);
            $a = Compute("($elev*$spd*5280)/(5280^2+$elev^2)");
            $aU = NumberWithUnits("$a rad/hr");
            $b = Compute("($elev*$spd*5280)/(1056^2+$elev^2)");
            $bU = NumberWithUnits("$b rad/hr");
            $c = Compute("$spd*5280/$elev"); <!--Simplify the formula and get this as the limit>-->
            $cU = NumberWithUnits("$c rad/hr");
          </pg-code>
          <introduction>
            <p>
              An F-22 aircraft is flying at <m><var name="$spd"/>\,\text{mph}</m>
              with an elevation of <m><var name="$elev"/>\,\text{ft}</m> on a
              straight-line path that will take it directly over an
              anti-aircraft gun.
            </p>
            <image width="47%">
              <shortdescription>
                An airplane is shown on the right, over horizontal ground with a gun on the ground to the left.
              </shortdescription>
              <description>
                <p>
                  To the left of a horizontal surface, a square marks an anti-aircraft gun.
                  Above the ground, on the right of the image, is an airplane flying to the left.
                  The horizontal distance along the ground from the gun to the airplane position is marked with the variable <m>x</m>.
                  The elevation of the plane is shown as <quantity><mag>6600</mag><unit base="foot"/></quantity>.
                </p>
                <p>
                  There is also a dashed line from the gun to the plane.
                  The angle that this line makes with the ground is marked with the variable <m>\theta</m>.
                </p>
              </description>
              <latex-image label="img_04_02_ex_07">
                \begin{tikzpicture}[&gt;=latex]
                  \begin{scope}
                    \clip (0,0) rectangle (120pt,50pt);
                    \draw [inner color=firstcolor,draw = white] (-10,-25pt) rectangle (180pt,70pt);
                  \end{scope}
                  \draw [top color=treestump, bottom color=white,draw=white] (0,0) rectangle (120pt,-15pt);
                  \draw (0,0) -- (120pt,0);
                  \draw [dashed] (12.5pt,0pt) node [xshift=22pt,yshift=4pt] { \(\theta\)} -- (105pt,35pt);
                  \draw [ultra thick] (12.5pt,0) -- (18pt,4pt);
                  \filldraw [fill=white] (10pt,-2.5pt) rectangle (15pt,2.5pt);
                  \draw [&lt;-&gt;] (15pt,-10pt) -- (110pt,-10pt) node [below,pos=.5] { \(x\)};
                  \draw [&lt;-&gt;] (120pt,0pt) -- (120pt,35pt) node [right, pos=.5] { $elev ft};
                  \begin{scope}[shift={(105pt,35pt)}]
                    \draw [fill=black] (0,0) rectangle (10pt,2pt);
                    \draw [very thick] (3pt,1pt) -- (6pt,-1.5pt) -- (5pt,0pt);
                    \draw [very thick] (9pt,2pt) -- (9pt,4pt) -- (7pt,2pt);
                  \end{scope}
                \end{tikzpicture}
              </latex-image>
            </image>
            <p>
              How fast (in radians per second) must the gun be able to turn to accurately track the
              aircraft when the plane is:
            </p>
          </introduction>

          <task label="ex-related-rates-aircraft-1a">
            <statement>
              <p>
                <m>1</m> mile away?
              </p>
              <p>
                <var name="$aU" width="10"/>
              </p>
              <instruction>
                Use <c>rad/s</c> for radians per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-aircraft-1b">
            <statement>
              <p>
                <m>1/5</m> mile away?
              </p>
              <p>
                <var name="$bU" width="10"/>
              </p>
              <instruction>
                Use <c>rad/s</c> for radians per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-aircraft-1c">
            <statement>
              <p>
                Directly overhead?
              </p>
              <p>
                <var name="$cU" width="10"/>
              </p>
              <instruction>
                Use <c>rad/s</c> for radians per second.
              </instruction>
            </statement>
          </task>
          <hint>
            <p>
              There are <m>5280</m> feet in one mile.
            </p>
          </hint>
        </webwork>
      </exercise>
      <!--Exercise 8: Anti-aircraft gun 2-->
      <exercise label="ex-related-rates-aircraft-2">
        <webwork xml:id="webwork-ex-related-rates-aircraft-2">
          <pg-code>
            Context()-&gt;flags-&gt;set(reduceConstants=&gt;0);
            $speed = random(400,600,50);
            $speedU = NumberWithUnits("$speed mi/h");
            @a = (random(1000,2000,100), random(100,500,50), 0);
            if($envir{problemSeed}==1){$a[0]=1000,$a[1]=100;};
            @aU = map{NumberWithUnits("$_ ft")}(@a);
            @b = map{100*$speed*5280/3600/(100**2 + $_**2)}(@a);
            @bU = map{NumberWithUnits("$_ rad/s")}(@b);
          </pg-code>
          <introduction>
            <p>
              An F-22 aircraft is flying at
              <var name="$speedU"/>
              with an elevation of <m>100\,\text{ft}</m>
              on a straight-line path that will take it directly over an
              anti-aircraft gun as in <xref ref="exer_04_02_ex_07"/>
              (note the lower elevation here).
            </p>
            <p>
              How fast must the gun be able to turn to accurately track the
              aircraft when the plane is:
            </p>
          </introduction>

          <task label="ex-related-rates-aircraft-2a">
            <statement>
              <p>
                <m><var name="$aU[0]"/></m> away?
              </p>
              <instruction>
                Use <c>rad/s</c> for radians per second.
              </instruction>
              <p>
                <var name="$bU[0]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-aircraft-2b">
            <statement>
              <p>
                <m><var name="$aU[1]"/></m> away?
              </p>
              <instruction>
                Use <c>rad/s</c> for radians per second.
              </instruction>
              <p>
                <var name="$bU[1]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-aircraft-2c">
            <statement>
              <p>
                Directly overhead?
              </p>
              <instruction>
                Use <c>rad/s</c> for radians per second.
              </instruction>
              <p>
                <var name="$bU[2]" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 9: Ladder sliding down a house-->
      <!-- not currently randomized -->
      <exercise label="ex-related-rates-ladder">
        <webwork xml:id="webwork-ex-related-rates-ladder">
          <pg-code>
            $f = Compute("x/sqrt(24^2-x^2)");
            $a = Compute($f-&gt;eval(x=&gt;1));
            $a = NumberWithUnits("$a ft/s");
            $b = Compute($f-&gt;eval(x=&gt;10));
            $b = NumberWithUnits("$b ft/s");
            $c = Compute($f-&gt;eval(x=&gt;23));
            $c = NumberWithUnits("$c ft/s");
            $d = Compute("inf");
          </pg-code>
          <introduction>
            <p>
              A <quantity><mag>24</mag><unit base="foot"/></quantity> ladder
              is leaning against a house while the base is pulled away at a
              constant rate of
              <quantity>
                <mag>1</mag><unit base="foot"/><per base="second"/>
              </quantity>.
            </p>
            <image width="47%">
              <shortdescription>
                A ladder is shown leaning against a house, with its base being pulled away.
              </shortdescription>
              <description>
                <p>
                  A <quantity><mag>24</mag><unit base="foot"/></quantity> ladder is positioned against the side of a house. The base of the ladder is being pulled away from the house at a rate of 1 ft/s. The exact distance of the ladder's base from the house varies based on different scenarios provided.
                </p>
              </description>
              <latex-image label="img_04_02_ex_09">
                \begin{tikzpicture}[&gt;=latex]
                  \draw [top color=treestump, bottom color=treestump!50!white,draw=black] (0,0) rectangle (20pt,30pt);
                  \draw [fill=black] (0,30pt) -- (10pt,38pt) -- (20pt,30pt) -- cycle;
                  \draw [fill=white] (7pt,15pt) rectangle (13pt,25pt);
                  \draw (10pt,15pt) -- (10pt,25pt) (7pt,20pt) -- (13pt,20pt);
                  \draw [thick] (20pt,25pt) -- node [pos=.5,rotate=-67,yshift=5pt] { 24 ft} (30pt,0);
                  \draw [thick] (0,0) -- (35pt,0);
                  \draw [-&gt;,&gt;=latex] (34pt,2pt) -- node [above right,pos=.5] { 1 ft/s} (50pt,2pt);
                \end{tikzpicture}
              </latex-image>
            </image>
            <p>
              At what rate is the top of the ladder sliding down the side of
              the house when the base is:
            </p>
          </introduction>

          <task label="ex-related-rates-ladder-a">
            <statement>
              <p>
                <m>1</m> foot from the house?
              </p>
              <p>
                <var name="$a" width="20"/>
              </p>
              <instruction>
                Use <c>ft/s</c> for feet per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-ladder-b">
            <statement>
              <p>
                <m>10</m> feet from the house?
              </p>
              <p>
                <var name="$b" width="20"/>
              </p>
              <instruction>
                Use <c>ft/s</c> for feet per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-ladder-c">
            <statement>
              <p>
                <m>23</m> feet from the house?
              </p>

              <p>
                <var name="$c" width="20"/>
              </p>
              <instruction>
                Use <c>ft/s</c> for feet per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-ladder-d">
            <statement>
              <p>
                <m>24</m> feet from the house?
              </p>
              <p>
                <var name="$d" width="20"/>
              </p>
              <instruction>
                Use <c>ft/s</c> for feet per second.
              </instruction>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 10: Winch that boat in-->
      <!-- not yet randomized -->
      <exercise label="ex-related-rates-boat">
        <webwork xml:id="webwork-ex-related-rates-boat">
          <pg-code>
            $f = Compute("30*sqrt(10^2+x^2)/x");
            $a = Compute($f-&gt;eval(x=&gt;50));
            $a = NumberWithUnits("$a ft/min");
            $b = Compute($f-&gt;eval(x=&gt;15));
            $b = NumberWithUnits("$b ft/min");
            $c = Compute($f-&gt;eval(x=&gt;1));
            $c = NumberWithUnits("$c ft/min");
          </pg-code>
          <introduction>
            <p>
              A boat is being pulled into a dock at a constant rate of
              <quantity>
                <mag>30</mag><unit base="foot"/><per base="minute"/>
              </quantity>
              by a winch located <quantity><mag>10</mag><unit base="foot"/></quantity>
              above the deck of the boat.
            </p>
            <image width="47%">
              <shortdescription>
                A boat is being pulled towards a dock by an overhead winch.
              </shortdescription>
              <description>
                <p>
                A boat is approaching a dock, being pulled by a winch located <quantity><mag>10</mag><unit base="foot"/></quantity> above the deck of the boat. The rope from the winch to the boat forms a hypotenuse, creating a right-angle triangle with the water's surface and the vertical winch post. The boat is being pulled at a constant rate of 30 ft/min towards the dock.
                </p>
              </description>
              <latex-image label="img_04_02_ex_10">
                \begin{tikzpicture}[&gt;=latex]
                  \draw [top color=firstcolor!60!white, bottom color=firstcolor!10!white,draw=firstcolor] (-5pt,5pt) rectangle (100pt,-5pt);
                  \draw [thick,fill=treestump] (-10pt,20pt) rectangle (8pt,22pt);
                  \draw [top color=treestump!30!black, bottom color=treestump!70!white,draw=black] (0,0) rectangle (5pt,30pt);
                  \draw [fill=white] (50pt,0pt) -- (90pt,0pt) -- (90pt, 15pt) -- (45pt,15pt) -- cycle;
                  \draw [fill=black] (65pt,15pt) rectangle (67pt,20pt);
                  \draw [fill=yellowcolfill] (55pt,20pt) -- (80pt,20pt) -- (65pt,40pt) -- cycle;
                  \draw [fill=black] (8pt,35pt) circle (2pt);
                  \draw (45pt,15pt) [dashed] -- (8pt,15pt) -- (8pt,35pt) node [pos=.4,xshift=7pt] { 10ft};
                  \draw [-,thick] (8pt,35pt) -- (45pt,15pt);
                \end{tikzpicture}
              </latex-image>
            </image>
            <p>
              At what rate is the boat approaching the dock when the boat is:
            </p>
          </introduction>

          <task label="ex-related-rates-boat-a">
            <statement>
              <p>
                <m>50</m> feet out?
              </p>
              <p>
                <var name="$a" width="20"/>
              </p>
              <instruction>
                Use <c>ft/min</c> for feet per minute.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-boat-b">
            <statement>
              <p>
                <m>15</m> feet out?
              </p>
              <p>
                <var name="$b" width="20"/>
              </p>
              <instruction>
                Use <c>ft/min</c> for feet per minute.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-boat-c">
            <statement>
              <p>
                <m>1</m> foot from the dock?
              </p>
              <p>
                <var name="$c" width="20"/>
              </p>
              <instruction>
                Use <c>ft/min</c> for feet per minute.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-boat-d">
            <statement>
              <p>
                What happens when the length of rope pulling in the boat is less than 10 feet long?
              </p>

              <p>
                <var form="essay"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 11: Inverted cylindrical cone-->
      <exercise label="ex-related-rates-cone">
        <webwork xml:id="webwork-ex-related-rates-cone">
          <pg-code>
            ($depth,$diameter) = (10..30)[NchooseK(21,2)];
            $rate = random(8,12,1);
            @a=(1,random(8,15,1),random(18,25,1));
            if($envir{problemSeed}==1){$depth=20; $diameter=10; $rate=10; $a[1]=10; $a[2]= 19;};
            $depthU = NumberWithUnits("$depth ft");
            $diameterU = NumberWithUnits("$diameter ft");
            $rateU = NumberWithUnits("$rate ft^3/s");
            @b = map{$rate * 4 / pi * $depth**2 / $diameter**2 / $_**2}(@a);
            @bU = map{NumberWithUnits("$_ ft/s")}(@b);
            $T = pi/12 * $diameter**2 * $depth / $rate;
            $TU = NumberWithUnits("$T s");
          </pg-code>
          <introduction>
            <p>
              An inverted cylindrical cone,
              <m><var name="$depthU"/></m> deep and
              <m><var name="$diameterU"/></m> across
              at the top, is being filled with water at a rate of
              <m><var name="$rateU"/></m>.
              At what rate is the water rising in the tank when the depth of
              the water is:
            </p>
          </introduction>

          <task label="ex-related-rates-cone-a">
            <statement>
              <p>
                <m><var name="$a[0]"/></m> foot?
              </p>
              <p>
                <var name="$bU[0]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-cone-b">
            <statement>
              <p>
                <m><var name="$a[1]"/></m> feet?
              </p>
              <p>
                <var name="$bU[1]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-cone-c">
            <statement>
              <p>
                <m><var name="$a[2]"/></m> feet?
              </p>
              <p>
                <var name="$bU[2]" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-cone-d">
            <statement>
              <p>
                How long will the tank take to fill when starting at empty?
              </p>
              <p>
                <var name="$TU" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 12: Rope, pulley, man standing next to the weight and walking away-->
      <!-- not yet randomized -->
      <exercise xml:id="exer_04_02_ex_12" label="ex-related-rates-pulley-1">
        <webwork xml:id="webwork-ex-related-rates-pulley-1">
          <pg-code>
            $f = Compute("2x/sqrt(x^2+30^2)");
            $a = Compute($f-&gt;eval(x=&gt;10));
            $a = NumberWithUnits("$a ft/s");
            $b = Compute($f-&gt;eval(x=&gt;40));
            $b = NumberWithUnits("$b ft/s");
            $c = Compute("sqrt(60^2-30^2)");
            $c = NumberWithUnits("$c ft");
          </pg-code>
          <introduction>
            <p>
              A rope, attached to a weight,
              goes up through a pulley at the ceiling and back down to a worker.
              The man holds the rope at the same height as the connection
              point between rope and weight.
            </p>
            <image width="47%">
              <shortdescription>
                A worker pulls a rope attached to a weight through a ceiling pulley.
              </shortdescription>
              <description>
                <p>
                  The diagram illustrates a weight connected to a <quantity><mag>60</mag><unit base="foot"/></quantity> long rope, with the other end looped through a pulley affixed to the ceiling, <quantity><mag>30</mag><unit base="foot"/></quantity> above the weight's resting position. Adjacent to the weight, a worker is depicted holding the rope, specifically at its attachment point to the weight. As the worker moves away at 2 ft/s, pulling the rope with him, the weight begins its ascent.
                </p>
              </description>
              <latex-image label="img_04_02_ex_12">
                \begin{tikzpicture}[&gt;=latex,x=1pt,y=1pt]
                  \draw [thick](0,40) -- (55,40);
                  \draw [thick] (0,0) -- (55,0);
                  \draw (2,0) -- (12,0) -- (9,5) -- (5,5)--cycle;
                  \draw (7,5) -- (7,35) -- (33,5);
                  \draw (7,35) -- (7,40);
                  \draw [fill=gray] (7,35) circle (2pt);
                  \draw (35,10) circle (2pt);
                  \draw (35,8) -- (35,4) -- (33,0) (35,4) -- (37,0) (33,6) -- (37,6);
                  \draw (-4,5) -- (-1,5)  (-2.5,5) -- (-2.5,35) node [pos=.5,draw,fill=white,draw=white,rotate=90] { 30 ft}
                  (-4,35) -- (-1,35);
                  \draw [thick,-&gt;](40,5) --(55,5) node[pos=.5,above] { 2 ft/s};
                \end{tikzpicture}
              </latex-image>
            </image>
            <p>
              Suppose the man stands directly next to the weight
              (<ie/>, a total rope length of <m>60</m> feet) and begins to
              walk away at a rate of
              <quantity>
                <mag>2</mag><unit base="foot"/><per base="second"/>
              </quantity>.
              How fast is the weight rising when the man has walked:
            </p>
          </introduction>

          <task label="ex-related-rates-pulley-1a">
            <statement>
              <p>
                <m>10</m> feet?
              </p>
              <p>
                <var name="$a" width="20"/>
              </p>
              <instruction>
                Use <c>ft/s</c> for feet per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-pulley-1b">
            <statement>
              <p>
                <m>40</m> feet?
              </p>
              <p>
                <var name="$b" width="20"/>
              </p>
              <instruction>
                Use <c>ft/s</c> for feet per second.
              </instruction>
            </statement>
          </task>

          <task label="ex-related-rates-pulley-1c">
            <statement>
              <p>
                How far must the man walk to raise the weight all the way to
                the pulley?
              </p>

              <p>
                <var name="$c" width="20"/>
              </p>
              <instruction>
                Use <c>ft</c> for feet.
              </instruction>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 13: Same setup, but starting further away-->
      <exercise label="ex-related-rates-pulley-2">
        <webwork xml:id="webwork-ex-related-rates-pulley-2">
          <pg-code>
            # Height is fixed at 30 ft
            # Need an initial distance that makes a Pythagorean triple with 30
            $b = random(40,72,224);
            $speed = random(2,4,1);
            if($envir{problemSeed}==1){$b=40;$speed=2;};
            $bU = NumberWithUnits("$b ft");
            $speedU = NumberWithUnits("$speed ft/s");
            $c = sqrt(30**2 + $b**2);
            $length = 30 + $c;
            $lengthU = NumberWithUnits("$length ft");
            $newb = $b+10;
            $newc = sqrt(30**2 + $newb**2);
            $newrate = $newb/$newc * $speed;
            $newrateU = NumberWithUnits("$newrate ft/s");
            $newnewb = $b+30;
            $newnewc = sqrt(30**2 + $newnewb**2);
            $newnewrate = $newnewb/$newnewc * $speed;
            $newnewrateU = NumberWithUnits("$newnewrate ft/s");
            $far = sqrt($length**2 - 30**2);
            $farU = NumberWithUnits("$far ft");
          </pg-code>
          <introduction>
            <p>
              Consider the situation described in
              <xref ref="exer_04_02_ex_12"/>.
              Suppose the man starts <m><var name="$bU"/></m> from the weight and begins
              to walk away at a rate of <m><var name="$speedU"/></m>.
            </p>
          </introduction>

          <task label="ex-related-rates-pulley-2a">
            <statement>
              <p>
                How long is the rope?
              </p>
              <p>
                <var name="$lengthU" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-pulley-2b">
            <statement>
              <p>
                How fast is the weight rising after the man has walked
                <m>10</m> feet?
              </p>
              <p>
                <var name="$newrateU" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-pulley-2c">
            <statement>
              <p>
                How fast is the weight rising after the man has walked
                <m>30</m> feet?
              </p>
              <p>
                <var name="$newnewrateU" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-pulley-2d">
            <statement>
              <p>
                How far must the man walk to raise the weight all the way
                to the pulley?
              </p>
              <p>
                <var name="$farU" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 14: Hot air balloon rising while being tracked-->
      <exercise label="ex-related-rates-hot-air">
        <webwork xml:id="webwork-ex-related-rates-hot-air">
          <pg-code>
            $distance = random(80,120,5);
            $height = random(5,6,1);
            $rate = random(3,8,1);
            if($envir{problemSeed}==1){$distance=100;$height=5;};
            $heightU = NumberWithUnits("$height ft");
            $elev = $distance + $height;
            $elevU = NumberWithUnits("$elev ft");
            $speed = 2*$distance*$rate*pi/180;
            $speedU = NumberWithUnits("$speed ft/s");
          </pg-code>
          <introduction>
            <p>
              A hot air balloon lifts off from ground rising vertically.
              From <m><var name="$distance"/></m> feet away, a
              <m><var name="$heightU"/></m> tall woman
              tracks the path of the balloon.
              When her sightline with the balloon makes a
              <m>45^\circ</m> angle with the horizontal, she notes the angle
              is increasing at about <m><var name="$rate"/>^\circ</m> per minute.
            </p>
          </introduction>

          <task label="ex-related-rates-hot-air-a">
            <statement>
              <p>
                What is the elevation of the balloon?
              </p>
              <p>
                <var name="$elevU" width="20"/>
              </p>
            </statement>
          </task>

          <task label="ex-related-rates-hot-air-b">
            <statement>
              <p>
                How fast is it rising?
              </p>
              <p>
                <var name="$speedU" width="20"/>
              </p>
            </statement>
          </task>
        </webwork>
      </exercise>
      <!--Exercise 15: Sand being dumped into a conical pile-->
      <exercise label="ex-related-rates-sand-cone">
        <webwork xml:id="webwork-ex-related-rates-sand-cone">
          <pg-code>
            $rate = random(3,8,1);
            $nd = list_random([2,3],[4,5],[4,7],[5,6],[5,7],[5,8]);
            $height = random(20,40,5);
            if($envir{problemSeed}==1){$rate=5;$nd=[2,3];$height=30;};
            $rateU = NumberWithUnits("$rate ft^3/s");
            Context("Fraction");
            $frac = Fraction($nd-&gt;[0],$nd-&gt;[1]);
            Context("Numeric");
            $speed = 4*$frac**2/pi/$height**2*$rate;
            $speedU = NumberWithUnits("$speed ft/s");
          </pg-code>
          <statement>
            <p>
              A company that produces landscaping materials is dumping sand
              into a conical pile.
              The sand is being poured at a rate of
              <m><var name="$rateU"/></m>.
              The physical properties of the sand,
              in conjunction with gravity,
              ensure that the cone's height is roughly <m><var name="$frac"/></m> the length
              of the diameter of the circular base.
            </p>
            <p>
              How fast is the cone rising when it has a height of <m><var name="$height"/></m> feet?
            </p>
            <p>
              <var name="$speedU" width="20"/>
            </p>
          </statement>
        </webwork>
      </exercise>
    </subexercises>
  </exercises>
</section>
