<?xml version="1.0" encoding="UTF-8" ?>

<section xml:id="sec_cylindrical_spherical">
  <title>Triple Integration with Cylindrical and Spherical Coordinates</title>
  <introduction>
    <p>
      Just as polar coordinates gave us a new way of describing curves in the plane,
      in this section we will see how
      <em>cylindrical</em> and <em>spherical</em>
      coordinates give us new ways of desribing surfaces and regions in space.
    </p>

    <figure xml:id="vid-multint-cylindrical-intro">
      <caption>A triple integral that isn't easily performed in rectancular coordinates</caption>
      <video youtube="Ajd8uy3U4lA"/>
    </figure>
  </introduction>

  <subsection>
    <title>Cylindrical Coordinates</title>
    <p>
      In short, cylindrical coordinates can be thought of as a combination of the polar and rectangular coordinate systems.
      One can identify a point <m>(x_0,y_0,z_0)</m>,
      given in rectangular coordinates,
      with the point <m>(r_0,\theta_0,z_0)</m>,
      given in cylindrical coordinates,
      where the <m>z</m>-value in both systems is the same,
      and the point <m>(x_0,y_0)</m> in the <m>xy</m>-plane is identified with the polar point <m>P(r_0,\theta_0)</m>;
      see <xref ref="fig_cylindricalintro">Figure</xref>.
      So that each point in space that does not lie on the <m>z</m>-axis is defined uniquely,
      we will restrict <m>r\geq 0</m> and <m>0\leq \theta\leq 2\pi</m>.
          <idx><h>cylindrical coordinates</h></idx>
          <idx><h>coordinates</h><h>cylindrical</h></idx>
    </p>

    <figure xml:id="fig_cylindricalintro">
      <caption>Illustrating the principles behind cylindrical coordinates</caption>
      <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
      3Droll=0,
      3Dortho=0.004267800133675337,
      3Dc2c=0.6733480095863342 0.6255449652671814 0.39407607913017273,
      3Dcoo=-12.612065315246582 -11.544181823730469 33.65996551513672,
      3Droo=150.0000065104165,
      3Dlights=Headlamp,add3Djscript=asylabels.js} -->
      <image xml:id="img_cylindricalintro_3D" width="47%">
        <description></description>
        <asymptote>
          import graph3;
          //import apexstyle;


          //ASY file for figstokes2_3D.asy in Chapter 13


          size(282,282,IgnoreAspect);
          //currentprojection=perspective(7,2,1);
          currentprojection=orthographic(24,17,11.6);
          defaultrender.merge=true;

          // setup and draw the axes
          real[] myxchoice={};
          real[] myychoice={};
          real[] myzchoice={};
          defaultpen(0.5mm);

          pair xbounds=(-.1,1.1);
          pair ybounds=(-.1,1.1);
          pair zbounds=(-.1,1.1);

          xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
          yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
          zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

          label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
          label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
          label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

          draw((.5,sqrt(3)/2,1)--(.5,sqrt(3)/2,0)--(0,0,0),dashed);

          draw(arc((0,0,0),(.5,0,0),(.25,sqrt(3)/4,0)),Arrow3(size=2mm));

          dot((.5,sqrt(3)/2,1),dotblue);

          label("$\theta$",(.55*cos(pi/6),.55*sin(pi/6),.1));

          label("$(r,\theta,z)$",(.5,sqrt(3)/2,1.1));

          label("$z$",(.5,sqrt(3)/2+.1,.5));

          label("$r$",(.20,sqrt(3)/4,0.05));

          //draw(s,emissive(gray+opacity(.3)),meshpen=invisible);


          //draw(s,simplesurfacepen,meshpen=apexmeshpen);



          //label("$\mathcal{S}$",(1,1,5));
          //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);

        </asymptote>
      </image>
    </figure>

    <p>
      We use the identity <m>z=z</m> along with the identities found in <xref ref="idea_polarconvert">Key Idea</xref>
      to convert between the rectangular coordinate <m>(x,y,z)</m> and the cylindrical coordinate <m>(r,\theta,z)</m>, namely:
      <me>
        \begin{array}{l} \text{ From rectangular to cylindrical: }  r=\sqrt{x^2+y^2}, \tan(\theta) = y/x \text{ and }  z=z;\\
         \text{ From cylindrical to rectangular: }   x=r\cos(\theta),  y=r\sin(\theta) \text{ and }  z=z. \end{array}
      </me>
    </p>

    <aside>
      <p>
        Our rectangular to polar conversion formulas used <m>r^2=x^2+y^2</m>,
        allowing for negative <m>r</m> values.
        Since we now restrict <m>r\geq 0</m>,
        we can use <m>r=\sqrt{x^2+y^2}</m>.
      </p>
    </aside>

    <p>
      These identities,
      along with conversions related to spherical coordinates,
      are given later in <xref ref="idea_convert_coords">Key Idea</xref>.
    </p>

    <figure xml:id="vid-trigint-cylindrical-definition">
      <caption>Explaining the cylindrical coordinate system</caption>
      <video youtube="DOFhlADkGko"/>
    </figure>

    <example xml:id="ex_cylindrical4">
      <title>Converting between rectangular and cylindrical coordinates</title>
      <statement>
        <p>
          Convert the rectangular point
          <m>(2,-2,1)</m> to cylindrical coordinates,
          and convert the cylindrical point <m>(4,3\pi/4,5)</m> to rectangular.
        </p>
      </statement>
      <solution>
        <p>
          Following the identities given above (and,
          later in <xref ref="idea_convert_coords">Key Idea</xref>),
          we have <m>r = \sqrt{2^2+(-2)^2} = 2\sqrt{2}</m>.
          Using <m>\tan(\theta) = y/x</m>,
          we find <m>\theta = \tan^{-1}(-2/2) =-\pi/4</m>.
          As we restrict <m>\theta</m> to being between <m>0</m> and <m>2\pi</m>,
          we set <m>\theta = 7\pi/4</m>.
          Finally, <m>z = 1</m>,
          giving the cylindrical point <m>(2\sqrt2,7\pi/4,1)</m>.
        </p>

        <p>
          In converting the cylindrical point <m>(4,3\pi/4,5)</m> to rectangular,
          we have <m>x = 4\cos\big(3\pi/4\big) = -2\sqrt{2}</m>,
          <m>y = 4\sin\big(3\pi/4\big) = 2\sqrt{2}</m> and <m>z=5</m>,
          giving the rectangular point <m>(-2\sqrt{2},2\sqrt{2},5)</m>.
        </p>
      </solution>
    </example>

    <p>
      Setting each of <m>r</m>,
      <m>\theta</m> and <m>z</m> equal to a constant defines a surface in space,
      as illustrated in the following example.
    </p>

    <example xml:id="ex_cylindrical1">
      <title>Canonical surfaces in cylindrical coordinates</title>
      <statement>
        <p>
          Describe the surfaces <m>r=1</m>,
          <m>\theta = \pi/3</m> and <m>z=2</m>,
          given in cylindrical coordinates.
        </p>
      </statement>
      <solution>
        <p>
          The equation <m>r=1</m> describes all points in space that are 1 unit away from the <m>z</m>-axis.
          This surface is a <q>tube</q> or <q>cylinder</q>
          of radius 1, centered on the <m>z</m>-axis,
          as graphed in <xref ref="fig_spacecylinder1">Figure</xref>
          (which describes the cylinder <m>x^2+y^2=1</m> in space).
        </p>

        <p>
          The equation <m>\theta=\pi/3</m> describes the plane formed by extending the line <m>\theta=\pi/3</m>,
          as given by polar coordinates in the <m>xy</m>-plane,
          parallel to the <m>z</m>-axis.
        </p>

        <p>
          The equation <m>z=2</m> describes the plane of all points in space that are 2 units above the <m>xy</m>-plane.
          This plane is the same as the plane described by <m>z=2</m> in rectangular coordinates.
        </p>

        <figure xml:id="fig_cylindrical1">
          <caption>Graphing the canonical surfaces in cylindrical coordinates from <xref ref="ex_cylindrical1">Example</xref></caption>
          <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
          3Droll=0,
          3Dortho=0.005137230269610882,
          3Dc2c=0.8924431204795837 0.30546268820762634 0.3320206105709076,
          3Dcoo=-13.9379243850708 -4.1078948974609375 30.89048194885254,
          3Droo=149.9999934895832,
          3Dlights=Headlamp,add3Djscript=asylabels.js} -->
          <image xml:id="img_cylindrical1_3D" width="47%">
            <description></description>
            <asymptote>
              import graph3;
              //import apexstyle;


              //ASY file for figcylindrical1_3D.asy in Chapter 13


              size(282,282,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(27,12,10);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={1};
              real[] myychoice={1};
              real[] myzchoice={1,2};
              defaultpen(0.5mm);

              pair xbounds=(-2,2);
              pair ybounds=(-2,2);
              pair zbounds=(-.5,2.75);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (t.x,t.y,2);//
              }
              surface s=surface(f,(-1.5,-1.5),(1.5,1.5),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=bluemeshpen+.1mm;
              draw(s,simplesurfacepen,meshpen=p);

              draw((-1.5,-1.5,2) -- (-1.5,1.5,2) -- (1.5,1.5,2) -- (1.5,-1.5,2) -- (-1.5,-1.5,2),apexmeshpen+.25mm);


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (t.x,t.x*sqrt(3),t.y);//
              }
              surface s=surface(f,(0,-.5),(1.25,2.25),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen q=redmeshpen2+.1mm;
              draw(s,simplesurfacepen2,meshpen=q);

              draw((0,0,-.5) -- (1.25,1.25*sqrt(3),-.5) -- (1.25,1.25*sqrt(3),2.25) -- (0,0,2.25) -- (0,0,-.5),redcurvepen+.25mm);


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (cos(t.x),sin(t.x),t.y);//
              }
              surface s=surface(f,(0,-.5),(2*pi,2.25),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen q=greenmeshpen+.1mm;

              draw(s,simplesurfacepen3,meshpen=q);

              //dot((.5,sqrt(3)*.5,2),rgb(.1,.1,.1));

              draw((.5,sqrt(3)*.5,-.5)--(.5,sqrt(3)*.5,2.25));

              triple g(real t) {return (cos(t),sin(t),2);}
              path3 mypath=graph(g,0,2*pi,operator ..);
              draw(mypath,blackmeshpen);

              triple g(real t) {return (cos(t),sin(t),2.25);}
              path3 mypath=graph(g,0,2*pi,operator ..);
              draw(mypath,greencurvepen+.25mm);

              triple g(real t) {return (cos(t),sin(t),-.5);}
              path3 mypath=graph(g,0,2*pi,operator ..);
              draw(mypath,greencurvepen+.25mm);

              triple g(real t) {return (t,sqrt(3)*t,2);}
              path3 mypath=graph(g,0,.866,operator ..);

              draw(mypath,blackmeshpen);

              //draw(s,emissive(gray+opacity(.3)),meshpen=invisible);


              //draw(s,simplesurfacepen,meshpen=apexmeshpen);



              label("$z=2$",(-1.25,1.25,2.3));
              label("$r=1$",(1.1*cos(pi/6),1.1*sin(pi/6),-.75));

              label("$\theta=\frac{\pi}{3}$",(1.25,1.25*sqrt(3),1));

              //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);
            </asymptote>
          </image>
        </figure>

        <p>
          All three surfaces are graphed in <xref ref="fig_cylindrical1">Figure</xref>.
          Note how their intersection uniquely defines the point <m>P=(1,\pi/3,2)</m>.
        </p>
      </solution>
    </example>

    <p>
      Cylindrical coordinates are useful when describing certain domains in space,
      allowing us to evaluate triple integrals over these domains more easily than if we used rectangular coordinates.
    </p>

    <p>
      <xref ref="thm_triple_integration2">Theorem</xref>
      shows how to evaluate <m>\iiint_Dh(x,y,z)\, dV</m> using rectangular coordinates.
      In that evaluation, we use <m>dV = dz\,dy\,dx</m>
      (or one of the other five orders of integration).
      Recall how, in this order of integration,
      the bounds on <m>y</m> are <q>curve to curve</q>
      and the bounds on <m>x</m> are <q>point to point</q>:
      these bounds describe a region <m>R</m> in the <m>xy</m>-plane.
      We could describe <m>R</m> using polar coordinates as done in <xref ref="sec_double_int_polar">Section</xref>.
      In that section, we saw how we used
      <m>dA = r\,dr\,d\theta</m> instead of <m>dA = dy\,dx</m>.
    </p>

    <p>
      Considering the above thoughts,
      we have <m>dV = dz\big(r\,dr\,d\theta\big) = r\,dz\,dr\,d\theta</m>.
      We set bounds on <m>z</m> as <q>surface to surface</q>
      as done in the previous section,
      and then use <q>curve to curve</q>
      and <q>point to point</q>
      bounds on <m>r</m> and <m>\theta</m>, respectively.
      Finally, using the identities given above,
      we change the integrand <m>h(x,y,z)</m> to <m>h(r,\theta,z)</m>.
    </p>

    <p>
      This process should sound plausible;
      the following theorem states it is truly a way of evaluating a triple integral.
    </p>

    <theorem xml:id="thm_triple_int_cylindrical">
      <title>Triple Integration in Cylindrical Coordinates</title>
      <statement>
        <p>
          Let <m>w=h(r,\theta,z)</m> be a continuous function on a closed,
          bounded region <m>D</m> in space,
          bounded in cylindrical coordinates by <m>\alpha \leq \theta \leq \beta</m>,
          <m>g_1(\theta)\leq r \leq g_2(\theta)</m> and <m>f_1(r,\theta) \leq z \leq f_2(r,\theta)</m>.
          Then <idx><h>integration</h><h>with cylindrical coordinates</h></idx>
          <me>
            \iiint_D h(r,\theta,z)\, dV = \int_\alpha^\beta\int_{g_1(\theta)}^{g_2(\theta)}\int_{f_1(r,\theta)}^{f_2(r,\theta)}h(r,\theta,z) r\,dz\,dr\,d\theta
          </me>.
        </p>
      </statement>
    </theorem>

    <figure xml:id="vid-multint-cylindrical-cone">
      <caption>Using cylindrical coordinates to find the volume of a cone</caption>
      <video youtube="u0FYs9MaI5k"/>
    </figure>

    <example xml:id="ex_cylindrical2">
      <title>Evaluating a triple integral with cylindrical coordinates</title>
      <statement>
        <p>
          Find the mass of the solid represented by the region in space bounded by <m>z=0</m>,
          <m>z=\sqrt{4-x^2-y^2}+3</m> and the cylinder <m>x^2+y^2=4</m>
          (as shown in <xref ref="fig_cylindrical2">Figure</xref>),
          with density function <m>\delta(x,y,z) = x^2+y^2+z+1</m>,
          using a triple integral in cylindrical coordinates.
          Distances are measured in centimeters and density is measured in grams per cubic centimeter.
        </p>
        <figure xml:id="fig_cylindrical2">
          <caption>Visualizing the solid used in <xref ref="ex_cylindrical2">Example</xref></caption>
          <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
          3Droll=0,
          3Dortho=0.004440656863152981,
          3Dc2c=0.6615753173828125 0.6849026679992676 0.30533018708229065,
          3Dcoo=-6.77640962600708 2.852377414703369 51.19231414794922,
          3Droo=300,
          3Dlights=Headlamp,add3Djscript=asylabels.js} -->
          <image xml:id="img_cylindrical2_3D" width="47%">
            <description></description>
            <asymptote>
              import graph3;
              //import apexstyle;


              //ASY file for figcylindrical2_3D.asy in Chapter 13


              size(282,282,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(22,22,11);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={2};
              real[] myychoice={2};
              real[] myzchoice={1,3,5};
              defaultpen(0.5mm);

              pair xbounds=(-2.5,2.5);
              pair ybounds=(-2.5,2.5);
              pair zbounds=(-.5,6);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (2*t.y*cos(t.x),2*t.y*sin(t.x),sqrt(4-4*t.y^2)+3);//
              }
              surface s=surface(f,(0,0),(2pi,1),16,16,Spline);
              pen p=bluemeshpen+.1mm;
              draw(s,simplesurfacepen,meshpen=p);

              //draw((-1.5,-1.5,2) -- (-1.5,1.5,2) -- (1.5,1.5,2) -- (1.5,-1.5,2) -- (-1.5,-1.5,2),apexmeshpen+.25mm);


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (2*cos(t.x),2*sin(t.x),t.y);//
              }
              surface s=surface(f,(0,0),(2*pi,3),16,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=bluemeshpen+.1mm;
              draw(s,simplesurfacepen,meshpen=p);



              //draw(s,emissive(gray+opacity(.3)),meshpen=invisible);


              //draw(s,simplesurfacepen,meshpen=apexmeshpen);




              //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);
            </asymptote>
          </image>
        </figure>
      </statement>
      <solution>
        <p>
          We begin by describing this region of space with cylindrical coordinates.
          The plane <m>z=0</m> is left unchanged;
          with the identity <m>r=\sqrt{x^2+y^2}</m>,
          we convert the hemisphere of radius 2 to the equation <m>z=\sqrt{4-r^2}</m>;
          the cylinder <m>x^2+y^2=4</m> is converted to <m>r^2=4</m>,
          or, more simply, <m>r=2</m>.
          We also convert the density function:
          <m>\delta(r,\theta,z) = r^2+z+1</m>.
        </p>

        <p>
          To describe this solid with the bounds of a triple integral,
          we bound <m>z</m> with <m>0\leq z\leq \sqrt{4-r^2}+3</m>;
          we bound <m>r</m> with <m>0 \leq r \leq 2</m>;
          we bound <m>\theta</m> with <m>0 \leq \theta \leq 2\pi</m>.
        </p>

        <p>
          Using <xref ref="def_mass_3d">Definition</xref>
          and <xref ref="thm_triple_int_cylindrical">Theorem</xref>,
          we have the mass of the solid is
          <md>
            <mrow>M=\iiint_D\delta(x,y,z)\, dV \amp = \int_0^{2\pi}\int_0^2\int_0^{\sqrt{4-r^2}+3}\big(r^2+z+1\big)r\,dz\,dr\,d\theta</mrow>
            <mrow>\amp = \int_0^{2\pi}\int_0^2\big((r^3+4r)\sqrt{4-r^2}+\frac52r^3+\frac{19}2r\big)\,dr\,d\theta</mrow>
            <mrow>\amp = \frac{1318\pi}{15} \approx 276.04\,\text{g} </mrow>
          </md>,
          where we leave the details of the remaining double integral to the reader.
        </p>
      </solution>
    </example>

    <example xml:id="ex_cylindrical3">
      <title>Finding the center of mass using cylindrical coordinates</title>
      <statement>
        <p>
          Find the center of mass of the solid with constant density whose base can be described by the polar curve
          <m>r=\cos(3\theta)</m> and whose top is defined by the plane <m>z=1-x+0.1y</m>,
          where distances are measured in feet,
          as seen in <xref ref="fig_cylindrical3">Figure</xref>.
          (The volume of this solid was found in <xref ref="ex_doublepol4">Example</xref>.)
        </p>
        <figure xml:id="fig_cylindrical3">
          <caption>Visualizing the solid used in <xref ref="ex_cylindrical3">Example</xref></caption>
          <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
          3Droll=-0.545358908878901,
          3Dortho=0.004904536530375481,
          3Dc2c=0.25393617153167725 0.2084963023662567 0.9444817304611206,
          3Dcoo=-6.77640962600708 2.852377414703369 51.19231414794922,
          3Droo=299.99999864287065,
          3Dlights=Headlamp,add3Djscript=asylabels.js} -->
          <image xml:id="img_doublepol4_3D" width="47%">
            <description></description>
            <asymptote>
              import graph3;

              //ASY file for figdoublepol43D.asy in Chapter 13


              size(282,282,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(4,4,2);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={};
              real[] myychoice={};
              real[] myzchoice={};
              defaultpen(0.5mm);

              pair xbounds=(-2,2);
              pair ybounds=(-2,2);
              pair zbounds=(-2,2);

              //xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              //yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              //zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              //label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              //label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              //label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

              //plane is z=1-x+0.1y
              //Draw the surface
              //({cos(3*x)*cos(x)},{cos(3*x)*sin(x)},{(1-cos(3*x)*cos(x)+.1*cos(3*x)*sin(x))*y});
              triple f(pair t) {
                return (cos(3*t.x)*cos(t.x),cos(3*t.x)*sin(t.x),(1-cos(3*t.x)*cos(t.x)+.1*cos(3*t.x)*sin(t.x))*t.y);
              }
              surface s=surface(f,(0,0),(2*pi,1),32,32,Spline);
              pen p=apexmeshpen;
              draw(s,surfacepen,meshpen=p);

              //draw curve on xy plane //({cos(3*x)*cos(x)},{cos(3*x)*sin(x)},{0})
              triple g(real t) {return (cos(3*t)*cos(t),cos(3*t)*sin(t),0);}
              path3 mypath=graph(g,0,pi,operator ..);
              draw(mypath,bluepen+linewidth(2));


              //draw curves on surface
              triple g(real t) {return (cos(3*t)*cos(t),cos(3*t)*sin(t),1-(cos(3*t)*cos(t))+0.1*(cos(3*t)*sin(t)));}
              path3 mypath=graph(g,0,pi,operator ..);
              draw(mypath,bluepen+linewidth(2));


              //Shade the bottom
              import three;
              path3 p =  (0,0,0)..(.175,0.064,0)..(.264,.119,0)..(0.683,0.183,0)..(.916,0.121,0)..(1,0,0)..(.916,-0.121,0)..(0.683,-0.183,0)..(.264,-.119,0)..(.175,-0.086,0);
              draw(surface(p -- cycle), simplesurfacepen);

              path3 p = (0,0,0)..(-0.1429, 0.1196,0)..(-0.2351, 0.1691,0)..(-0.5000, 0.5000,0)..(-0.5628, 0.7328,0)..(-0.5000, 0.8660,0)..(-0.3532, 0.8538,0)..(-0.1830, 0.6830,0)..(-0.0289, 0.2881,0)..(-0.0130, 0.1946,0);
              draw(surface(p -- cycle), simplesurfacepen);

              path3 p = (0,0,0)..(-0.0321,-0.1836,0)..(-0.0289,-0.2881,0)..(-0.1830,-0.6830,0)..(-0.3532,-0.8538,0)..(-0.5000,-0.8660,0)..(-0.5628,-0.7328,0)..(-0.5000,-0.5000,0)..(-0.2351,-0.1691,0)..(-0.1620,-0.1086,0);
              draw(surface(p -- cycle), simplesurfacepen);

              //Shade the top
              path3 p = (0,0,1.0000)..(-0.1429,0.1196,1.1549)..(-0.2351,0.1691,1.2520)..(-0.5000,0.5000,1.5500)..(-0.5628,0.7328,1.6361)..(-0.5000,0.8660,1.5866)..(-0.3532,0.8538,1.4386)..(-0.1830 ,0.6830 ,1.2513)..(-0.0289,0.2881,1.0578)..(-0.0130,0.1946,1.0325);

              draw(surface(p -- cycle), simplesurfacepen);
              path3 p = (0 ,        0  ,  1.0000)..(-0.0321 ,  -0.1836 ,   1.0137)..(-0.0289,   -0.2881,    1.0001)..(-0.1830,   -0.6830,    1.1147)..(-0.3532  , -0.8538 ,   1.2678)..(-0.5000,   -0.8660 ,   1.4134)..(-0.5628 ,  -0.7328,    1.4895)..(-0.5000 ,  -0.5000 ,   1.4500)..(-0.2351 ,  -0.1691 ,   1.2181)..(-0.1620 ,  -0.1086,    1.1511);
              draw(surface(p -- cycle), simplesurfacepen);

              path3 p = (0 ,        0,    1.0000)..( 0.1750,    0.0640 ,   0.8314)..( 0.2640,    0.1190 ,   0.7479)..( 0.6830,    0.1830 ,   0.3353)..( 0.9160,    0.1210 ,   0.0961)..( 1.0000,         0 ,        0)..( 0.9160,   -0.1210 ,   0.0719)..( 0.6830,   -0.1830 ,   0.2987)..( 0.2640,   -0.1190 ,   0.7241)..( 0.1750,   -0.0860 ,   0.8164);
              draw(surface(p -- cycle), simplesurfacepen);
            </asymptote>
          </image>
        </figure>
      </statement>
      <solution>
        <p>
          We convert the equation of the plane to use cylindrical coordinates:
          <m>z= 1-r\cos(\theta)+0.1r\sin(\theta)</m>.
          Thus the region is space is bounded by <m>0 \leq z \leq 1-r\cos(\theta) + 0.1r\sin(\theta)</m>,
          <m>0 \leq r \leq \cos(3\theta)</m>,
          <m>0 \leq \theta \leq \pi</m> (recall that the rose curve
          <m>r=\cos(3\theta)</m> is traced out once on <m>[0,\pi]</m>.
        </p>

        <p>
          Since density is constant,
          we set <m>\delta = 1</m> and finding the mass is equivalent to finding the volume of the solid.
          We set up the triple integral to compute this but do not evaluate it;
          we leave it to the reader to confirm it evaluates to the same result found in <xref ref="ex_doublepol4">Example</xref>.
          <me>
            M = \iiint_D\delta \, dV = \int_0^{\pi}\int_0^{\cos(3\theta)}\int_0^{1-r\cos(\theta)+0.1r\sin(\theta)} r\,dz\,dr\,d\theta \approx 0.785
          </me>.
        </p>

        <p>
          From <xref ref="def_mass_3d">Definition</xref>
          we set up the triple integrals to compute the moments about the three coordinate planes.
          The computation of each is left to the reader (using technology is recommended):
          <md>
            <mrow>M_{yz} = \iiint_D x\,dV \amp = \int_0^{\pi}\int_0^{\cos(3\theta)}\int_0^{1-r\cos(\theta)+0.1r\sin(\theta)} (r\cos(\theta)) r\,dz\,dr\,d\theta</mrow>
            <mrow>\amp = -0.147</mrow>
          </md>.
          <md>
            <mrow>M_{xz} = \iiint_D y\,dV \amp = \int_0^{\pi}\int_0^{\cos(3\theta)}\int_0^{1-r\cos(\theta)+0.1r\sin(\theta)} (r\sin(\theta)) r\,dz\,dr\,d\theta</mrow>
            <mrow>\amp = 0.015.</mrow>
            <mrow>M_{xy} = \iiint_D z\,dV \amp = \int_0^{\pi}\int_0^{\cos(3\theta)}\int_0^{1-r\cos(\theta)+0.1r\sin(\theta)} (z) r\,dz\,dr\,d\theta</mrow>
            <mrow>\amp = 0.467</mrow>
          </md>.
        </p>

        <p>
          The center of mass, in rectangular coordinates,
          is located at <m>(-0.147,0.015,0.467)</m>,
          which lies outside the bounds of the solid.
        </p>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>Spherical Coordinates</title>
    <p>
          <idx><h>spherical coordinates</h></idx>
          <idx><h>coordinates</h><h>spherical</h></idx>
    </p>

    <p>
      In short, spherical coordinates can be thought of as a
      <q>double application</q>
      of the polar coordinate system.
      In spherical coordinates,
      a point <m>P</m> is identified with <m>(\rho,\theta,\varphi)</m>,
      where <m>\rho</m> is the distance from the origin to <m>P</m>,
      <m>\theta</m> is the same angle as would be used to describe <m>P</m> in the cylindrical coordinate system,
      and <m>\varphi</m> is the angle between the positive <m>z</m>-axis and the ray from the origin to <m>P</m>;
      see <xref ref="fig_sphericalintro">Figure</xref>.
      So that each point in space that does not lie on the <m>z</m>-axis is defined uniquely,
      we will restrict <m>\rho \geq 0</m>,
      <m>0 \leq \theta \leq 2\pi</m> and <m>0 \leq \varphi \leq \pi</m>.
    </p>
    <aside>
      <p>
        The symbol <m>\rho</m> is the Greek letter <q>rho.</q>
        Traditionally it is used in the spherical coordinate system,
        while <m>r</m> is used in the polar and cylindrical coordinate systems.
      </p>
    </aside>
    <figure xml:id="fig_sphericalintro">
      <caption>Illustrating the principles behind spherical coordinates</caption>
      <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
      3Droll=0,
      3Dortho=0.0045,
      3Dc2c=0.6936245560646057 0.5807817578315735 0.4261191189289093,
      3Dcoo=-15.555180549621582 -9.786354064941406 35.21320343017578,
      3Droo=150,
      3Dlights=Headlamp,add3Djscript=asylabels.js} -->
      <image xml:id="img_sphericalintro_3D" width="47%">
        <description></description>
        <asymptote>
          import graph3;
          //import apexstyle;


          //ASY file for figsphericalintro.asy in Chapter 13


          size(282,282,IgnoreAspect);
          //currentprojection=perspective(7,2,1);
          currentprojection=orthographic(24,17,11.6);
          defaultrender.merge=true;

          // setup and draw the axes
          real[] myxchoice={};
          real[] myychoice={};
          real[] myzchoice={};
          defaultpen(0.5mm);

          pair xbounds=(-.1,1.1);
          pair ybounds=(-.1,1.1);
          pair zbounds=(-.1,1.1);

          xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
          yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
          zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

          label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
          label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
          label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

          draw((.5,sqrt(3)/2,1)--(.5,sqrt(3)/2,0)--(0,0,0)--cycle,dashed);

          draw(arc((0,0,0),(.5,0,0),(.25,sqrt(3)/4,0)),Arrow3(size=2mm));

          draw(arc((0,0,0),(0,0,0.5),(.5,sqrt(3)/2,1)*.5/1.414),Arrow3(size=2mm));

          guide3 myarc=arc((0,0,0),(0,0,0.5),(.5,sqrt(3)/2,1)*.5/1.414);

          label("$\varphi$",myarc,NE);


          dot((.5,sqrt(3)/2,1),dotblue);

          label("$\theta$",(.55*cos(pi/6),.55*sin(pi/6),.1));

          label("$(\rho,\theta,\varphi)$",(.5,sqrt(3)/2,1.1));

          //label("$z$",(.5,sqrt(3)/2+.1,.5));

          label("$\rho$",(.5,sqrt(3)/2,1)*.5+(0.05,0.05,-.05));

          //draw(s,emissive(gray+opacity(.3)),meshpen=invisible);


          //draw(s,simplesurfacepen,meshpen=apexmeshpen);
        </asymptote>
      </image>
    </figure>

    <figure xml:id="vid-multint-spherical-intro">
      <caption>Introducing spherical coordinates</caption>
      <video youtube="In5up-a1jMI"/>
    </figure>

    <p>
      The following Key Idea gives conversions to/from our three spatial coordinate systems.
    </p>

    <insight xml:id="idea_convert_coords">
      <title>Converting Between Rectangular, Cylindrical and Spherical Coordinates</title>
      <p>
        <term>Rectangular and Cylindrical</term>
        <md>
          <mrow>\amp r^2 = x^2+y^2, \amp \amp \tan(\theta) = y/x,\amp  z\amp=z</mrow>
          <mrow>\amp x=r\cos(\theta), \amp \amp y =r\sin(\theta),\amp  z\amp =z</mrow>
        </md>
      </p>

      <p>
        <term>Rectangular and Spherical</term>
        <md>
          <mrow>\amp \rho = \sqrt{x^2+y^2+z^2}, \amp \amp \tan(\theta) = y/x, \amp \amp \cos(\varphi) = z/\sqrt{x^2+y^2+z^2}</mrow>
          <mrow>\amp x=\rho\sin(\varphi)\cos(\theta),\amp \amp y=\rho\sin(\varphi)\sin(\theta),\amp \amp z=\rho\cos(\varphi)</mrow>
        </md>
      </p>

      <p>
        <term>Cylindrical and Spherical </term>
        <md>
          <mrow>\amp \rho =\sqrt{r^2+z^2},\amp \amp  \theta = \theta,\amp \amp \tan(\varphi) = r/z</mrow>
          <mrow>\amp r=\rho \sin(\varphi),\amp \amp  \theta = \theta,\amp \amp z=\rho\cos(\varphi)</mrow>
        </md>
      </p>
    </insight>

    <aside>
      <p>
        The role of <m>\theta</m> and <m>\varphi</m> in spherical coordinates differs between mathematicians and physicists.
        When reading about physics in spherical coordinates,
        be careful to note how that particular author uses these variables and recognize that these identities will may no longer be valid.
      </p>
    </aside>

    <example xml:id="ex_spherical4">
      <title>Converting between rectangular and spherical coordinates</title>
      <statement>
        <p>
          Convert the rectangular point
          <m>(2,-2,1)</m> to spherical coordinates,
          and convert the spherical point
          <m>(6,\pi/3,\pi/2)</m> to rectangular and cylindrical coordinates.
        </p>
      </statement>
      <solution>
        <p>
          This rectangular point is the same as used in <xref ref="ex_cylindrical4">Example</xref>.
          Using <xref ref="idea_convert_coords">Key Idea</xref>,
          we find <m>\rho = \sqrt{2^2+(-1)^2+1^2} = 3</m>.
          Using the same logic as in <xref ref="ex_cylindrical4">Example</xref>,
          we find <m>\theta = 7\pi/4</m>.
          Finally, <m>\cos(\varphi) = 1/3</m>,
          giving <m>\varphi = \cos^{-1}(1/3) \approx 1.23</m>,
          or about <m>70.53^\circ</m>.
          Thus the spherical coordinates are approximately <m>(3,7\pi/4,1.23)</m>.
        </p>

        <p>
          Converting the spherical point <m>(6,\pi/3,\pi/2)</m> to rectangular,
          we have <m>x = 6\sin(\pi/2)\cos(\pi/3) = 3</m>,
          <m>y = 6\sin(\pi/2)\sin(\pi/3) = 3\sqrt{3}</m> and <m>z = 6\cos(\pi/2) = 0</m>.
          Thus the rectangular coordinates are <m>(3,3\sqrt{3},0)</m>.
        </p>

        <p>
          To convert this spherical point to cylindrical,
          we have <m>r = 6\sin(\pi/2) = 6</m>,
          <m>\theta = \pi/3</m> and <m>z = 6\cos(\pi/2) =0</m>,
          giving the cylindrical point <m>(6,\pi/3,0)</m>.
        </p>
      </solution>
    </example>

    <example xml:id="ex_spherical1">
      <title>Canonical surfaces in spherical coordinates</title>
      <statement>
        <p>
          Describe the surfaces <m>\rho=1</m>,
          <m>\theta = \pi/3</m> and <m>\varphi = \pi/6</m>,
          given in spherical coordinates.
        </p>
      </statement>
      <solution>
        <p>
          The equation <m>\rho = 1</m> describes all points in space that are 1 unit away from the origin:
          this is the sphere of radius 1, centered at the origin.
        </p>

        <p>
          The equation <m>\theta = \pi/3</m> describes the same surface in spherical coordinates as it does in cylindrical coordinates:
          beginning with the line <m>\theta = \pi/3</m> in the <m>xy</m>-plane as given by polar coordinates,
          extend the line parallel to the <m>z</m>-axis, forming a plane.
        </p>

        <p>
          The equation <m>\varphi=\pi/6</m> describes all points <m>P</m> in space where the ray from the origin to <m>P</m> makes an angle of <m>\pi/6</m> with the positive <m>z</m>-axis.
          This describes a cone,
          with the positive <m>z</m>-axis its axis of symmetry, with point at the origin.
        </p>

        <figure xml:id="fig_spherical1">
          <caption>Graphing the canonical surfaces in spherical coordinates from <xref ref="ex_spherical1">Example</xref></caption>
          <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
          3Droll=0,
          3Dortho=0.004559914115816355,
          3Dc2c=0.8784526586532593 0.3397093713283539 0.3360334038734436,
          3Dcoo=7.126433849334717 10.647956848144531 4.059844017028809,
          3Droo=300,
          3Dlights=Headlamp,add3Djscript=asylabels.js} -->
          <image xml:id="img_spherical1_3D" width="47%">
            <description></description>
            <asymptote>
              import graph3;
              //import apexstyle;


              //ASY file for figspherical1_3D.asy in Chapter 13


              size(282,282,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(27,13,9);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={1};
              real[] myychoice={1};
              real[] myzchoice={1};
              defaultpen(0.5mm);

              pair xbounds=(-2,2);
              pair ybounds=(-2,2);
              pair zbounds=(-1.5,2);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (t.y*cos(t.x),t.y*sin(t.x),sqrt(3)*t.y);//
              }
              surface s=surface(f,(0,0),(2*pi,1.5/sqrt(3)),16,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=bluemeshpen+.1mm;
              draw(s,simplesurfacepen,meshpen=p);

              //draw((-1.5,-1.5,2) -- (-1.5,1.5,2) -- (1.5,1.5,2) -- (1.5,-1.5,2) -- (-1.5,-1.5,2),apexmeshpen+.25mm);

              triple g(real t) {return (1.5/sqrt(3)*cos(t),1.5/sqrt(3)*sin(t),1.5);}
              path3 mypath=graph(g,0,2*pi,operator ..);
              draw(mypath,apexmeshpen);

              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (t.x,t.x*sqrt(3),t.y);//
              }
              surface s=surface(f,(0,-1.25),(1.25,1.5),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen q=redmeshpen2+.1mm;
              draw(s,simplesurfacepen2,meshpen=q);

              draw((0,0,-1.25) -- (1.25,1.25*sqrt(3),-1.25) -- (1.25,1.25*sqrt(3),1.5) -- (0,0,1.5) -- (0,0,-1.5),redcurvepen+.25mm);


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (sin(t.y)*cos(t.x),sin(t.y)*sin(t.x),cos(t.y));//
              }
              surface s=surface(f,(0,0),(2*pi,pi),16,16,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen q=greenmeshpen+.1mm;
              draw(s,simplesurfacepen3,meshpen=q);

              //dot((.5,sqrt(3)*.5,2),rgb(.1,.1,.1));

              //draw((.5,sqrt(3)*.5,-.5)--(.5,sqrt(3)*.5,2.25));

              triple g(real t) {return (1/2*cos(t),1/2*sin(t),1/2*sqrt(3));}
              path3 mypath=graph(g,0,2*pi,operator ..);
              draw(mypath,blackmeshpen);

              //(1.5/sqrt(3)*cos(t),1.5/sqrt(3)*sin(t),1.5)
              draw((0,0,0) -- (1.5/sqrt(3)*cos(pi/3),1.5/sqrt(3)*sin(pi/3),1.5));

              triple g(real t) {return (sin(t)*cos(pi/3),sin(t)*sin(pi/3),cos(t));}
              path3 mypath=graph(g,0,pi,operator ..);
              draw(mypath,blackmeshpen);

              triple g(real t) {return (cos(t),sin(t),-.5);}
              path3 mypath=graph(g,0,2*pi,operator ..);
              //draw(mypath,greencurvepen+.25mm);

              triple g(real t) {return (t,sqrt(3)*t,2);}
              path3 mypath=graph(g,-.866,.866,operator ..);
              //draw(mypath,blackmeshpen);

              //draw(s,emissive(gray+opacity(.3)),meshpen=invisible);


              //draw(s,simplesurfacepen,meshpen=apexmeshpen);



              label("$\varphi=\frac{\pi}{6}$",(1.5/sqrt(3)*cos(2pi/3),1.5/sqrt(3)*sin(2pi/3),1.5),E);
              label("$\rho=1$",(1.1*cos(pi/200),1.1*sin(pi/200),-.9));
              label("$\theta=\frac{\pi}{3}$",(1.25,1.25*sqrt(3),1));

              //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);
            </asymptote>
          </image>
        </figure>

        <p>
          All three surfaces are graphed in <xref ref="fig_spherical1">Figure</xref>.
          Note how their intersection uniquely defines the point <m>P=(1,\pi/3,\pi/6)</m>.
        </p>
      </solution>
    </example>

    <p>
      Spherical coordinates are useful when describing certain domains in space,
      allowing us to evaluate triple integrals over these domains more easily than if we used rectangular coordinates or cylindrical coordinates.
      The crux of setting up a triple integral in spherical coordinates is appropriately describing the
      <q>small amount of volume,</q>
      <m>dV</m>, used in the integral.
    </p>

    <p>
      Considering <xref ref="fig_sphericalwedge">Figure</xref>,
      we can make a small <q>spherical wedge</q> by varying <m>\rho</m>,
      <m>\theta</m> and <m>\varphi</m> each a small amount, <m>\Delta\rho</m>,
      <m>\Delta\theta</m> and <m>\Delta\varphi</m>, respectively.
      This wedge is approximately a rectangular solid when the change in each coordinate is small,
      giving a volume of about
      <me>
        \Delta V \approx \Delta\rho\ \times\ \rho\Delta\varphi\ \times\ \rho\sin(\varphi)\Delta\theta
      </me>.
    </p>

    <figure xml:id="fig_sphericalwedge">
      <caption>Approximating the volume of a standard region in space using spherical coordinates</caption>
      <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
      3Droll=0,
      3Dortho=0.004123700316995382,
      3Dc2c=0.8697938919067383 0.43597298860549927 0.23105460405349731,
      3Dcoo=-19.780941009521484 32.02916717529297 43.93011474609375,
      3Droo=300.000013020833,
      3Dlights=Headlamp,add3Djscript=asylabels.js} -->
      <image xml:id="img_sphericalwedge_3D" width="47%">
        <description></description>
        <asymptote>
          import graph3;
          //import apexstyle;


          //ASY file for figspherical1_3D.asy in Chapter 13


          size(282,282,IgnoreAspect);
          //currentprojection=perspective(7,2,1);
          currentprojection=orthographic(14.4,2.6,10);
          defaultrender.merge=true;

          // setup and draw the axes
          real[] myxchoice={};
          real[] myychoice={};
          real[] myzchoice={};
          defaultpen(0.5mm);

          pair xbounds=(-.1,.6);
          pair ybounds=(-.1,.6);
          pair zbounds=(-.1,1);

          xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
          yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
          zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

          label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
          label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
          label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));


          real t1=pi/3-.2;
          real t2=pi/3+.2;
          real p1=pi/6-.2;
          real p2=pi/6+.2;
          real r1=.75;
          real r2=.9;



          //Draw the plane  z=7-2x-2y
          triple f(pair t) {
          	return (r1*cos(t.x)*sin(t.y),r1*sin(t.x)*sin(t.y),r1*cos(t.y));//
          }
          surface s=surface(f,(t1,p1),(t2,p2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
          pen p=apexmeshpen+.1mm;
          draw(s,simplesurfacepen,meshpen=p);


          triple f(pair t) {
          	return (r2*cos(t.x)*sin(t.y),r2*sin(t.x)*sin(t.y),r2*cos(t.y));//
          }
          surface s=surface(f,(t1,p1),(t2,p2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
          draw(s,simplesurfacepen,meshpen=p);


          triple f(pair t) {
          	return (t.y*cos(t.x)*sin(p1),t.y*sin(t.x)*sin(p1),t.y*cos(p1));//
          }
          surface s=surface(f,(t1,r1),(t2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
          draw(s,simplesurfacepen,meshpen=p);


          triple f(pair t) {
          	return (t.y*cos(t.x)*sin(p2),t.y*sin(t.x)*sin(p2),t.y*cos(p2));//
          }
          surface s=surface(f,(t1,r1),(t2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
          draw(s,simplesurfacepen,meshpen=p);


          triple f(pair t) {
          	return (t.y*cos(t1)*sin(t.x),t.y*sin(t1)*sin(t.x),t.y*cos(t.x));//
          }
          surface s=surface(f,(p1,r1),(p2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
          draw(s,simplesurfacepen,meshpen=p);


          triple f(pair t) {
          	return (t.y*cos(t2)*sin(t.x),t.y*sin(t2)*sin(t.x),t.y*cos(t.x));//
          }
          surface s=surface(f,(p1,r1),(p2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
          draw(s,simplesurfacepen,meshpen=p);


          //
          // lines for phi
          //
          draw((r1*cos(t1)*sin(p1),r1*sin(t1)*sin(p1),r1*cos(p1)) -- (0,0,0) -- (r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)),black+.25mm+dashed);

          draw(arc((0,0,0),(r1*cos(t1)*sin(p1)/2.5,r1*sin(t1)*sin(p1)/2.5,r1*cos(p1)/2.5),(r1*cos(t1)*sin(p2)/2.5,r1*sin(t1)*sin(p2)/2.5,r1*cos(p2)/2.5)),black+.25mm,Arrow3(size=1.5mm));

          label("$\Delta\varphi$",.95*(r1*cos(t1)*sin((p1+p2)/2)/2,r1*sin(t1)*sin((p1+p2)/2)/2,r1*cos((p1+p2)/2)/2));



          //
          //  lines for theta
          //

          draw((0,0,0) -- (r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),0) -- (r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)),black+.25mm+dashed);

          draw((0,0,0) -- (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),0) -- (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)),black+.25mm+dashed);

          draw(arc((0,0,0),.5*(r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),0),.5*(r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),0)),black+.25mm,Arrow3(size=1.5mm));

          label("$\Delta\theta$",1.2*.5*(r1*cos((t1+t2)/2)*sin(p2),r1*sin((t1+t2)/2)*sin(p2),0));

          //
          // lines for rho
          //

          draw(arc((0,0,0),(r1*cos(t1)*sin(0),r1*sin(t1)*sin(0),r1*cos(0)),(r1*cos(t1)*sin(p1),r1*sin(t1)*sin(p1),r1*cos(p1))),black+.25mm+dashed);

          draw(arc((0,0,0),(r2*cos(t1)*sin(0),r2*sin(t1)*sin(0),r2*cos(0)),(r2*cos(t1)*sin(p1),r2*sin(t1)*sin(p1),r2*cos(p1))),black+.25mm+dashed);


          label("$\Delta\rho$",((r1+r2)/2*cos(t1)*sin(.65*(p1)),(r1+r2)/2*sin(t1)*sin(.65*(p1)),(r1+r2)/2*cos(.65*(p1))));

          real poff = -0.05;

          draw((r1*cos(t1)*sin(p1+poff),r1*sin(t1)*sin(p1+poff),r1*cos(p1+poff)) -- (r2*cos(t1)*sin(p1+poff),r2*sin(t1)*sin(p1+poff),r2*cos(p1+poff)),black+.25mm,Arrows3(size=1.5mm));

          label("$\rho$",(0,-.04,.5*r1));

          draw((0,-.02,.01) -- (0,-.02,.99*r1),black+.25mm,Arrows3(size=1.5mm));


          //
          //  lines for theta length
          //

          draw((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) -- (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05),black+.25mm,Arrows3(size=1.5mm));

          label("$\rho\sin(\varphi)\Delta\theta$",1.5*((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) + (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05)+(0,0,-.05))/2+(0,0,-.25),S);

          draw(1.5*((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) + (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05)+(0,0,-.05))/2 + (0,0,-.25) -- 1.05((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) + (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05))/2+(0,0,-.01),black+.25mm+dashed,Arrow3(size=1.5mm));

          //
          // lines for phi length
          //

          label("$\rho\Delta\varphi$",.85*(r1*cos(t1)*sin((p1+p2)/2),r1*sin(t1)*sin((p1+p2)/2),r1*cos((p1+p2)/2)));

          draw(arc((0,0,0),.95*(r1*cos(t1)*sin(p1),r1*sin(t1)*sin(p1),r1*cos(p1)),.95*(r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2))),black+.25mm,Arrows3(size=1.5mm));
        </asymptote>
      </image>
    </figure>

    <p>
      Given a region <m>D</m> in space,
      we can approximate the volume of <m>D</m> with many such wedges.
      As the size of each of <m>\Delta\rho</m>,
      <m>\Delta\theta</m> and <m>\Delta\varphi</m> goes to zero,
      the number of wedges increases to infinity and the volume of <m>D</m> is more accurately approximated, giving
      <me>
        dV = d\rho\ \times\ \rho\, d\varphi\ \times\ \rho\sin(\varphi)d\theta = \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi
      </me>.
    </p>

    <p>
      Again, this development of <m>dV</m> should sound reasonable,
      and the following theorem states it is the appropriate manner by which triple integrals are to be evaluated in spherical coordinates.
    </p>
    <aside>
      <p>
        It is generally most intuitive to evaluate the triple integral in <xref ref="thm_triple_int_spherical">Theorem</xref>
        by integrating with respect to <m>\rho</m> first;
        it often does not matter whether we next integrate with respect to <m>\theta</m> or <m>\varphi</m>.
        Different texts present different standard orders,
        some preferring <m>d\varphi\, d\theta</m> instead of <m>d\theta\, d\varphi</m>.
        As the bounds for these variables are usually constants in practice,
        it generally is a matter of preference.
      </p>
    </aside>

    <theorem xml:id="thm_triple_int_spherical">
      <title>Triple Integration in Spherical Coordinates</title>
      <statement>
        <p>
          Let <m>w=h(\rho,\theta,\varphi)</m> be a continuous function on a closed,
          bounded region <m>D</m> in space,
          bounded in spherical coordinates by <m>\alpha_1 \leq \varphi \leq \alpha_2</m>,
          <m>\beta_1 \leq \theta \leq \beta_2</m> and <m>f_1(\theta,\varphi) \leq \rho \leq f_2(\theta,\varphi)</m>.
          Then <idx><h>integration</h><h>with spherical coordinates</h></idx>
          <me>
            \iiint_D h(\rho,\theta,\varphi)\, dV = \int_{\alpha_1}^{\alpha_2}\int_{\beta_1}^{\beta_2}\int_{f_1(\theta,\varphi)}^{f_2(\theta,\varphi)} h(\rho,\theta,\varphi) \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi
          </me>.
        </p>
      </statement>
    </theorem>

    <example xml:id="ex_spherical2">
      <title>Establishing the volume of a sphere</title>
      <statement>
        <p>
          Let <m>D</m> be the region in space bounded by the sphere,
          centered at the origin, of radius <m>r</m>.
          Use a triple integral in spherical coordinates to find the volume <m>V</m> of <m>D</m>.
        </p>
      </statement>
      <solution>
        <p>
          The sphere of radius <m>r</m>,
          centered at the origin, has equation <m>\rho = r</m>.
          To obtain the full sphere,
          the bounds on <m>\theta</m> and <m>\varphi</m> are
          <m>0\leq \theta \leq 2\pi</m> and <m>0 \leq \varphi \leq \pi</m>.
          This leads us to:
          <md>
            <mrow>V \amp = \iiint_D\, dV</mrow>
            <mrow>\amp = \int_0^{\pi}\int_0^{2\pi}\int_0^r\big(\rho^2\sin(\varphi)\big)\, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \int_0^\pi\int_0^{2\pi}\left(\frac13\rho^3\sin(\varphi)\Big|_0^r\right)\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \int_0^\pi\int_0^{2\pi} \left(\frac13r^3\sin(\varphi)\right)\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \int_0^\pi \left(\frac{2\pi}3r^3\sin(\varphi)\right)\, d\varphi</mrow>
            <mrow>\amp = \left.\left(-\frac{2\pi}3r^3\cos(\varphi)\right)\right|_0^{\pi}</mrow>
            <mrow>\amp = \frac{4\pi}3r^3</mrow>
          </md>,
          the familiar formula for the volume of a sphere.
          Note how the integration steps were easy,
          not using square roots nor integration steps such as Substitution.
        </p>
      </solution>
    </example>

    <figure xml:id="vid-multint-spherical-example1">
      <caption>Setting up an integral in spherical coorindates</caption>
      <video youtube="wqjjslo0auI"/>
    </figure>

    <example xml:id="ex_spherical3">
      <title>Finding the center of mass using spherical coordinates</title>
      <statement>
        <p>
          Find the center of mass of the solid with constant density enclosed above by <m>\rho=4</m> and below by <m>\varphi = \pi/6</m>,
          as illustrated in <xref ref="fig_spherical3">Figure</xref>.
        </p>
        <figure xml:id="fig_spherical3">
          <caption>Graphing the solid, and its center of mass, from <xref ref="ex_spherical3">Example</xref></caption>
          <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
          3Droll=0,
          3Dortho=0.004498619586229324,
          3Dc2c=0.7278125882148743 0.6620227098464966 0.17892660200595856,
          3Dcoo=-23.626569747924805 -17.348602294921875 60.14314270019531,
          3Droo=150,
          3Dlights=Headlamp,add3Djscript=asylabels.js} -->
          <image xml:id="img_spherical3_3D" width="47%">
            <description></description>
            <asymptote>
              import graph3;
              //import apexstyle;


              //ASY file for figspherical1_3D.asy in Chapter 13


              size(282,282,IgnoreAspect);
              //currentprojection=perspective(7,2,1);
              currentprojection=orthographic(12,13,3);
              defaultrender.merge=true;

              // setup and draw the axes
              real[] myxchoice={2};
              real[] myychoice={2};
              real[] myzchoice={4};
              defaultpen(0.5mm);

              pair xbounds=(-2.5,2.5);
              pair ybounds=(-2.5,2.5);
              pair zbounds=(-.1,5);

              xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
              yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
              zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

              label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
              label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
              label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (t.y*cos(t.x)*sin(pi/6),t.y*sin(t.x)*sin(pi/6),t.y*cos(pi/6));//
              }
              surface s=surface(f,(0,0),(2*pi,4),16,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen p=apexmeshpen+.1mm;
              draw(s,simplesurfacepen,meshpen=p);

              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (4*cos(t.x)*sin(t.y),4*sin(t.x)*sin(t.y),4*cos(t.y));//
              }
              surface s=surface(f,(0,0),(2*pi,pi/6),16,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              draw(s,simplesurfacepen,meshpen=p);


              dot((0,0,2.799),blackmeshpen+1.2mm);


              //draw((-1.5,-1.5,2) -- (-1.5,1.5,2) -- (1.5,1.5,2) -- (1.5,-1.5,2) -- (-1.5,-1.5,2),apexmeshpen+.25mm);

              triple g(real t) {return (1.5/sqrt(3)*cos(t),1.5/sqrt(3)*sin(t),1.5);}
              path3 mypath=graph(g,0,2*pi,operator ..);
              //draw(mypath,apexmeshpen);

              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (t.x,t.x*sqrt(3),t.y);//
              }
              surface s=surface(f,(-1.25,-1.5),(1.25,1.5),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen q=redmeshpen;
              //draw(s,simplesurfacepen2,meshpen=q);

              //draw((-1.25,-1.25*sqrt(3),-1.5) -- (1.25,1.25*sqrt(3),-1.5) -- (1.25,1.25*sqrt(3),1.5) -- (-1.25,-1.25*sqrt(3),1.5) -- (-1.25,-1.25*sqrt(3),-1.5),redcurvepen+.25mm);


              //Draw the plane  z=7-2x-2y
              triple f(pair t) {
              	return (sin(t.y)*cos(t.x),sin(t.y)*sin(t.x),cos(t.y));//
              }
              surface s=surface(f,(0,0),(2*pi,pi),16,16,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
              pen q=greencurvepen;
              //draw(s,simplesurfacepen3,meshpen=q);

              //dot((.5,sqrt(3)*.5,2),rgb(.1,.1,.1));

              //draw((.5,sqrt(3)*.5,-.5)--(.5,sqrt(3)*.5,2.25));

              triple g(real t) {return (1/2*cos(t),1/2*sin(t),1/2*sqrt(3));}
              path3 mypath=graph(g,0,2*pi,operator ..);
              //draw(mypath,blackmeshpen);

              //(1.5/sqrt(3)*cos(t),1.5/sqrt(3)*sin(t),1.5)
              //draw((1.5/sqrt(3)*cos(4*pi/3),1.5/sqrt(3)*sin(4*pi/3),1.5) -- (0,0,0) -- (1.5/sqrt(3)*cos(pi/3),1.5/sqrt(3)*sin(pi/3),1.5));

              triple g(real t) {return (sin(t)*cos(pi/3),sin(t)*sin(pi/3),cos(t));}
              path3 mypath=graph(g,0,2*pi,operator ..);
              //draw(mypath,blackmeshpen);
            </asymptote>
          </image>
        </figure>
      </statement>
      <solution>
        <p>
          We will set up the four triple integrals needed to find the center of mass (<ie/>, to compute <m>M</m>,
          <m>M_{yz}</m>,
          <m>M_{xz}</m> and <m>M_{xy}</m>) and leave it to the reader to evaluate each integral.
          Because of symmetry,
          we expect the <m>x</m>- and <m>y</m>- coordinates of the center of mass to be 0.
        </p>

        <p>
          While the surfaces describing the solid are given in the statement of the problem,
          to describe the full solid <m>D</m>,
          we use the following bounds:
          <m>0 \leq \rho \leq 4</m>,
          <m>0 \leq \theta \leq 2\pi</m> and <m>0 \leq \varphi \leq \pi/6</m>.
          Since density <m>\delta</m> is constant,
          we assume <m>\delta =1</m>.
        </p>

        <p>
          The mass of the solid:
          <md>
            <mrow>M \amp = \iiint_D\, dm = \iiint_D\, dV</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4\big(\rho^2\sin(\varphi)\big)\, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \frac{64}3\big(2-\sqrt{3}\big)\pi \approx 17.958</mrow>
          </md>.
        </p>

        <p>
          To compute <m>M_{yz}</m>, the integrand is <m>x</m>;
          using <xref ref="idea_convert_coords">Key Idea</xref>,
          we have <m>x = \rho\sin(\varphi)\cos(\theta)</m>.
          This gives:
          <md>
            <mrow>M_{yz} \amp = \iiint_D x\, dm</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big((\rho\sin(\varphi)\cos(\theta))\rho^2\sin(\varphi)\big) \, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big(\rho^3\sin^2(\varphi)\cos(\theta)\big) \, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp =0</mrow>
          </md>,
          which we expected as we expect <m>\overline{x} = 0</m>.
        </p>

        <p>
          To compute <m>M_{xz}</m>, the integrand is <m>y</m>;
          using <xref ref="idea_convert_coords">Key Idea</xref>,
          we have <m>y = \rho\sin(\varphi)\sin(\theta)</m>.
          This gives:
          <md>
            <mrow>M_{xz} \amp = \iiint_D y\, dm</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big((\rho\sin(\varphi)\sin(\theta))\rho^2\sin(\varphi)\big) \, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big(\rho^3\sin^2(\varphi)\sin(\theta)\big) \, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp =0</mrow>
          </md>,
          which we also expected as we expect <m>\overline{y} = 0</m>.
        </p>

        <p>
          To compute <m>M_{xy}</m>, the integrand is <m>z</m>;
          using <xref ref="idea_convert_coords">Key Idea</xref>,
          we have <m>z = \rho\cos(\varphi)</m>.
          This gives:
          <md>
            <mrow>M_{xy} \amp = \iiint_D z\, dm</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big((\rho\cos(\varphi))\rho^2\sin(\varphi)\big) \, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp = \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big(\rho^3\cos(\varphi)\sin(\varphi)\big) \, d\rho\, d\theta\, d\varphi</mrow>
            <mrow>\amp =16\pi \approx 50.266</mrow>
          </md>.
        </p>

        <p>
          Thus the center of mass is <m>(0,0,M_{xy}/M) \approx (0,0,2.799)</m>,
          as indicated in <xref ref="fig_spherical3">Figure</xref>.
        </p>
      </solution>
    </example>

    <figure xml:id="vid-multint-spherical-examples">
      <caption>Two more spherical coordinate examples</caption>
      <video youtube="jwzvDiiM94o EKxY_5PlgTU"/>
    </figure>

    <p>
      This section has provided a brief introduction into two new coordinate systems useful for identifying points in space.
      Each can be used to define a variety of surfaces in space beyond the canonical surfaces graphed as each system was introduced.
    </p>

    <p>
      However, the usefulness of these coordinate systems does not lie in the variety of surfaces that they can describe nor the regions in space these surfaces may enclose.
      Rather, cylindrical coordinates are mostly used to describe cylinders and spherical coordinates are mostly used to describe spheres.
      These shapes are of special interest in the sciences, especially in physics,
      and computations on/inside these shapes is difficult using rectangular coordinates.
      For instance, in the study of electricity and magnetism,
      one often studies the effects of an electrical current passing through a wire;
      that wire is essentially a cylinder,
      described well by cylindrical coordinates.
    </p>

    <p>
      This chapter investigated the natural follow-on to partial derivatives:
      iterated integration.
      We learned how to use the bounds of a double integral to describe a region in the plane using both rectangular and polar coordinates,
      then later expanded to use the bounds of a triple integral to describe a region in space.
      We used double integrals to find volumes under surfaces,
      surface area,
      and the center of mass of lamina;
      we used triple integrals as an alternate method of finding volumes of space regions and also to find the center of mass of a region in space.
    </p>

    <p>
      Integration does not stop here.
      We could continue to iterate our integrals,
      next investigating <q>quadruple integrals</q>
      whose bounds describe a region in 4-dimensional space
      (which are very hard to visualize).
      We can also look back to <q>regular</q>
      integration where we found the area under a curve in the plane.
      A natural analogue to this is finding the
      <q>area under a curve,</q>
      where the curve is in space, not in a plane.
      These are just two of many avenues to explore under the heading of <q>integration.</q>
    </p>
  </subsection>

  <exercises>
    <exercisegroup>
      <introduction>
        <p>
          Terms and Concepts
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
            Explain the difference between the roles <m>r</m>,
            in cylindrical coordinates, and <m>\rho</m>,
            in spherical coordinates, play in determining the location of a point.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical,
            <m>r</m> determines how far from the origin one goes in the <m>xy</m>-plane before considering the <m>z</m>-component.
            Equivalently,
            if on projects a point in cylindrical coordinates onto the <m>xy</m>-plane,
            <m>r</m> will be the distance of this projection from the origin.
          </p>

          <p>
            In spherical,
            <m>\rho</m> is the distance from the origin to the point.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            Why are points on the <m>z</m>-axis not determined uniquely when using cylindrical and spherical coordinates?
          </p>
        </statement>
        <solution>
          <p>
            If <m>r=0</m> or <m>\rho=0</m>,
            then the point in each coordinate system lies on the <m>z</m>-axis regardless of the value of <m>\theta</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            What surfaces are naturally defined using cylindrical coordinates?
          </p>
        </statement>
        <solution>
          <p>
            Cylinders (tubes) centered at the origin,
            parallel to the <m>z</m>-axis;
            planes parallel to the <m>z</m>-axis that intersect the <m>z</m>-axis;
            planes parallel to the <m>xy</m>-plane.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            What surfaces are naturally defined using spherical coordinates?
          </p>
        </statement>
        <solution>
          <p>
            Spheres centered at the origin;
            planes parallel to the <m>z</m>-axis that intersect the <m>z</m>-axis;
            cones centered on the <m>z</m>-axis with point at the origin.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          points are given in either the rectangular,
          cylindrical or spherical coordinate systems.
          Find the coordinates of the points in the other systems.
        </p>
      </introduction>

      <exercise>
        <statement>
          <p>
            <ol>
              <li>
                <p>
                  Points in rectangular coordinates:
                  <m>(2,2,1)</m> and <m>(-\sqrt{3},1,0)</m>
                </p>
              </li>

              <li>
                <p>
                  Points in cylindrical coordinates:
                  <m>(2,\pi/4,2)</m> and <m>(3,3\pi/2,-4)</m>
                </p>
              </li>

              <li>
                <p>
                  Points in spherical coordinates:
                  <m>(2,\pi/4,\pi/4)</m> and <m>(1,0,0)</m>
                </p>
              </li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            <ol>
              <li>
                <p>
                  Cylindrical:
                  <m>(2\sqrt 2,\pi/4,1)</m> and <m>(2,5\pi/6,0)</m> Spherical:
                  <m>(3,\pi/4,\cos^{-1}(1/3))</m> and <m>(2,5\pi/6,\pi/2)</m>
                </p>
              </li>

              <li>
                <p>
                  Rectangular:
                  <m>(\sqrt 2,\sqrt 2,2)</m> and <m>(0,-3,-4)</m> Spherical:
                  <m>(2\sqrt 2,\pi/4,\pi/4)</m> and <m>(5,3\pi/2,\pi-\tan^{-1}(3/4))</m>
                </p>
              </li>

              <li>
                <p>
                  Rectangular:
                  <m>(1,1,\sqrt{2})</m> and <m>(0,0,1)</m> Cylindrical:
                  <m>(\sqrt{2},\pi/4,\sqrt{2})</m> and <m>(0,0,1)</m>
                </p>
              </li>
            </ol>
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <ol>
              <li>
                <p>
                  Points in rectangular coordinates:
                  <m>(0,1,1)</m> and <m>(-1,0,1)</m>
                </p>
              </li>

              <li>
                <p>
                  Points in cylindrical coordinates:
                  <m>(0,\pi,1)</m> and <m>(2,4\pi/3,0)</m>
                </p>
              </li>

              <li>
                <p>
                  Points in spherical coordinates:
                  <m>(2,\pi/6,\pi/2)</m> and <m>(3,\pi,\pi)</m>
                </p>
              </li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            <ol>
              <li>
                <p>
                  Cylindrical: <m>(1,\pi/2,1)</m> and <m>(1,\pi,1)</m> Spherical:
                  <m>(\sqrt 2,\pi/2,\pi/4)</m> and <m>(\sqrt{2}, \pi, \pi/4)</m>
                </p>
              </li>

              <li>
                <p>
                  Rectangular:
                  <m>(0,0,1)</m> and <m>(-1,-\sqrt 3,0)</m> Spherical:
                  <m>(1,\pi,0)</m> and <m>(2,4\pi/3,\pi/2)</m>
                </p>
              </li>

              <li>
                <p>
                  Rectangular:
                  <m>(\sqrt 3,1,0)</m> and <m>(0,0,-3)</m> Cylindrical:
                  <m>(2,\pi/6,0)</m> and <m>(0,\pi,-3)</m>
                </p>
              </li>
            </ol>
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises, describe the curve,
          surface or region in space determined by the given bounds.
        </p>
      </introduction>

      <exercise>
        <statement>
          <p>
            Bounds in cylindrical coordinates:
            <ol>
              <li>
                <p>
                  <m>r=1</m>, <m>0\leq \theta\leq 2\pi</m>, <m>0\leq z\leq 1</m>
                </p>
              </li>

              <li>
                <p>
                  <m>1\leq r\leq 2</m>, <m>0\leq \theta\leq \pi</m>, <m>0\leq z\leq 1</m>
                </p>
              </li>
            </ol>
          </p>

          <p>
            Bounds in spherical coordinates:
            <ol>
              <li>
                <p>
                  <m>\rho=3</m>, <m>0\leq \theta\leq2\pi</m>,
                  <m>0\leq\varphi\leq \pi/2</m>
                </p>
              </li>

              <li>
                <p>
                  <m>2\leq\rho\leq3</m>, <m>0\leq \theta\leq2\pi</m>,
                  <m>0\leq\varphi\leq \pi</m>
                </p>
              </li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            <ol>
              <li>
                <p>
                  A cylindrical surface or tube,
                  centered along the <m>z</m>-axis of radius 1, extending from the <m>xy</m>-plane up to the plane <m>z=1</m> (<ie/>, the tube has a length of 1).
                </p>
              </li>

              <li>
                <p>
                  This is a region of space,
                  being half of a tube with <q>thick</q>
                  walls of inner radius 1 and outer radius 2, centered along the <m>z</m>-axis with a length of 1, where the half <q>below</q>
                  the <m>xz</m>-plane is removed.
                </p>
              </li>

              <li>
                <p>
                  This is upper half of the sphere of radius 3 centered at the origin (<ie/>, the upper hemisphere).
                </p>
              </li>

              <li>
                <p>
                  This is a region of space,
                  where the ball of radius 2, centered at the origin,
                  is removed from the ball of radius 3, centered at the origin.
                </p>
              </li>
            </ol>
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            Bounds in cylindrical coordinates:
            <ol>
              <li>
                <p>
                  <m>1\leq r\leq 2</m>, <m>\theta= \pi/2</m>, <m>0\leq z\leq 1</m>
                </p>
              </li>

              <li>
                <p>
                  <m>r= 2</m>, <m>0\leq \theta\leq 2\pi</m>, <m>z=5</m>
                </p>
              </li>
            </ol>
          </p>

          <p>
            Bounds in spherical coordinates:
            <ol>
              <li>
                <p>
                  <m>0\leq\rho\leq2</m>, <m>0\leq \theta\leq\pi</m>, <m>\varphi = \pi/4</m>
                </p>
              </li>

              <li>
                <p>
                  <m>\rho=2</m>,
                  <m>0\leq \theta\leq2\pi</m>, <m>\varphi = \pi/6</m>
                </p>
              </li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            <ol>
              <li>
                <p>
                  A square portion of the <m>yz</m>-plane with corners at <m>(0,1,0)</m>,
                  <m>(0,1,1)</m>,
                  <m>(0,2,1)</m> and <m>(0,2,0)</m>.
                </p>
              </li>

              <li>
                <p>
                  This is a curve, a circle of radius 2, centered at <m>(0,0,5)</m>,
                  lying parallel to the <m>xy</m>-plane (<ie/>, in the plane <m>z=5</m>).
                </p>
              </li>

              <li>
                <p>
                  This is a region of space, a half of a solid cone with rounded top,
                  where the rounded top is a portion of the ball of radius 2 centered at the origin and the sides of the cone make an angle of <m>\pi/4</m> with the positive <m>z</m>-axis.
                  The bounds on <m>\theta</m> mean only the portion <q>above</q>
                  the <m>xz</m>-plane are retained.
                </p>
              </li>

              <li>
                <p>
                  This is a curve,
                  a circle of radius 1 centered at <m>(0,0,\sqrt 3)</m>,
                  lying parallel to the <m>xy</m>-plane.
                </p>
              </li>
            </ol>
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises, standard regions in space,
          as defined by cylindrical and spherical coordinates, are shown.
          Set up the triple integral that integrates the given function over the graphed region.
        </p>
      </introduction>


      <exercise>
        <statement>
          <p>
            Cylindrical coordinates, integrating <m>h(r,\theta,z)</m>:
          </p>

          <sidebyside width="47%">
            <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
            3Droll=0, 3Dortho=0.004999519791454077, 3Dc2c=0.6666666865348816 0.6666666865348816 0.3333333134651184,
            3Dcoo=-11.596293449401855 -12.679614067077637 48.551517486572266, 3Droo=149.9999987284343,
            3Dlights=Headlamp,add3Djscript=asylabels.js} -->
            <image xml:id="img_13_07_ex_09_3D">
              <description></description>
              <asymptote>
                import graph3;
                //import apexstyle;


                //ASY file for figspherical1_3D.asy in Chapter 13


                size(282,282,IgnoreAspect);
                //currentprojection=perspective(7,2,1);
                currentprojection=orthographic(16.5,1,4.8);
                defaultrender.merge=true;

                // setup and draw the axes
                real[] myxchoice={};
                real[] myychoice={};
                real[] myzchoice={};
                defaultpen(0.5mm);

                pair xbounds=(-1.1,1.1);
                pair ybounds=(-1.1,1.1);
                pair zbounds=(-.1,1.1);

                xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));

                real r1=.4;
                real r2=.6;
                real t1=pi/6;
                real t2=4pi/3;
                real z1=.4;
                real z2=.8;

                // (t.x*cos(t.y),t.x*sin(t.y),z)
                //Draw the plane  z=7-2x-2y
                triple f(pair t) {
                	return (r1*cos(t.y),r1*sin(t.y),t.x);//
                }
                surface s=surface(f,(z1,t1),(z2,t2),4,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                pen p=apexmeshpen+.1mm;
                draw(s,simplesurfacepen,meshpen=p);

                triple f(pair t) {
                	return (r2*cos(t.y),r2*sin(t.y),t.x);//
                }
                surface s=surface(f,(z1,t1),(z2,t2),4,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);

                triple f(pair t) {
                	return (t.x*cos(t1),t.x*sin(t1),t.y);//
                }
                surface s=surface(f,(r1,z1),(r2,z2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);

                triple f(pair t) {
                	return (t.x*cos(t2),t.x*sin(t2),t.y);//
                }
                surface s=surface(f,(r1,z1),(r2,z2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);

                triple f(pair t) {
                	return (t.x*cos(t.y),t.x*sin(t.y),z1);//
                }
                surface s=surface(f,(r1,t1),(r2,t2),4,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);

                triple f(pair t) {
                	return (t.x*cos(t.y),t.x*sin(t.y),z2);//
                }
                surface s=surface(f,(r1,t1),(r2,t2),4,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);


                draw((0,0,0) -- .8*(cos(t1),sin(t1),0),dashed+.25mm);
                draw((0,0,0) -- .8*(cos(t2),sin(t2),0),dashed+.25mm);

                draw(arc((0,0,0),.3*(1,0,0),.3*(cos(t2),sin(t2),0),(0,0,1)),black+.25mm,Arrow3(size=2mm));
                draw(arc((0,0,0),.5*(1,0,0),.3*(cos(t1),sin(t1),0),(0,0,1)),black+.25mm,Arrow3(size=2mm));

                label("$\theta_1$",.6(cos(t1/2),sin(t1/2),-.05));
                label("$\theta_2$",.5(cos(t2/1.5),sin(t2/1.5),0));

                draw ((r2*cos(t2),r2*sin(t2),z1) -- (r2*cos(t2),r2*sin(t2),0),dashed+.25mm);
                draw ((r2*cos(t1),r2*sin(t1),z1) -- (r2*cos(t1),r2*sin(t1),0),dashed+.25mm);

                draw ((0,0,z2) -- (r2*cos(t2/1.5),r2*sin(t2/1.5),z2),dashed+.25mm);
                draw ((0,0,z2) -- (r1*cos(t2/3),r1*sin(t2/3),z2),dashed+.25mm);


                label("$r_2$",(r2*.95*cos(t2/1.5),r2*.95*sin(t2/1.5),z2+.05));
                label("$r_1$",(r1*.8*cos(t2/3),r1*.8*sin(t2/3),z2+.05));


                draw((0,0,z1) -- (r1*cos(t1),r1*sin(t1),z1),dashed+.25mm);
                draw((0,0,z2) -- (r1*cos(t1),r1*sin(t1),z2),dashed+.25mm);

                label("$z_1$",(0,0,z1),W);
                label("$z_2$",(0,0,z2),W);




                //dot((0,0,2.799),blackmeshpen+1.2mm);








                //draw((-1.5,-1.5,2) -- (-1.5,1.5,2) -- (1.5,1.5,2) -- (1.5,-1.5,2) -- (-1.5,-1.5,2),apexmeshpen+.25mm);

                triple g(real t) {return (1.5/sqrt(3)*cos(t),1.5/sqrt(3)*sin(t),1.5);}
                path3 mypath=graph(g,0,2*pi,operator ..);
                //draw(mypath,apexmeshpen);

                //Draw the plane  z=7-2x-2y
                triple f(pair t) {
                	return (t.x,t.x*sqrt(3),t.y);//
                }
                surface s=surface(f,(-1.25,-1.5),(1.25,1.5),8,8,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                pen q=redmeshpen;
                //draw(s,simplesurfacepen2,meshpen=q);

                //draw((-1.25,-1.25*sqrt(3),-1.5) -- (1.25,1.25*sqrt(3),-1.5) -- (1.25,1.25*sqrt(3),1.5) -- (-1.25,-1.25*sqrt(3),1.5) -- (-1.25,-1.25*sqrt(3),-1.5),redcurvepen+.25mm);


                //Draw the plane  z=7-2x-2y
                triple f(pair t) {
                	return (sin(t.y)*cos(t.x),sin(t.y)*sin(t.x),cos(t.y));//
                }
                surface s=surface(f,(0,0),(2*pi,pi),16,16,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                pen q=greencurvepen;
                //draw(s,simplesurfacepen3,meshpen=q);

                //dot((.5,sqrt(3)*.5,2),rgb(.1,.1,.1));

                //draw((.5,sqrt(3)*.5,-.5)--(.5,sqrt(3)*.5,2.25));

                triple g(real t) {return (1/2*cos(t),1/2*sin(t),1/2*sqrt(3));}
                path3 mypath=graph(g,0,2*pi,operator ..);
                //draw(mypath,blackmeshpen);

                //(1.5/sqrt(3)*cos(t),1.5/sqrt(3)*sin(t),1.5)
                //draw((1.5/sqrt(3)*cos(4*pi/3),1.5/sqrt(3)*sin(4*pi/3),1.5) -- (0,0,0) -- (1.5/sqrt(3)*cos(pi/3),1.5/sqrt(3)*sin(pi/3),1.5));

                triple g(real t) {return (sin(t)*cos(pi/3),sin(t)*sin(pi/3),cos(t));}
                path3 mypath=graph(g,0,2*pi,operator ..);
                //draw(mypath,blackmeshpen);





                //draw(s,emissive(gray+opacity(.3)),meshpen=invisible);


                //draw(s,simplesurfacepen,meshpen=apexmeshpen);



                //label("$\varphi=\frac{\pi}{6}$",(1.5/sqrt(3)*cos(2pi/3),1.5/sqrt(3)*sin(2pi/3),1.5),E);
                //label("$\rho=1$",(1.1*cos(pi/6),1.1*sin(pi/6),-.5));
                //label("$\theta=\frac{\pi}{3}$",(1.25,1.25*sqrt(3),1));

                //draw((0,1,0)--(0,3,0)--(3,1,0)--cycle,curvepen);
              </asymptote>
            </image>
          </sidebyside>
        </statement>
        <answer>
          <p>
            <m>\ds\int_{\theta_1}^{\theta_2}\int_{r_1}^{r_2}\int_{z_1}^{z_2}h(r,\theta,z)r\, dz\, dr\, d\theta</m>
          </p>
        </answer>
      </exercise>

      <exercise>
        <statement>
          <p>
            Cylindrical coordinates, integrating <m>h(\rho,\theta,\varphi)</m>:
          </p>

          <sidebyside width="47%">
            <!-- \apexincludemedia{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
            3Droll=0, 3Dortho=0.004999519791454077, 3Dc2c=0.6666666865348816 0.6666666865348816 0.3333333134651184,
            3Dcoo=-11.596293449401855 -12.679614067077637 48.551517486572266, 3Droo=149.9999987284343,
            3Dlights=Headlamp,add3Djscript=asylabels.js} -->
            <image xml:id="img_13_07_ex_10_3D">
              <description></description>
              <asymptote>
                import graph3;
                //import apexstyle;


                //ASY file for figspherical1_3D.asy in Chapter 13


                size(282,282,IgnoreAspect);
                //currentprojection=perspective(7,2,1);
                currentprojection=orthographic(16,.9,8.1);
                defaultrender.merge=true;

                // setup and draw the axes
                real[] myxchoice={};
                real[] myychoice={};
                real[] myzchoice={};
                defaultpen(0.5mm);

                pair xbounds=(-.6,.6);
                pair ybounds=(-.6,.6);
                pair zbounds=(-.1,1);

                xaxis3("",xbounds.x,xbounds.y,black,OutTicks(myxchoice),Arrow3(size=3mm));
                yaxis3("",ybounds.x,ybounds.y,black,OutTicks(myychoice),Arrow3(size=3mm));
                zaxis3("",zbounds.x,zbounds.y,black,OutTicks(myzchoice),Arrow3(size=3mm));

                label("$x$",(xbounds.y+0.05*(xbounds.y-xbounds.x),0,0));
                label("$y$",(0,ybounds.y+0.05*(ybounds.y-ybounds.x),0));
                label("$z$",(0,0,zbounds.y+0.05*(zbounds.y-zbounds.x)));


                real t1=pi/3;
                real t2=7pi/6;
                real p1=pi/6-.2;
                real p2=pi/6+.2;
                real r1=.75;
                real r2=.9;



                //Draw the plane  z=7-2x-2y
                triple f(pair t) {
                	return (r1*cos(t.x)*sin(t.y),r1*sin(t.x)*sin(t.y),r1*cos(t.y));//
                }
                surface s=surface(f,(t1,p1),(t2,p2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                pen p=apexmeshpen+.1mm;
                draw(s,simplesurfacepen,meshpen=p);


                triple f(pair t) {
                	return (r2*cos(t.x)*sin(t.y),r2*sin(t.x)*sin(t.y),r2*cos(t.y));//
                }
                surface s=surface(f,(t1,p1),(t2,p2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);


                triple f(pair t) {
                	return (t.y*cos(t.x)*sin(p1),t.y*sin(t.x)*sin(p1),t.y*cos(p1));//
                }
                surface s=surface(f,(t1,r1),(t2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);


                triple f(pair t) {
                	return (t.y*cos(t.x)*sin(p2),t.y*sin(t.x)*sin(p2),t.y*cos(p2));//
                }
                surface s=surface(f,(t1,r1),(t2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);


                triple f(pair t) {
                	return (t.y*cos(t1)*sin(t.x),t.y*sin(t1)*sin(t.x),t.y*cos(t.x));//
                }
                surface s=surface(f,(p1,r1),(p2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);


                triple f(pair t) {
                	return (t.y*cos(t2)*sin(t.x),t.y*sin(t2)*sin(t.x),t.y*cos(t.x));//
                }
                surface s=surface(f,(p1,r1),(p2,r2),4,4,usplinetype=new splinetype[] {notaknot,notaknot,monotonic},vsplinetype=new splinetype[] {notaknot,notaknot,monotonic});
                draw(s,simplesurfacepen,meshpen=p);


                //
                // lines for phi
                //
                draw((r1*cos(t1)*sin(p1),r1*sin(t1)*sin(p1),r1*cos(p1)) -- (0,0,0) -- (r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)),black+.25mm+dashed);

                //draw(arc((0,0,0),(r1*cos(t1)*sin(p1)/2.5,r1*sin(t1)*sin(p1)/2.5,r1*cos(p1)/2.5),(r1*cos(t1)*sin(p2)/2.5,r1*sin(t1)*sin(p2)/2.5,r1*cos(p2)/2.5)),black+.25mm,Arrow3(size=1.5mm));

                //label("$\Delta\varphi$",.95*(r1*cos(t1)*sin((p1+p2)/2)/2,r1*sin(t1)*sin((p1+p2)/2)/2,r1*cos((p1+p2)/2)/2));



                //
                //  lines for theta
                //

                draw((0,0,0) -- (r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),0),black+.25mm+dashed);

                draw((0,0,0) -- (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),0),black+.25mm+dashed);

                draw(arc((0,0,0),.25*(r1,0,0),.5*(r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),0)),black+.25mm,Arrow3(size=1.5mm));

                draw(arc((0,0,0),.4*(r1,0,0),.4*(r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),0),(0,0,1)),black+.25mm,Arrow3(size=1.5mm));

                label("$\theta_1$",.25*(r1*cos(t1/2)*sin(p2),r1*sin(t1/2)*sin(p2),0));
                label("$\theta_2$",.5*(r1*cos(t2/2)*sin(p2),r1*sin(t2/2)*sin(p2),0));

                //
                // lines for rho
                //

                draw(arc((0,0,0),(r1*cos(t1)*sin(0),r1*sin(t1)*sin(0),r1*cos(0)),(r1*cos(t1)*sin(p1),r1*sin(t1)*sin(p1),r1*cos(p1))),black+.25mm+dashed);

                draw(arc((0,0,0),(r2*cos(t1)*sin(0),r2*sin(t1)*sin(0),r2*cos(0)),(r2*cos(t1)*sin(p1),r2*sin(t1)*sin(p1),r2*cos(p1))),black+.25mm+dashed);


                label("$\rho_1$",(0,0,r1),W);
                label("$\rho_2$",(0,0,r2),W);

                real poff = -0.05;

                //draw((r1*cos(t1)*sin(p1+poff),r1*sin(t1)*sin(p1+poff),r1*cos(p1+poff)) -- (r2*cos(t1)*sin(p1+poff),r2*sin(t1)*sin(p1+poff),r2*cos(p1+poff)),black+.25mm,Arrows3(size=1.5mm));

                //label("$\rho$",(0,-.04,.5*r1));

                //draw((0,-.02,.01) -- (0,-.02,.99*r1),black+.25mm,Arrows3(size=1.5mm));


                //
                //  lines for theta length
                //

                //draw((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) -- (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05),black+.25mm,Arrows3(size=1.5mm));

                //label("$\rho\sin(\varphi)\Delta\theta$",1.5*((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) + (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05)+(0,0,-.05))/2+(0,0,-.25),S);

                //draw(1.5*((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) + (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05)+(0,0,-.05))/2 + (0,0,-.25) -- 1.05((r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2)-.05) + (r1*cos(t2)*sin(p2),r1*sin(t2)*sin(p2),r1*cos(p2)-.05))/2+(0,0,-.01),black+.25mm+dashed,Arrow3(size=1.5mm));

                //
                // lines for phi length
                //



                draw(arc((0,0,0),.9*(0,0,r1),.95*(r1*cos(t1)*sin(p1),r1*sin(t1)*sin(p1),r1*cos(p1))),black+.25mm,Arrows3(size=1.5mm));
                label("$\varphi_1$",.9*(r1*cos(t1)*sin(p1/2),r1*sin(t1)*sin(p1/2),r1*cos(p1/2)),S);


                label("$\varphi_2$",.68*(r1*cos(t1)*sin(p1+(p2-p1)/2),r1*sin(t1)*sin(p1+(p2-p1)/2),r1*cos(p1+(p2-p1)/2)),S);
                draw(arc((0,0,0),.7*(0,0,r1),.7*(r1*cos(t1)*sin(p2),r1*sin(t1)*sin(p2),r1*cos(p2))),black+.25mm,Arrows3(size=1.5mm));
              </asymptote>
            </image>
          </sidebyside>
        </statement>
        <answer>
          <p>
            <m>\ds\int_{\varphi_1}^{\varphi_2}\int_{\theta_1}^{\theta_2}\int_{\rho_1}^{\rho_2}h(\rho,\theta,\varphi)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </answer>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          a triple integral in cylindrical coordinates is given.
          Describe the region in space defined by the bounds of the integral.
        </p>
      </introduction>


      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{\pi/2}\int_0^2\int_0^2 r\, dz\, dr\, d\theta</m>
          </p>
        </statement>
        <solution>
          <p>
            The region in space is bounded between the planes <m>z=0</m> and <m>z=2</m>,
            inside of the cylinder <m>x^2+y^2=4</m>,
            and the planes <m>\theta = 0</m> and <m>\theta = \pi/2</m>:
            describes a <q>wedge</q> of a cylinder of height 2 and radius 2;
            the angle of the wedge is <m>\pi/2</m>, or <m>90^\circ</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_3^4\int_0^5 r\, dz\, dr\, d\theta</m>
          </p>
        </statement>
        <solution>
          <p>
            Bounded between the planes <m>z=0</m> and <m>z=5</m>,
            between the cylinders <m>x^2+y^2=9</m> and <m>x^2+y^2=16</m>:
            describes a <q>pipe</q> or <q>tube</q>
            of length 5, an inner radius of 3 and outer radius of 4.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_0^1\int_0^{1-r} r\, dz\, dr\, d\theta</m>
          </p>
        </statement>
        <solution>
          <p>
            Bounded between the plane <m>z=1</m> and the cone <m>z=1-\sqrt{x^2+y^2}</m>:
            describes an inverted cone,
            with height of 1, point at <m>(0,0,1)</m> and base radius of 1.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{\pi}\int_0^1\int_0^{2-r} r\, dz\, dr\, d\theta</m>
          </p>
        </statement>
        <solution>
          <p>
            Bounded between <m>y\geq 0</m>,
            inside the cylinder <m>x^2+y^2=1</m>,
            above the plane <m>z=0</m> and below the cone <m>z = 2-\sqrt{x^2+y^2}</m>:
            describes cylindrical solid of height 1 and radius 2, topped with an inverted cone of height 1 and base radius 1 with point at <m>(0,0,2)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{\pi}\int_0^3\int_0^{\sqrt{9-r^2}} r\, dz\, dr\, d\theta</m>
          </p>
        </statement>
        <solution>
          <p>
            Describes a quarter of a ball of radius 3, centered at the origin;
            the quarter resides above the <m>xy</m>-plane and above the <m>xz</m>-plane.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_0^a\int_0^{\sqrt{a^2-r^2}+b} r\, dz\, dr\, d\theta</m>
          </p>
        </statement>
        <solution>
          <p>
            Bounded between the plane <m>z=0</m>,
            inside the cylinder <m>x^2+y^2 = a^2</m>,
            and below the upper hemisphere <m>z= \sqrt{a^2-x^2-y^2}+b</m>,
            with radius <m>a</m> and centered at <m>(0,0,b)</m>:
            describes a cylindrical solid of radius <m>a</m> and height <m>b</m>,
            topped with the upper hemisphere of radius <m>a</m>.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          a triple integral in spherical coordinates is given.
          Describe the region in space defined by the bounds of the integral.
        </p>
      </introduction>


      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{\pi/2}\int_0^{\pi}\int_0^{1} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </statement>
        <answer>
          <p>
            Describes the portion of the unit ball that resides in the first octant.
          </p>
        </answer>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{\pi}\int_0^{\pi}\int_1^{1.1} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </statement>
        <answer>
          <p>
            Describes half of a spherical shell (<ie/>, <m>y\geq 0</m>) with inner radius of <m>1</m> and outer radius of <m>1.1</m> centered at the origin.
          </p>
        </answer>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_0^{\pi/4}\int_0^{2} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </statement>
        <solution>
          <p>
            Bounded above the cone <m>z=\sqrt{x^2+y^2}</m> and below the sphere <m>x^2+y^2+z^2=4</m>:
            describes a shape that is somewhat <q>diamond</q>-like;
            some think of it as looking like an ice cream cone
            (see <xref ref="fig_spherical3">Figure</xref>).
            It describes a cone,
            where the side makes an angle of <m>\pi/4</m> with the positive <m>z</m>-axis,
            topped by the portion of the ball of radius 2, centered at the origin.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_{\pi/6}^{\pi/4}\int_0^{2} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </statement>
        <solution>
          <p>
            It is the region is space bounded below by
            <m>z=\sqrt{x^2+y^2}</m> and above by the sphere <m>x^2+y^2+z^2=4</m>,
            with the portion above the cone <m>z=\sqrt3\sqrt{x^2+y^2}</m> removed:
            it describes a cone,
            where the side makes an angle of <m>\pi/4</m> with the positive <m>z</m>-axis,
            topped by the portion of the ball of radius 2, centered at the origin,
            with the inner cone with angle <m>\pi/6</m> removed,
            along with corresponding portion of the ball of radius 2.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_{0}^{\pi/6}\int_0^{\sec(\varphi)} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </statement>
        <solution>
          <p>
            The region in space is bounded below by the cone
            <m>z=\sqrt{3}\sqrt{x^2+y^2}</m> and above by the plane <m>z=1</m>:
            it describes a cone, with point at the origin,
            centered along the positive <m>z</m>-axis,
            with height of 1 and base radius of <m>\tan(\pi/6) = 1/\sqrt{3}</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            <m>\ds \int_0^{2\pi}\int_{0}^{\pi/6}\int_0^{a\sec(\varphi)} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>
        </statement>
        <solution>
          <p>
            The region in space is bounded below by the cone
            <m>z=\sqrt{3}\sqrt{x^2+y^2}</m> and above by the plane <m>z=a</m>:
            it describes a cone, with point at the origin,
            centered along the positive <m>z</m>-axis,
            with height of <m>a</m> and base radius of <m>a\tan(\pi/6)</m>.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          a solid is described along with its density function.
          Find the mass of the solid using cylindrical coordinates.
        </p>
      </introduction>

      <exercise xml:id="ex_13_07_ex_23">
        <statement>
          <p>
            Bounded by the cylinder <m>x^2+y^2=4</m> and the planes <m>z=0</m> and <m>z=4</m> with density function <m>\delta(x,y,z) =\sqrt{x^2+y^2}+1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = r+1</m>.
            Thus mass is
            <me>
              \int_0^{2\pi}\int_0^2\int_0^4 (r+1)r\, dz\, dr\, d\theta = 112\pi/3
            </me>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            Bounded by the cylinders <m>x^2+y^2=4</m> and <m>x^2+y^2=9</m>,
            between the planes <m>z=0</m> and <m>z=10</m> with density function <m>\delta(x,y,z) =z</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = z</m>.
            Thus mass is
            <me>
              \int_0^{2\pi}\int_2^3\int_0^{10} zr\, dz\, dr\, d\theta = 250\pi
            </me>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            Bounded by <m>y\geq 0</m>, the cylinder <m>x^2+y^2=1</m>,
            and between the planes <m>z=0</m> and <m>z=4-y</m> with density function <m>\delta(x,y,z) =1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = 1</m>.
            Thus mass is
            <me>
              \int_0^{\pi}\int_0^1\int_0^{4-r\sin(\theta)} r\, dz\, dr\, d\theta = 2\pi-2/3\approx 5.617
            </me>.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex_13_07_ex_26">
        <statement>
          <p>
            The upper half of the unit ball,
            bounded between <m>z= 0</m> and <m>z=\sqrt{1-x^2-y^2}</m>,
            with density function <m>\delta(x,y,z) =1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = 1</m>.
            Thus mass is
            <me>
              \int_0^{2\pi}\int_0^1\int_{-\sqrt{1-r^2}}^{\sqrt{1-r^2}} r\, dz\, dr\, d\theta = 4\pi/3
            </me>.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          a solid is described along with its density function.
          Find the center of mass of the solid using cylindrical coordinates.
          (Note: these are the same solids and density functions as found in <xref ref="ex_13_07_ex_23">Exercises</xref>
          through <xref ref="ex_13_07_ex_26"></xref>.)
        </p>
      </introduction>

      <exercise>
        <statement>
          <p>
            Bounded by the cylinder <m>x^2+y^2=4</m> and the planes <m>z=0</m> and <m>z=4</m> with density function <m>\delta(x,y,z) =\sqrt{x^2+y^2}+1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = r+1</m>.
            Thus mass is
            <me>
              M=\int_0^{2\pi}\int_0^2\int_0^4 (r+1)r\, dz\, dr\, d\theta = 112\pi/3
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>, <m>M_{xz} = 0</m>,
            and <m>M_{xy} = 224\pi/3</m>,
            placing the center of mass at <m>(0,0,2)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            Bounded by the cylinders <m>x^2+y^2=4</m> and <m>x^2+y^2=9</m>,
            between the planes <m>z=0</m> and <m>z=10</m> with density function <m>\delta(x,y,z) =z</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = z</m>.
            Thus mass is
            <me>
              M=\int_0^{2\pi}\int_2^3\int_0^{10} zr\, dz\, dr\, d\theta = 250\pi
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>, <m>M_{xz} = 0</m>,
            and <m>M_{xy} = 5000\pi/3</m>,
            placing the center of mass at <m>(0,0,20/3)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            Bounded by <m>y\geq 0</m>, the cylinder <m>x^2+y^2=1</m>,
            and between the planes <m>z=0</m> and <m>z=4-y</m> with density function <m>\delta(x,y,z) =1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = 1</m>.
            Thus mass is
            <me>
              \int_0^{\pi}\int_0^1\int_0^{4-r\sin(\theta)} r\, dz\, dr\, d\theta = 2\pi-2/3\approx 5.617
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>,
            <m>M_{xz} = 8/3-\pi/8</m>, and <m>M_{xy} = 65\pi/16-8/3</m>,
            placing the center of mass at <m>\approx (0,0.405,1.80)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The upper half of the unit ball,
            bounded between <m>z= 0</m> and <m>z=\sqrt{1-x^2-y^2}</m>,
            with density function <m>\delta(x,y,z) =1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In cylindrical coordinates, the density is <m>\delta(r,\theta,z) = 1</m>.
            Thus mass is
            <me>
              \int_0^{2\pi}\int_0^1\int_{-\sqrt{1-r^2}}^{\sqrt{1-r^2}} r\, dz\, dr\, d\theta = 2\pi/3
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>, <m>M_{xz} = 0</m>,
            and <m>M_{xy} = \pi/4</m>, placing the center of mass at <m>(0,0,3/8)</m>.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          a solid is described along with its density function.
          Find the mass of the solid using spherical coordinates.
        </p>
      </introduction>

      <exercise xml:id="ex_13_07_ex_31">
        <statement>
          <p>
            The upper half of the unit ball,
            bounded between <m>z= 0</m> and <m>z=\sqrt{1-x^2-y^2}</m>,
            with density function <m>\delta(x,y,z) =1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = 1</m>.
            Thus mass is
            <me>
              \int_0^{\pi/2}\int_0^{2\pi}\int_{0}^{1} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = 2\pi/3
            </me>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The spherical shell bounded between <m>x^2+y^2+z^2=16</m> and
            <m>x^2+y^2+z^2=25</m> with density function <m>\delta(x,y,z) = \sqrt{x^2+y^2+z^2}</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = \rho</m>.
            Thus mass is
            <me>
              \int_0^{\pi}\int_0^{2\pi}\int_{4}^{5} (\rho)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = 369\pi
            </me>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The conical region bounded above <m>z=\sqrt{x^2+y^2}</m> and below the sphere
            <m>x^2+y^2+z^2=1</m> with density function <m>\delta(x,y,z) = z</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = \rho\cos(\varphi)</m>.
            Thus mass is
            <me>
              \int_0^{\pi/4}\int_0^{2\pi}\int_{0}^{1} \big(\rho\cos(\varphi)\big)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = \pi/8
            </me>.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex_13_07_ex_34">
        <statement>
          <p>
            The cone bounded above <m>z=\sqrt{x^2+y^2}</m> and below the plane <m>z=1</m> with density function <m>\delta(x,y,z) = z</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = \rho\cos(\varphi)</m>.
            Thus mass is
            <me>
              \int_0^{\pi/4}\int_0^{2\pi}\int_{0}^{\sec(\varphi)} \big(\rho\cos(\varphi)\big)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = \pi/4
            </me>.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises,
          a solid is described along with its density function.
          Find the center of mass of the solid using spherical coordinates.
          (Note: these are the same solids and density functions as found in <xref ref="ex_13_07_ex_31">Exercises</xref>
          through <xref ref="ex_13_07_ex_34"></xref>.)
        </p>
      </introduction>

      <exercise>
        <statement>
          <p>
            The upper half of the unit ball,
            bounded between <m>z= 0</m> and <m>z=\sqrt{1-x^2-y^2}</m>,
            with density function <m>\delta(x,y,z) =1</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = 1</m>.
            Thus mass is
            <me>
              \int_0^{\pi/2}\int_0^{2\pi}\int_{0}^{1} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = 2\pi/3
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>, <m>M_{xz} = 0</m>,
            and <m>M_{xy} = \pi/4</m>, placing the center of mass at <m>(0,0,3/8)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The spherical shell bounded between <m>x^2+y^2+z^2=16</m> and
            <m>x^2+y^2+z^2=25</m> with density function <m>\delta(x,y,z) = \sqrt{x^2+y^2+z^2}</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = \rho</m>.
            Thus mass is
            <me>
              \int_0^{\pi}\int_0^{2\pi}\int_{4}^{5} (\rho)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = 369\pi
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>, <m>M_{xz} = 0</m>,
            and <m>M_{xy} = 0</m>, placing the center of mass at <m>(0,0,0)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The conical region bounded above <m>z=\sqrt{x^2+y^2}</m> and below the sphere
            <m>x^2+y^2+z^2=1</m> with density function <m>\delta(x,y,z) = z</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = \rho\cos(\varphi)</m>.
            Thus mass is
            <me>
              \int_0^{\pi/4}\int_0^{2\pi}\int_{0}^{1} \big(\rho\cos(\varphi)\big)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = \pi/8
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>,
            <m>M_{xz} = 0</m>, and <m>M_{xy} = (4-\sqrt{2})\pi/30</m>,
            placing the center of mass at <m>(0,0,4(4-\sqrt2)/15)</m>.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The cone bounded above <m>z=\sqrt{x^2+y^2}</m> and below the plane <m>z=1</m> with density function <m>\delta(x,y,z) = z</m>.
          </p>
        </statement>
        <solution>
          <p>
            In spherical coordinates,
            the density is <m>\delta(\rho,\theta,\varphi) = \rho\cos(\varphi)</m>.
            Thus mass is
            <me>
              \int_0^{\pi/4}\int_0^{2\pi}\int_{0}^{\sec(\varphi)} \big(\rho\cos(\varphi)\big)\rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi = \pi/4
            </me>.
          </p>

          <p>
            We find <m>M_{yz} = 0</m>, <m>M_{xz} = 0</m>,
            and <m>M_{xy} = \pi/5</m>, placing the center of mass at <m>(0,0,4/5)</m>.
          </p>
        </solution>
      </exercise>
    </exercisegroup>

    <exercisegroup>
      <introduction>
        <p>
          In the following exercises, a region is space is described.
          Set up the triple integrals that find the volume of this region using rectangular,
          cylindrical and spherical coordinates,
          then comment on which of the three appears easiest to evaluate.
        </p>
      </introduction>

      <exercise>
        <statement>
          <p>
            The region enclosed by the unit sphere, <m>x^2+y^2+z^2=1</m>.
          </p>
        </statement>
        <solution>
          <p>
            Rectangular:
            <m>\int_{-1}^{1}\int_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}\int_{-\sqrt{1-x^2-y^2}}^{\sqrt{1-x^2-y^2}}\, dz\, dy\, dx</m>
          </p>

          <p>
            Cylindrical:
            <m>\int_0^{2\pi}\int_0^1\int_{-\sqrt{1-r^2}}^{\sqrt{1-r^2}}r\, dz\, dr\, d\theta</m>
          </p>

          <p>
            Spherical: <m>\int_0^\pi\int_0^{2\pi}\int_0^1 \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>

          <p>
            Spherical appears simplest,
            avoiding the integration of square-roots and using techniques such as Substitution;
            all bounds are constants.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The region enclosed by the cylinder
            <m>x^2+y^2=1</m> and planes <m>z=0</m> and <m>z=1</m>.
          </p>
        </statement>
        <solution>
          <p>
            Rectangular:
            <m>\int_{-1}^{1}\int_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}\int_{0}^{1}\, dz\, dy\, dx</m>
          </p>

          <p>
            Cylindrical:
            <m>\int_0^{2\pi}\int_0^1\int_{0}^{1}r\, dz\, dr\, d\theta</m>
          </p>

          <p>
            Spherical: <m>\int_0^{\pi/4}\int_0^{2\pi}\int_0^{\sec(\varphi)} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi + \int_{\pi/4}^{\pi/2}\int_0^{2\pi}\int_0^{\csc(\varphi)} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>

          <p>
            Cylindrical appears simplest,
            avoiding the integration of square-roots and two triple integrals;
            all bounds are constants.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The region enclosed by the cone
            <m>z=\sqrt{x^2+y^2}</m> and plane <m>z=1</m>.
          </p>
        </statement>
        <solution>
          <p>
            Rectangular:
            <m>\int_{-1}^{1}\int_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}\int_{\sqrt{x^2+y^2}}^{1}\, dz\, dy\, dx</m>
          </p>

          <p>
            Cylindrical:
            <m>\int_0^{2\pi}\int_0^1\int_{r}^{1}r\, dz\, dr\, d\theta</m>
          </p>

          <p>
            Spherical: <m>\int_0^{\pi/4}\int_0^{2\pi}\int_0^{\sec(\varphi)} \rho^2\sin(\varphi)\, d\rho\, d\theta\, d\varphi</m>
          </p>

          <p>
            Cylindrical appears simplest,
            avoiding the integration of square-roots that rectangular uses.
            Spherical is not difficult, though it requires Substitution,
            an extra step.
          </p>
        </solution>
      </exercise>

      <exercise>
        <statement>
          <p>
            The cube enclosed by the planes <m>x=0</m>,
            <m>x=1</m>, <m>y=0</m>, <m>y=1</m>,
            <m>z=0</m> and <m>z=1</m>.
            (Hint: in spherical,
            use order of integration <m>d\rho\, d\varphi\, d\theta</m>.)
          </p>
        </statement>
        <solution>
          <p>
            Rectangular:
            <m>\int_{0}^{1}\int_{0}^{1}\int_{0}^{1}\, dz\, dy\, dx</m>
          </p>

          <p>
            Cylindrical:
            <m>\int_0^{\pi/4}\int_0^{\sec(\theta)}\int_{0}^{1}r\, dz\, dr\, d\theta + \int_{\pi/4}^{\pi/2}\int_0^{\csc(\theta)}\int_{0}^{1}r\, dz\, dr\, d\theta</m>
          </p>

          <p>
            Spherical: <m>\int _0^{\pi/4}\int _0^{\tan^{-1}(\sec(\theta))}\int _0^{\sec(\varphi)}\rho ^2 \sin (\varphi)\, d\rho\, d\varphi\, d\theta +</m>
          </p>

          <p>
            <m>\int _0^{\pi/4}\int _{\tan^{-1}(\sec(\theta))}^{\pi/2}\int _0^{\sec(\theta)\csc(\varphi)}\rho ^2 \sin (\varphi)\, d\rho\, d\varphi\, d\theta +</m>
          </p>

          <p>
            <m>\int _{\pi/4}^{\pi/2}\int _0^{\tan^{-1}(\csc(\theta))}\int _0^{\sec(\varphi)}\rho ^2 \sin (\varphi)\, d\rho\, d\varphi\, d\theta +</m>
          </p>

          <p>
            <m>\int _{\pi/4}^{\pi/2}\int _{\tan^{-1}(\csc(\theta))}^{\pi/2}\int _0^{\csc(\theta)\csc(\varphi)}\rho ^2 \sin (\varphi)\, d\rho\, d\varphi\, d\theta</m>.
          </p>

          <p>
            Rectangular is clearly the simplest.
          </p>
        </solution>
      </exercise>
    </exercisegroup>
  </exercises>
</section>
